<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ESG Insight | ì¤‘ì†Œê¸°ì—… ESG ìê°€ì§„ë‹¨ í”Œë«í¼</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;600;700&family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        navy: {
                            50: '#f0f4f8', 100: '#d9e2ec', 200: '#bcccdc', 300: '#9fb3c8',
                            400: '#829ab1', 500: '#627d98', 600: '#486581', 700: '#334e68',
                            800: '#243b53', 900: '#102a43', 950: '#0a1929',
                        },
                    },
                    fontFamily: {
                        'display': ['Outfit', 'sans-serif'],
                        'body': ['Noto Sans KR', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        * { font-family: 'Noto Sans KR', sans-serif; }
        .font-display { font-family: 'Outfit', sans-serif; }
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f0f4f8; }
        ::-webkit-scrollbar-thumb { background: #bcccdc; border-radius: 3px; }
        .page { display: none; }
        .page.active { display: block; }
        .nav-item.active { background: rgba(255, 255, 255, 0.1); border-left: 3px solid #10b981; }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-2px); box-shadow: 0 10px 30px -10px rgba(0,0,0,0.1); }
        .tab-btn.active { background: #f0fdf4; color: #059669; border-bottom: 2px solid #10b981; }
        @keyframes spin { to { transform: rotate(360deg); } }
        .animate-spin { animation: spin 1s linear infinite; }
        .typing-animation::after { content: '|'; animation: blink 1s infinite; }
        @keyframes blink { 0%, 50% { opacity: 1; } 51%, 100% { opacity: 0; } }
        .markdown-content h1 { font-size: 1.5rem; font-weight: 700; margin: 1rem 0 0.5rem; }
        .markdown-content h2 { font-size: 1.25rem; font-weight: 600; margin: 1rem 0 0.5rem; }
        .markdown-content h3 { font-size: 1.1rem; font-weight: 600; margin: 0.75rem 0 0.25rem; }
        .markdown-content p { margin: 0.5rem 0; line-height: 1.7; }
        .markdown-content ul { list-style: disc; margin-left: 1.5rem; margin: 0.5rem 0; }
        .markdown-content li { margin: 0.25rem 0; }
        .markdown-content strong { font-weight: 600; color: #1e3a5f; }
        
        /* ë ˆì´ì•„ì›ƒ ê¸°ë°˜ ë³´ê³ ì„œ ìŠ¤íƒ€ì¼ */
        .editable-field { cursor: text; transition: all 0.2s; }
        .editable-field:hover { background: rgba(6, 182, 212, 0.1); }
        .editable-field:focus { background: rgba(6, 182, 212, 0.15); outline: none; }
        
        /* ë³´ê³ ì„œ í”„ë¦¬ë·° */
        #reportPreview { 
            width: 210mm; 
            background: white; 
            box-shadow: 0 4px 20px rgba(0,0,0,0.15);
        }
        
        /* ë³´ê³ ì„œ ì„¹ì…˜ ê¸°ë³¸ ìŠ¤íƒ€ì¼ */
        .report-section { 
            padding: 40px; 
            background: white;
            position: relative;
        }
        
        /* í‘œì§€ ì„¹ì…˜ - í™”ë©´ì—ì„œë§Œ ì „ì²´ ë†’ì´ */
        #section-cover {
            min-height: 500px;
        }
        
        /* ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ í™œì„±í™” */
        .section-nav-btn.active { background: #f0fdfa; color: #0d9488; }
        .section-nav-btn.active span:first-child span { background: #ccfbf1; color: #0d9488; }
        
        /* ë ˆì´ì•„ì›ƒ ë³€í˜• - ì‹¬í”Œ */
        .simple-layout .report-section { padding: 30px !important; }
        
        /* ë ˆì´ì•„ì›ƒ ë³€í˜• - ì¸í¬ê·¸ë˜í”½ */
        .infographic-layout .report-section { background: linear-gradient(135deg, #f0fdf4 0%, #ecfeff 100%) !important; }
        
        /* ============ PDF ì¶œë ¥ ëª¨ë“œ ìŠ¤íƒ€ì¼ ============ */
        .pdf-export-mode {
            width: 794px !important; /* A4 at 96 DPI */
            box-shadow: none !important;
        }
        
        .pdf-export-mode .report-section {
            min-height: auto !important;
            page-break-inside: avoid;
            padding: 30px !important;
            background: white !important;
        }
        
        /* PDFì—ì„œ í‘œì§€ ë°°ê²½ ë‹¨ìˆœí™” */
        .pdf-export-mode #section-cover {
            background: linear-gradient(135deg, #102a43 0%, #1e4d3d 100%) !important;
        }
        
        .pdf-export-mode #section-cover .absolute {
            display: none !important; /* blur íš¨ê³¼ ì œê±° */
        }
        
        /* PDFì—ì„œ ê·¸ë¼ë°ì´ì…˜ ë°°ê²½ ë‹¨ìˆœí™” */
        .pdf-export-mode #section-environment { background: #f0fdf4 !important; }
        .pdf-export-mode #section-social { background: #eff6ff !important; }
        .pdf-export-mode #section-governance { background: #faf5ff !important; }
        .pdf-export-mode #section-recommendations { background: #fffbeb !important; }
        
        /* PDFì—ì„œ í¸ì§‘ í•„ë“œ í•˜ì´ë¼ì´íŠ¸ ì œê±° */
        .pdf-export-mode .editable-field:hover,
        .pdf-export-mode .editable-field:focus {
            background: transparent !important;
        }
        
        /* í”„ë¦°íŠ¸ ìŠ¤íƒ€ì¼ */
        @media print {
            .report-section { 
                page-break-after: always; 
                page-break-inside: avoid;
                min-height: auto !important;
            }
            .report-section:last-child { page-break-after: auto; }
            .editable-field:focus { background: none !important; }
            #section-cover .absolute { display: none !important; }
        }
    </style>
</head>
<body class="bg-navy-50 min-h-screen">
    <script>
        // ============================================================
        // AI ë¦¬í¬íŠ¸ ìƒì„±ì€ ì„œë²„ APIë¥¼ í†µí•´ ì²˜ë¦¬ë©ë‹ˆë‹¤.
        // Claude API KeyëŠ” ì„œë²„ì˜ .env íŒŒì¼ì—ì„œ ê´€ë¦¬í•©ë‹ˆë‹¤.
        // ============================================================
        const AI_MODEL = 'claude-sonnet-4-20250514'; // Claude Sonnet 4
        // ============================================================
    </script>

    <div class="flex min-h-screen">
        <!-- Sidebar -->
        <aside class="w-72 bg-navy-900 text-white fixed h-full flex flex-col z-20">
            <!-- Logo -->
            <div class="p-6 border-b border-navy-700/50">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center">
                        <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path>
                        </svg>
                    </div>
                    <div>
                        <h1 class="font-display font-bold text-xl tracking-tight">ESG Insight</h1>
                        <p class="text-navy-400 text-xs">ì¤‘ì†Œê¸°ì—… ESG í”Œë«í¼</p>
                    </div>
                </div>
            </div>

            <!-- Company Info -->
            <div class="p-4 mx-4 mt-4 rounded-xl bg-navy-800/50 border border-navy-700/30">
                <div class="flex items-center gap-3">
                    <div class="w-10 h-10 rounded-lg bg-navy-700 flex items-center justify-center text-sm font-bold" id="companyInitial">ê·¸</div>
                    <div>
                        <p class="font-medium text-sm" id="companyNameDisplay">ê·¸ë¦°í…Œí¬ ì£¼ì‹íšŒì‚¬</p>
                        <p class="text-navy-400 text-xs"><span id="industryDisplay">ì œì¡°ì—…</span> Â· <span id="sizeDisplay">ì¤‘ì†Œê¸°ì—…</span></p>
                    </div>
                </div>
            </div>

            <!-- Navigation -->
            <nav class="flex-1 mt-6 px-3 overflow-y-auto">
                <p class="px-4 text-xs font-semibold text-navy-500 uppercase tracking-wider mb-2">ë©”ì¸</p>
                <ul class="space-y-1">
                    <li>
                        <button onclick="showPage('dashboard')" class="nav-item active w-full flex items-center gap-3 px-4 py-3 rounded-lg text-white" data-page="dashboard">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2V6zM14 6a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2V6zM4 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2H6a2 2 0 01-2-2v-2zM14 16a2 2 0 012-2h2a2 2 0 012 2v2a2 2 0 01-2 2h-2a2 2 0 01-2-2v-2z"></path></svg>
                            <span class="font-medium">ëŒ€ì‹œë³´ë“œ</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showPage('data-input')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white" data-page="data-input">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"></path></svg>
                            <span>ë°ì´í„° ì…ë ¥</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showPage('ai-report')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white" data-page="ai-report">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.75 17L9 20l-1 1h8l-1-1-.75-3M3 13h18M5 17h14a2 2 0 002-2V5a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"></path></svg>
                            <span>AI ë¦¬í¬íŠ¸ ìƒì„±</span>
                            <span class="ml-auto w-2 h-2 bg-emerald-500 rounded-full animate-pulse"></span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showPage('ai-advisor')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white" data-page="ai-advisor">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 10h.01M12 10h.01M16 10h.01M9 16H5a2 2 0 01-2-2V6a2 2 0 012-2h14a2 2 0 012 2v8a2 2 0 01-2 2h-5l-5 5v-5z"></path></svg>
                            <span>AI ì»¨ì„¤í„´íŠ¸</span>
                            <span class="ml-auto bg-emerald-500/20 text-emerald-400 text-xs px-2 py-0.5 rounded-full">NEW</span>
                        </button>
                    </li>
                    <li>
                        <button onclick="showPage('data-integration')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white" data-page="data-integration">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg>
                            <span>ë°ì´í„° ì—°ë™</span>
                            <span class="ml-auto bg-cyan-500/20 text-cyan-400 text-xs px-2 py-0.5 rounded-full">API</span>
                        </button>
                    </li>
                </ul>

                <p class="px-4 text-xs font-semibold text-navy-500 uppercase tracking-wider mb-2 mt-6">ë„êµ¬</p>
                <ul class="space-y-1">
                    <li>
                        <a href="assessment.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-6 9l2 2 4-4"></path></svg>
                            <span>ESG ìê°€ì§„ë‹¨</span>
                        </a>
                    </li>
                    <li>
                        <a href="reports.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            <span>ë³´ê³ ì„œ ìƒ˜í”Œ</span>
                        </a>
                    </li>
                    <li>
                        <a href="integrations.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 4a2 2 0 114 0v1a1 1 0 001 1h3a1 1 0 011 1v3a1 1 0 01-1 1h-1a2 2 0 100 4h1a1 1 0 011 1v3a1 1 0 01-1 1h-3a1 1 0 01-1-1v-1a2 2 0 10-4 0v1a1 1 0 01-1 1H7a1 1 0 01-1-1v-3a1 1 0 00-1-1H4a2 2 0 110-4h1a1 1 0 001-1V7a1 1 0 011-1h3a1 1 0 001-1V4z"></path></svg>
                            <span>ì—°ë™ ì‹œìŠ¤í…œ</span>
                        </a>
                    </li>
                </ul>

                <p class="px-4 text-xs font-semibold text-navy-500 uppercase tracking-wider mb-2 mt-6">í•™ìŠµ</p>
                <ul class="space-y-1">
                    <li>
                        <a href="webinars.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 10l4.553-2.276A1 1 0 0121 8.618v6.764a1 1 0 01-1.447.894L15 14M5 18h8a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                            <span>ì›¨ë¹„ë‚˜</span>
                        </a>
                    </li>
                    <li>
                        <a href="getting-started.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"></path></svg>
                            <span>ì‹œì‘ ê°€ì´ë“œ</span>
                        </a>
                    </li>
                    <li>
                        <a href="blog.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 20H5a2 2 0 01-2-2V6a2 2 0 012-2h10a2 2 0 012 2v1m2 13a2 2 0 01-2-2V7m2 13a2 2 0 002-2V9a2 2 0 00-2-2h-2m-4-3H9M7 16h6M7 8h6v4H7V8z"></path></svg>
                            <span>ë¸”ë¡œê·¸</span>
                        </a>
                    </li>
                </ul>

                <p class="px-4 text-xs font-semibold text-navy-500 uppercase tracking-wider mb-2 mt-6">ê³„ì •</p>
                <ul class="space-y-1">
                    <li>
                        <a href="mypage.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path></svg>
                            <span>ë§ˆì´í˜ì´ì§€</span>
                        </a>
                    </li>
                    <li>
                        <a href="support.html" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white hover:bg-navy-800/50 transition-colors">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M18.364 5.636l-3.536 3.536m0 5.656l3.536 3.536M9.172 9.172L5.636 5.636m3.536 9.192l-3.536 3.536M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-5 0a4 4 0 11-8 0 4 4 0 018 0z"></path></svg>
                            <span>ê³ ê°ì§€ì›</span>
                        </a>
                    </li>
                    <li>
                        <button onclick="showPage('settings')" class="nav-item w-full flex items-center gap-3 px-4 py-3 rounded-lg text-navy-300 hover:text-white" data-page="settings">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path></svg>
                            <span>ì„¤ì •</span>
                        </button>
                    </li>
                </ul>
            </nav>

            <!-- AI Status -->
            <div class="px-4 mb-2">
                <div id="apiStatus" class="p-3 rounded-lg bg-navy-800/50 border border-navy-700/30">
                    <div class="flex items-center gap-2">
                        <div id="apiStatusIndicator" class="w-2 h-2 rounded-full bg-amber-500"></div>
                        <span class="text-xs text-navy-400" id="apiStatusText">Claude AI ëŒ€ê¸°ì¤‘</span>
                    </div>
                </div>
            </div>

            <!-- User Profile -->
            <div class="p-4 border-t border-navy-700/50">
                <div class="flex items-center gap-3 p-2 rounded-lg hover:bg-navy-800/50 cursor-pointer transition-colors">
                    <div class="w-9 h-9 rounded-full bg-gradient-to-br from-cyan-500 to-emerald-500 flex items-center justify-center text-sm font-bold">ê¹€</div>
                    <div class="flex-1 min-w-0">
                        <p class="font-medium text-sm truncate">ê¹€ì§€ì›</p>
                        <p class="text-navy-400 text-xs truncate">ESG ë‹´ë‹¹ì</p>
                    </div>
                </div>
                
                <!-- ì¶”ê°€ ë©”ë‰´ -->
                <div class="mt-3 space-y-1">
                    <a href="/pricing" class="flex items-center gap-2 px-3 py-2 text-sm text-emerald-400 hover:bg-navy-800/50 rounded-lg transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 10l7-7m0 0l7 7m-7-7v18"></path>
                        </svg>
                        ìš”ê¸ˆì œ ì—…ê·¸ë ˆì´ë“œ
                    </a>
                    <a href="/" class="flex items-center gap-2 px-3 py-2 text-sm text-navy-400 hover:bg-navy-800/50 rounded-lg transition-colors">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"></path>
                        </svg>
                        í™ˆìœ¼ë¡œ
                    </a>
                    <button onclick="logout()" class="w-full flex items-center gap-2 px-3 py-2 text-sm text-red-400 hover:bg-navy-800/50 rounded-lg transition-colors text-left">
                        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1"></path>
                        </svg>
                        ë¡œê·¸ì•„ì›ƒ
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="flex-1 ml-72 bg-gradient-to-br from-navy-50 via-white to-emerald-50/30">
            <!-- ==================== ëŒ€ì‹œë³´ë“œ í˜ì´ì§€ ==================== -->
            <div id="page-dashboard" class="page active">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4 flex items-center justify-between">
                        <div>
                            <h2 class="font-display text-2xl font-bold text-navy-900">ëŒ€ì‹œë³´ë“œ</h2>
                            <p class="text-navy-500 text-sm mt-0.5">ESG ì„±ê³¼ë¥¼ í•œëˆˆì— í™•ì¸í•˜ì„¸ìš”</p>
                        </div>
                        <div class="flex items-center gap-4">
                            <button onclick="analyzeWithAI()" class="px-4 py-2.5 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-xl text-sm font-medium hover:opacity-90 transition-opacity flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                AI ë¶„ì„
                            </button>
                            <button onclick="createNewReport()" class="px-4 py-2.5 bg-navy-900 text-white rounded-xl text-sm font-medium hover:bg-navy-800 transition-colors flex items-center gap-2">
                                <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                                ìƒˆ ë¦¬í¬íŠ¸
                            </button>
                        </div>
                    </div>
                </header>

                <div class="p-8">
                    <!-- Top Cards -->
                    <div class="grid grid-cols-4 gap-6 mb-8">
                        <!-- ESG Score Card -->
                        <div class="col-span-2 bg-white rounded-2xl p-6 shadow-sm border border-navy-100 card-hover">
                            <div class="flex items-start justify-between mb-6">
                                <div>
                                    <h3 class="text-navy-500 text-sm font-medium">ìš°ë¦¬ íšŒì‚¬ ESG ì ìˆ˜</h3>
                                    <p class="text-navy-900 text-3xl font-display font-bold mt-1"><span id="totalScore">78.5</span><span class="text-lg text-navy-400 font-normal">/100</span></p>
                                </div>
                                <div class="bg-gradient-to-br from-emerald-500 to-cyan-500 text-white px-4 py-2 rounded-xl font-display font-bold text-xl" id="gradeDisplay">B+</div>
                            </div>
                            
                            <div class="grid grid-cols-3 gap-4">
                                <div class="text-center p-4 rounded-xl bg-gradient-to-br from-emerald-500/10 to-emerald-500/5 border border-emerald-500/20">
                                    <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-emerald-500/20 flex items-center justify-center">
                                        <svg class="w-6 h-6 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    </div>
                                    <p class="text-xs text-navy-500 mb-1">í™˜ê²½ (E)</p>
                                    <p class="font-display font-bold text-xl text-navy-900" id="eScore">82</p>
                                </div>
                                <div class="text-center p-4 rounded-xl bg-gradient-to-br from-cyan-500/10 to-cyan-500/5 border border-cyan-500/20">
                                    <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-cyan-500/20 flex items-center justify-center">
                                        <svg class="w-6 h-6 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                                    </div>
                                    <p class="text-xs text-navy-500 mb-1">ì‚¬íšŒ (S)</p>
                                    <p class="font-display font-bold text-xl text-navy-900" id="sScore">75</p>
                                </div>
                                <div class="text-center p-4 rounded-xl bg-gradient-to-br from-purple-500/10 to-purple-500/5 border border-purple-500/20">
                                    <div class="w-12 h-12 mx-auto mb-2 rounded-full bg-purple-500/20 flex items-center justify-center">
                                        <svg class="w-6 h-6 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                    </div>
                                    <p class="text-xs text-navy-500 mb-1">ì§€ë°°êµ¬ì¡° (G)</p>
                                    <p class="font-display font-bold text-xl text-navy-900" id="gScore">78</p>
                                </div>
                            </div>
                        </div>

                        <!-- Carbon Chart -->
                        <div class="col-span-2 bg-white rounded-2xl p-6 shadow-sm border border-navy-100 card-hover">
                            <div class="flex items-center justify-between mb-4">
                                <div>
                                    <h3 class="text-navy-500 text-sm font-medium">íƒ„ì†Œ ë°°ì¶œëŸ‰ ì¶”ì´</h3>
                                    <p class="text-navy-900 text-2xl font-display font-bold mt-1"><span id="carbonValue">1,245</span> <span class="text-sm text-navy-400 font-normal">tCOâ‚‚e</span></p>
                                </div>
                                <span class="inline-flex items-center gap-1 px-2.5 py-1 rounded-lg bg-emerald-500/10 text-emerald-600 text-xs font-medium">â†“ -12.5%</span>
                            </div>
                            <div class="h-48">
                                <canvas id="carbonChart"></canvas>
                            </div>
                        </div>
                    </div>

                    <!-- AI Analysis Result -->
                    <div id="aiAnalysisResult" class="mb-8 hidden">
                        <div class="bg-gradient-to-r from-emerald-500/10 via-cyan-500/10 to-purple-500/10 rounded-2xl p-6 border border-emerald-500/20">
                            <div class="flex items-center gap-3 mb-4">
                                <div class="w-10 h-10 rounded-xl bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center">
                                    <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-navy-900">Claude AI ë¶„ì„ ê²°ê³¼</h3>
                                    <p class="text-sm text-navy-500">Google AIê°€ ë¶„ì„í•œ ESG í˜„í™©</p>
                                </div>
                            </div>
                            <div id="aiAnalysisContent" class="text-navy-700 text-sm leading-relaxed markdown-content"></div>
                        </div>
                    </div>

                    <!-- K-ESG Assessment Status -->
                    <div class="mb-6">
                        <div class="flex items-center justify-between mb-4">
                            <h3 class="font-display font-semibold text-navy-900">K-ESG ìê°€ì§„ë‹¨ í˜„í™©</h3>
                            <a href="/assessment" class="text-cyan-600 text-sm hover:underline">ì§„ë‹¨ í˜ì´ì§€ â†’</a>
                        </div>
                        <div id="assessmentStatus" class="bg-gray-50 rounded-xl p-4 text-center text-gray-500">
                            ë°ì´í„° ë¡œë”© ì¤‘...
                        </div>
                    </div>

                    <!-- Bottom Section -->
                    <div class="grid grid-cols-5 gap-6">
                        <!-- Reports -->
                        <div class="col-span-2 bg-white rounded-2xl p-6 shadow-sm border border-navy-100 card-hover">
                            <div class="flex items-center justify-between mb-5">
                                <h3 class="font-display font-semibold text-navy-900">ì§„í–‰ ì¤‘ì¸ ë¦¬í¬íŠ¸</h3>
                                <button onclick="showPage('ai-report')" class="text-cyan-600 text-sm hover:underline">ì „ì²´ ë³´ê¸°</button>
                            </div>
                            <div class="space-y-4" id="reportsList"></div>
                        </div>

                        <!-- AI Tasks -->
                        <div class="col-span-3 bg-white rounded-2xl p-6 shadow-sm border border-navy-100 card-hover">
                            <div class="flex items-center justify-between mb-5">
                                <div class="flex items-center gap-3">
                                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center">
                                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                    </div>
                                    <h3 class="font-display font-semibold text-navy-900">AI ì¶”ì²œ ê°œì„  ê³¼ì œ</h3>
                                </div>
                                <button onclick="generateAITasks()" class="px-3 py-1 rounded-full bg-emerald-500/10 text-emerald-600 text-xs font-medium hover:bg-emerald-500/20 transition-colors">
                                    ğŸ”„ AIë¡œ ì¬ë¶„ì„
                                </button>
                            </div>
                            <div class="space-y-3" id="tasksList"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== ë°ì´í„° ì…ë ¥ í˜ì´ì§€ ==================== -->
            <div id="page-data-input" class="page">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4">
                        <h2 class="font-display text-2xl font-bold text-navy-900">ë°ì´í„° ì…ë ¥</h2>
                        <p class="text-navy-500 text-sm mt-0.5">ESG ê´€ë ¨ ë°ì´í„°ë¥¼ ì…ë ¥í•˜ê±°ë‚˜ PDFì—ì„œ ìë™ ì¶”ì¶œí•˜ì„¸ìš”</p>
                    </div>
                </header>
                
                <div class="p-8">
                    <!-- ì…ë ¥ ëª¨ë“œ ì„ íƒ íƒ­ -->
                    <div class="flex gap-2 mb-6">
                        <button onclick="switchInputMode('simple')" id="simpleModeBtnTab" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-cyan-500 to-emerald-500 text-white rounded-xl font-semibold shadow-lg transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                            ğŸ“„ ê°„í¸ ì…ë ¥ (ê³ ì§€ì„œ OCR)
                        </button>
                        <button onclick="switchInputMode('detail')" id="detailModeBtnTab" class="flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-white text-navy-600 rounded-xl font-semibold border-2 border-navy-200 hover:border-navy-400 transition-all">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"></path></svg>
                            ğŸ“ ìƒì„¸ ì…ë ¥ (61ê°œ í•­ëª©)
                        </button>
                    </div>

                    <!-- ========== ê°„í¸ ì…ë ¥ ëª¨ë“œ ========== -->
                    <div id="simpleInputMode">
                        <!-- ì•ˆë‚´ ë°°ë„ˆ -->
                        <div class="bg-gradient-to-r from-cyan-50 to-emerald-50 rounded-2xl p-6 mb-6 border border-cyan-200">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-emerald-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"></path></svg>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-navy-900 mb-1">ğŸ¤– AIê°€ ê³ ì§€ì„œì—ì„œ ìë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤</h3>
                                    <p class="text-sm text-navy-600">ì „ê¸°/ìˆ˜ë„/ê°€ìŠ¤ ìš”ê¸ˆ ê³ ì§€ì„œ, ê´€ë¦¬ë¹„ ê³ ì§€ì„œ, 4ëŒ€ë³´í—˜ ê³ ì§€ì„œë¥¼ ì´¬ì˜í•˜ê±°ë‚˜ ì—…ë¡œë“œí•˜ì„¸ìš”.</p>
                                    <p class="text-xs text-cyan-600 mt-2">ğŸ’¡ ê´€ë¦¬ë¹„ ê³ ì§€ì„œ í•˜ë‚˜ë¡œ ì „ê¸°/ìˆ˜ë„/ê°€ìŠ¤ë¥¼ í•œë²ˆì— ì¶”ì¶œí•  ìˆ˜ ìˆì–´ìš”!</p>
                                </div>
                            </div>
                        </div>

                        <!-- ê³ ì§€ì„œ ì—…ë¡œë“œ ì¹´ë“œ ê·¸ë¦¬ë“œ -->
                        <div class="grid grid-cols-2 lg:grid-cols-3 gap-4 mb-6">
                            <!-- ì „ê¸°ìš”ê¸ˆ ê³ ì§€ì„œ -->
                            <div class="bg-white rounded-xl border-2 border-yellow-200 hover:border-yellow-400 transition-all overflow-hidden">
                                <div class="bg-yellow-50 px-4 py-3 border-b border-yellow-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">âš¡</span>
                                        <div>
                                            <h4 class="font-semibold text-yellow-800">ì „ê¸°ìš”ê¸ˆ ê³ ì§€ì„œ</h4>
                                            <p class="text-xs text-yellow-600">í•œì „, ì§€ì—­ ì „ê¸°ì¡°í•©</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'electricity')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-yellow-300 rounded-lg hover:bg-yellow-50 transition-all">
                                            <svg class="w-8 h-8 text-yellow-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-yellow-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="electricity-result" class="hidden mt-3 p-3 bg-yellow-50 rounded-lg">
                                        <div class="text-xs text-yellow-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-yellow-800" id="electricity-value">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ìˆ˜ë„ìš”ê¸ˆ ê³ ì§€ì„œ -->
                            <div class="bg-white rounded-xl border-2 border-blue-200 hover:border-blue-400 transition-all overflow-hidden">
                                <div class="bg-blue-50 px-4 py-3 border-b border-blue-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">ğŸ’§</span>
                                        <div>
                                            <h4 class="font-semibold text-blue-800">ìˆ˜ë„ìš”ê¸ˆ ê³ ì§€ì„œ</h4>
                                            <p class="text-xs text-blue-600">ìƒìˆ˜ë„, í•˜ìˆ˜ë„</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'water')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-blue-300 rounded-lg hover:bg-blue-50 transition-all">
                                            <svg class="w-8 h-8 text-blue-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-blue-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="water-result" class="hidden mt-3 p-3 bg-blue-50 rounded-lg">
                                        <div class="text-xs text-blue-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-blue-800" id="water-value">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ê°€ìŠ¤ìš”ê¸ˆ ê³ ì§€ì„œ -->
                            <div class="bg-white rounded-xl border-2 border-orange-200 hover:border-orange-400 transition-all overflow-hidden">
                                <div class="bg-orange-50 px-4 py-3 border-b border-orange-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">ğŸ”¥</span>
                                        <div>
                                            <h4 class="font-semibold text-orange-800">ê°€ìŠ¤ìš”ê¸ˆ ê³ ì§€ì„œ</h4>
                                            <p class="text-xs text-orange-600">ë„ì‹œê°€ìŠ¤, LPG</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'gas')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-orange-300 rounded-lg hover:bg-orange-50 transition-all">
                                            <svg class="w-8 h-8 text-orange-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-orange-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="gas-result" class="hidden mt-3 p-3 bg-orange-50 rounded-lg">
                                        <div class="text-xs text-orange-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-orange-800" id="gas-value">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- ê´€ë¦¬ë¹„ ê³ ì§€ì„œ (í†µí•©) -->
                            <div class="bg-white rounded-xl border-2 border-green-200 hover:border-green-400 transition-all overflow-hidden">
                                <div class="bg-green-50 px-4 py-3 border-b border-green-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">ğŸ¢</span>
                                        <div>
                                            <h4 class="font-semibold text-green-800">ê´€ë¦¬ë¹„ ê³ ì§€ì„œ</h4>
                                            <p class="text-xs text-green-600">ì „ê¸°/ìˆ˜ë„/ê°€ìŠ¤ í†µí•©</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'maintenance')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-green-300 rounded-lg hover:bg-green-50 transition-all">
                                            <svg class="w-8 h-8 text-green-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-green-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="maintenance-result" class="hidden mt-3 p-3 bg-green-50 rounded-lg">
                                        <div class="text-xs text-green-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-green-800" id="maintenance-value">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- 4ëŒ€ë³´í—˜ ê³ ì§€ì„œ -->
                            <div class="bg-white rounded-xl border-2 border-purple-200 hover:border-purple-400 transition-all overflow-hidden">
                                <div class="bg-purple-50 px-4 py-3 border-b border-purple-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">ğŸ‘¥</span>
                                        <div>
                                            <h4 class="font-semibold text-purple-800">4ëŒ€ë³´í—˜ ê³ ì§€ì„œ</h4>
                                            <p class="text-xs text-purple-600">êµ­ë¯¼ì—°ê¸ˆ, ê±´ê°•ë³´í—˜ ë“±</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'insurance')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-purple-300 rounded-lg hover:bg-purple-50 transition-all">
                                            <svg class="w-8 h-8 text-purple-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-purple-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="insurance-result" class="hidden mt-3 p-3 bg-purple-50 rounded-lg">
                                        <div class="text-xs text-purple-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-purple-800" id="insurance-value">-</div>
                                    </div>
                                </div>
                            </div>

                            <!-- íê¸°ë¬¼ ì˜ìˆ˜ì¦ -->
                            <div class="bg-white rounded-xl border-2 border-gray-200 hover:border-gray-400 transition-all overflow-hidden">
                                <div class="bg-gray-50 px-4 py-3 border-b border-gray-200">
                                    <div class="flex items-center gap-2">
                                        <span class="text-2xl">ğŸ—‘ï¸</span>
                                        <div>
                                            <h4 class="font-semibold text-gray-800">íê¸°ë¬¼ ì²˜ë¦¬ ì˜ìˆ˜ì¦</h4>
                                            <p class="text-xs text-gray-600">ì¼ë°˜/ì¬í™œìš© íê¸°ë¬¼</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="p-4">
                                    <label class="cursor-pointer block">
                                        <input type="file" accept="image/*,.pdf" class="hidden" onchange="handleBillUpload(event, 'waste')">
                                        <div class="flex flex-col items-center justify-center gap-2 py-6 border-2 border-dashed border-gray-300 rounded-lg hover:bg-gray-50 transition-all">
                                            <svg class="w-8 h-8 text-gray-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path></svg>
                                            <span class="text-sm text-gray-700 font-medium">í´ë¦­í•˜ì—¬ ì—…ë¡œë“œ</span>
                                        </div>
                                    </label>
                                    <div id="waste-result" class="hidden mt-3 p-3 bg-gray-50 rounded-lg">
                                        <div class="text-xs text-gray-600 mb-1">ì¶”ì¶œ ê²°ê³¼</div>
                                        <div class="font-semibold text-gray-800" id="waste-value">-</div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- OCR ì²˜ë¦¬ ìƒíƒœ -->
                        <div id="ocrProcessingStatus" class="hidden mb-6 p-4 bg-white rounded-xl border border-cyan-200">
                            <div class="flex items-center gap-3">
                                <div class="w-6 h-6 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"></div>
                                <span id="ocrStatusText" class="text-navy-700">ê³ ì§€ì„œ ë¶„ì„ ì¤‘...</span>
                            </div>
                        </div>

                        <!-- ì¶”ì¶œ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° -->
                        <div id="ocrExtractedPreview" class="hidden mb-6">
                            <div class="bg-white rounded-xl border-2 border-emerald-300 overflow-hidden">
                                <div class="bg-emerald-50 px-4 py-3 border-b border-emerald-200 flex items-center justify-between">
                                    <div class="flex items-center gap-2">
                                        <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        <h4 class="font-semibold text-emerald-800">AI ì¶”ì¶œ ê²°ê³¼</h4>
                                    </div>
                                    <span id="ocrBillType" class="text-xs bg-emerald-200 text-emerald-800 px-2 py-1 rounded-full">-</span>
                                </div>
                                <div class="p-4">
                                    <div id="ocrExtractedContent" class="space-y-3">
                                        <!-- ì¶”ì¶œëœ ë°ì´í„°ê°€ ì—¬ê¸°ì— í‘œì‹œë¨ -->
                                    </div>
                                    <div class="mt-4 pt-4 border-t border-emerald-100 flex items-center justify-between">
                                        <span class="text-sm text-navy-500">ì¶”ì¶œ ë°ì´í„°ê°€ ë§ëŠ”ì§€ í™•ì¸í•´ì£¼ì„¸ìš”</span>
                                        <div class="flex gap-2">
                                            <button onclick="cancelOcrData()" class="px-4 py-2 text-navy-600 rounded-lg hover:bg-navy-100 transition-colors text-sm font-medium">
                                                ì·¨ì†Œ
                                            </button>
                                            <button onclick="applyOcrData()" class="px-4 py-2 bg-emerald-500 text-white rounded-lg hover:bg-emerald-600 transition-colors text-sm font-medium">
                                                âœ“ ë°ì´í„° ì ìš©
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ì›”ë³„ ë°ì´í„° ìš”ì•½ -->
                        <div class="bg-white rounded-xl border border-navy-200 overflow-hidden">
                            <div class="bg-navy-50 px-4 py-3 border-b border-navy-200 flex items-center justify-between">
                                <h4 class="font-semibold text-navy-800">ğŸ“Š ì›”ë³„ ë°ì´í„° í˜„í™©</h4>
                                <select id="billDataYear" class="text-sm border border-navy-300 rounded-lg px-3 py-1.5" onchange="updateBillDataTable()">
                                    <option value="2024">2024ë…„</option>
                                    <option value="2025" selected>2025ë…„</option>
                                </select>
                            </div>
                            <div class="overflow-x-auto">
                                <table class="w-full text-sm">
                                    <thead class="bg-navy-50">
                                        <tr>
                                            <th class="px-4 py-3 text-left text-navy-600 font-medium">í•­ëª©</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">1ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">2ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">3ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">4ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">5ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">6ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">7ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">8ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">9ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">10ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">11ì›”</th>
                                            <th class="px-3 py-3 text-center text-navy-600 font-medium">12ì›”</th>
                                            <th class="px-4 py-3 text-right text-navy-800 font-semibold">ì—°ê°„ í•©ê³„</th>
                                        </tr>
                                    </thead>
                                    <tbody id="billDataTableBody">
                                        <tr class="border-b border-navy-100">
                                            <td class="px-4 py-3 font-medium text-yellow-700">âš¡ ì „ê¸° (kWh)</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-1">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-2">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-3">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-4">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-5">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-6">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-7">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-8">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-9">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-10">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-11">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="elec-12">-</td>
                                            <td class="px-4 py-3 text-right font-semibold text-yellow-700" id="elec-total">0</td>
                                        </tr>
                                        <tr class="border-b border-navy-100">
                                            <td class="px-4 py-3 font-medium text-blue-700">ğŸ’§ ìˆ˜ë„ (í†¤)</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-1">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-2">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-3">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-4">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-5">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-6">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-7">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-8">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-9">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-10">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-11">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="water-12">-</td>
                                            <td class="px-4 py-3 text-right font-semibold text-blue-700" id="water-total">0</td>
                                        </tr>
                                        <tr class="border-b border-navy-100">
                                            <td class="px-4 py-3 font-medium text-orange-700">ğŸ”¥ ê°€ìŠ¤ (ã¥)</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-1">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-2">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-3">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-4">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-5">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-6">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-7">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-8">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-9">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-10">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-11">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="gas-12">-</td>
                                            <td class="px-4 py-3 text-right font-semibold text-orange-700" id="gas-total">0</td>
                                        </tr>
                                        <tr class="border-b border-navy-100 bg-gray-50">
                                            <td class="px-4 py-3 font-medium text-gray-700">ğŸ—‘ï¸ íê¸°ë¬¼ (kg)</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-1">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-2">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-3">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-4">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-5">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-6">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-7">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-8">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-9">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-10">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-11">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="waste-12">-</td>
                                            <td class="px-4 py-3 text-right font-semibold text-gray-700" id="waste-total">0</td>
                                        </tr>
                                        <tr>
                                            <td class="px-4 py-3 font-medium text-purple-700">ğŸ‘¥ ì§ì› ìˆ˜</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-1">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-2">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-3">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-4">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-5">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-6">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-7">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-8">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-9">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-10">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-11">-</td>
                                            <td class="px-3 py-3 text-center text-navy-600" id="emp-12">-</td>
                                            <td class="px-4 py-3 text-right font-semibold text-purple-700" id="emp-avg">í‰ê· : -</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                            <div class="px-4 py-3 bg-navy-50 border-t border-navy-200 flex items-center justify-between">
                                <span class="text-xs text-navy-500">ğŸ’¡ ê³ ì§€ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´ ìë™ìœ¼ë¡œ í•´ë‹¹ ì›”ì— ë°ì´í„°ê°€ ì…ë ¥ë©ë‹ˆë‹¤</span>
                                <button onclick="applyMonthlyToESG()" class="px-4 py-2 bg-navy-800 text-white rounded-lg text-sm font-medium hover:bg-navy-900 transition-colors">
                                    ESG ë°ì´í„°ì— ë°˜ì˜ â†’
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- ========== ìƒì„¸ ì…ë ¥ ëª¨ë“œ ========== -->
                    <div id="detailInputMode" class="hidden">
                        <!-- ê¸°ì¡´ PDF/Excel ì—…ë¡œë“œ -->
                        <div class="bg-gradient-to-r from-cyan-50 to-emerald-50 rounded-2xl shadow-sm border border-cyan-200 p-6 mb-6">
                            <div class="flex items-start gap-4">
                                <div class="w-12 h-12 bg-gradient-to-br from-cyan-500 to-emerald-500 rounded-xl flex items-center justify-center flex-shrink-0">
                                    <svg class="w-6 h-6 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"></path></svg>
                                </div>
                                <div class="flex-1">
                                    <h3 class="font-semibold text-navy-900 mb-1">PDF/Excelì—ì„œ ESG ë°ì´í„° ìë™ ì¶”ì¶œ</h3>
                                    <p class="text-sm text-navy-600 mb-4">ì§€ì†ê°€ëŠ¥ê²½ì˜ ë³´ê³ ì„œ, ESG ë³´ê³ ì„œë¥¼ ì—…ë¡œë“œí•˜ë©´ AIê°€ ìë™ìœ¼ë¡œ ë°ì´í„°ë¥¼ ì¶”ì¶œí•©ë‹ˆë‹¤.</p>
                                    
                                    <div class="grid grid-cols-3 gap-3">
                                        <label class="cursor-pointer">
                                            <input type="file" id="esgDataPdf" accept=".pdf" class="hidden" onchange="handleFileUpload(event, 'pdf')">
                                            <div class="flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed border-cyan-300 rounded-xl hover:border-cyan-500 hover:bg-cyan-50 transition-all">
                                                <svg class="w-8 h-8 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                                <span class="text-cyan-700 font-medium text-sm">PDF ì—…ë¡œë“œ</span>
                                                <span class="text-cyan-500 text-xs">ESG ë³´ê³ ì„œ</span>
                                            </div>
                                        </label>
                                        <label class="cursor-pointer">
                                            <input type="file" id="esgDataExcel" accept=".xlsx,.xls,.csv" class="hidden" onchange="handleFileUpload(event, 'excel')">
                                            <div class="flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed border-emerald-300 rounded-xl hover:border-emerald-500 hover:bg-emerald-50 transition-all">
                                                <svg class="w-8 h-8 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                                <span class="text-emerald-700 font-medium text-sm">Excel ì—…ë¡œë“œ</span>
                                                <span class="text-emerald-500 text-xs">.xlsx, .csv</span>
                                            </div>
                                        </label>
                                        <button onclick="useSampleEsgData()" class="flex flex-col items-center justify-center gap-2 px-4 py-4 border-2 border-dashed border-navy-300 rounded-xl hover:border-navy-500 hover:bg-navy-50 transition-all">
                                            <svg class="w-8 h-8 text-navy-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg>
                                            <span class="text-navy-700 font-medium text-sm">ìƒ˜í”Œ ë°ì´í„°</span>
                                            <span class="text-navy-500 text-xs">í…ŒìŠ¤íŠ¸ìš©</span>
                                        </button>
                                    </div>
                                    
                                    <!-- ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ -->
                                    <div class="mt-3 flex items-center gap-2 text-sm">
                                        <span class="text-navy-500">ì—‘ì…€ ì–‘ì‹ì´ í•„ìš”í•˜ì‹ ê°€ìš”?</span>
                                        <button onclick="downloadExcelTemplate()" class="text-cyan-600 hover:text-cyan-700 font-medium underline">
                                            í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ
                                        </button>
                                    </div>
                                    
                                    <!-- ì—…ë¡œë“œ ìƒíƒœ -->
                                    <div id="pdfUploadStatus" class="hidden mt-4">
                                        <div class="flex items-center gap-3 p-3 bg-white rounded-lg border border-cyan-200">
                                            <div id="pdfUploadSpinner" class="w-5 h-5 border-2 border-cyan-500 border-t-transparent rounded-full animate-spin"></div>
                                            <span id="pdfUploadText" class="text-sm text-navy-700">íŒŒì¼ ë¶„ì„ ì¤‘...</span>
                                        </div>
                                    </div>
                                    
                                    <!-- ì¶”ì¶œ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸° -->
                                    <div id="extractedDataPreview" class="hidden mt-4 p-4 bg-white rounded-xl border border-emerald-200">
                                        <div class="flex items-center justify-between mb-3">
                                            <h4 class="font-medium text-emerald-800">âœ“ ì¶”ì¶œ ì™„ë£Œ</h4>
                                            <button onclick="applyExtractedData()" class="px-3 py-1.5 bg-emerald-500 text-white rounded-lg text-sm font-medium hover:bg-emerald-600 transition-colors">
                                                ë°ì´í„° ì ìš©
                                            </button>
                                        </div>
                                        <div id="extractedDataContent" class="text-sm text-navy-600 grid grid-cols-3 gap-2"></div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- E/S/G ìƒì„¸ ì…ë ¥ íƒ­ -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 overflow-hidden">
                            <div class="flex border-b border-navy-200">
                                <button onclick="showDataTab('environment')" class="tab-btn active flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium transition-all" data-tab="environment">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    í™˜ê²½ (E)
                                </button>
                                <button onclick="showDataTab('social')" class="tab-btn flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium text-navy-500 hover:text-navy-700 transition-all" data-tab="social">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 20h5v-2a3 3 0 00-5.356-1.857M17 20H7m10 0v-2c0-.656-.126-1.283-.356-1.857M7 20H2v-2a3 3 0 015.356-1.857M7 20v-2c0-.656.126-1.283.356-1.857m0 0a5.002 5.002 0 019.288 0M15 7a3 3 0 11-6 0 3 3 0 016 0zm6 3a2 2 0 11-4 0 2 2 0 014 0zM7 10a2 2 0 11-4 0 2 2 0 014 0z"></path></svg>
                                    ì‚¬íšŒ (S)
                                </button>
                                <button onclick="showDataTab('governance')" class="tab-btn flex-1 flex items-center justify-center gap-2 px-6 py-4 font-medium text-navy-500 hover:text-navy-700 transition-all" data-tab="governance">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                    ì§€ë°°êµ¬ì¡° (G)
                                </button>
                            </div>

                            <div class="p-6 max-h-[600px] overflow-y-auto">
                                <!-- Environment Tab -->
                                <div id="tab-environment" class="data-tab-content">
                                    <!-- í™˜ê²½ê²½ì˜ ì„¹ì…˜ -->
                                    <div class="mb-6">
                                        <h4 class="text-sm font-semibold text-green-700 mb-3 flex items-center gap-2">
                                            <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                            í™˜ê²½ê²½ì˜ ì²´ê³„
                                        </h4>
                                        <div class="grid grid-cols-2 gap-4">
                                            <label class="flex items-center gap-3 p-3 bg-green-50 rounded-lg cursor-pointer">
                                                <input type="checkbox" id="envPolicy" class="w-5 h-5 rounded border-navy-300 text-green-600">
                                                <span class="text-sm text-navy-700">í™˜ê²½ê²½ì˜ ë°©ì¹¨ ìˆ˜ë¦½</span>
                                            </label>
                                            <label class="flex items-center gap-3 p-3 bg-green-50 rounded-lg cursor-pointer">
                                                <input type="checkbox" id="envOrganization" class="w-5 h-5 rounded border-navy-300 text-green-600">
                                                <span class="text-sm text-navy-700">í™˜ê²½ì „ë‹´ì¡°ì§ ìš´ì˜</span>
                                            </label>
                                            <label class="flex items-center gap-3 p-3 bg-green-50 rounded-lg cursor-pointer">
                                                <input type="checkbox" id="envCertification" class="w-5 h-5 rounded border-navy-300 text-green-600">
                                                <span class="text-sm text-navy-700">í™˜ê²½ê²½ì˜ ì¸ì¦ (ISO14001)</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-green-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="envTarget" class="w-5 h-5 rounded border-navy-300 text-green-600">
                                            <span class="text-sm text-navy-700">í™˜ê²½ ëª©í‘œ ì„¤ì • ë° ê³µê°œ</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- ì˜¨ì‹¤ê°€ìŠ¤/ì—ë„ˆì§€ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-green-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        ì˜¨ì‹¤ê°€ìŠ¤ ë° ì—ë„ˆì§€
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">Scope 1 (ì§ì ‘ë°°ì¶œ)</label>
                                            <div class="relative">
                                                <input type="number" id="scope1Emission" value="450" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">tCOâ‚‚e</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">Scope 2 (ê°„ì ‘ë°°ì¶œ)</label>
                                            <div class="relative">
                                                <input type="number" id="scope2Emission" value="795" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">tCOâ‚‚e</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">Scope 3 (ê¸°íƒ€ë°°ì¶œ)</label>
                                            <div class="relative">
                                                <input type="number" id="scope3Emission" value="2100" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">tCOâ‚‚e</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰</label>
                                            <div class="relative">
                                                <input type="number" id="energyUsage" value="1200000" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">kWh</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì—ë„ˆì§€ ì§‘ì•½ë„</label>
                                            <div class="relative">
                                                <input type="number" id="energyIntensity" value="0.85" step="0.01" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">TJ/ì–µì›</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì¬ìƒì—ë„ˆì§€ ì‚¬ìš©ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="renewableEnergy" value="15" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ìì›ìˆœí™˜ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-green-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        ìš©ìˆ˜ ë° íê¸°ë¬¼ ê´€ë¦¬
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìš©ìˆ˜ ì‚¬ìš©ëŸ‰</label>
                                            <div class="relative">
                                                <input type="number" id="waterUsage" value="50000" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">í†¤</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìš©ìˆ˜ ì¬ì´ìš©ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="waterRecycling" value="25" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">íê¸°ë¬¼ ë°œìƒëŸ‰</label>
                                            <div class="relative">
                                                <input type="number" id="wasteGeneration" value="850" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">í†¤</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">íê¸°ë¬¼ ì¬í™œìš©ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="wasteRecycling" value="60" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ëŒ€ê¸°ì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œ</label>
                                            <div class="relative">
                                                <input type="number" id="airPollution" value="12.5" step="0.1" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">í†¤</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìˆ˜ì§ˆì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œ</label>
                                            <div class="relative">
                                                <input type="number" id="waterPollution" value="8.3" step="0.1" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">í†¤</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- í™˜ê²½ë²•ê·œ ì„¹ì…˜ -->
                                <div>
                                    <h4 class="text-sm font-semibold text-green-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-green-500 rounded-full"></span>
                                        í™˜ê²½ ë¦¬ìŠ¤í¬ ê´€ë¦¬
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">í™˜ê²½ë²•ê·œ ìœ„ë°˜</label>
                                            <div class="relative">
                                                <input type="number" id="envViolations" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">í™˜ê²½ ê´€ë ¨ ê³¼ì§•ê¸ˆ</label>
                                            <div class="relative">
                                                <input type="number" id="envFines" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë§Œì›</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì¹œí™˜ê²½ ì œí’ˆ ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="greenProduct" value="35" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-green-500/30 focus:border-green-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Social Tab -->
                            <div id="tab-social" class="data-tab-content hidden">
                                <!-- ê³ ìš© ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                                        ê³ ìš© í˜„í™©
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ ì„ì§ì› ìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="employeeCount" value="150" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ëª…</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì •ê·œì§ ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="permanentRatio" value="85" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‹ ê·œ ì±„ìš©</label>
                                            <div class="relative">
                                                <input type="number" id="newHires" value="25" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ëª…</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ì§ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="turnoverRate" value="8.5" step="0.1" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">í‰ê·  ê·¼ì†ì—°ìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="avgTenure" value="5.2" step="0.1" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë…„</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">í‰ê·  ê¸‰ì—¬</label>
                                            <div class="relative">
                                                <input type="number" id="avgSalary" value="5200" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë§Œì›</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ë‹¤ì–‘ì„± ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                                        ë‹¤ì–‘ì„± ë° í¬ìš©ì„±
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì—¬ì„± ì„ì§ì› ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="femaleRatio" value="35" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="femaleManagerRatio" value="20" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì¥ì• ì¸ ê³ ìš©ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="disabledRatio" value="3.2" step="0.1" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìœ¡ì•„íœ´ì§ ì‚¬ìš©ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="parentalLeaveRate" value="75" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìœ¡ì•„íœ´ì§ ë³µê·€ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="parentalReturnRate" value="92" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì™¸êµ­ì¸ ì§ì› ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="foreignRatio" value="5" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- êµìœ¡/ì•ˆì „ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                                        êµìœ¡ ë° ì‚°ì—…ì•ˆì „
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì¸ë‹¹ êµìœ¡ì‹œê°„</label>
                                            <div class="relative">
                                                <input type="number" id="trainingHours" value="40" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ì‹œê°„</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì¸ë‹¹ êµìœ¡ë¹„</label>
                                            <div class="relative">
                                                <input type="number" id="trainingCost" value="120" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë§Œì›</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì•ˆì „ë³´ê±´ êµìœ¡ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="safetyTrainingRate" value="100" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‚°ì—…ì¬í•´ ê±´ìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="industrialAccidents" value="2" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ê·¼ë¡œì†ì‹¤ì¬í•´ìœ¨ (LTIR)</label>
                                            <div class="relative">
                                                <input type="number" id="ltir" value="0.52" step="0.01" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‚¬ë§ì‚¬ê³ </label>
                                            <div class="relative">
                                                <input type="number" id="fatalAccidents" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- í˜‘ë ¥ì‚¬/ê³ ê° ì„¹ì…˜ -->
                                <div>
                                    <h4 class="text-sm font-semibold text-blue-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-blue-500 rounded-full"></span>
                                        ê³µê¸‰ë§ ë° ê³ ê°
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">í˜‘ë ¥ì‚¬ ESG í‰ê°€ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="supplierEsgRate" value="45" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ê³ ê°ë§Œì¡±ë„</label>
                                            <div class="relative">
                                                <input type="number" id="customerSatisfaction" value="85" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ì </span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ê°œì¸ì •ë³´ ì¹¨í•´</label>
                                            <div class="relative">
                                                <input type="number" id="privacyBreaches" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì •ë³´ë³´ì•ˆ ì‚¬ê³ </label>
                                            <div class="relative">
                                                <input type="number" id="securityIncidents" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‚¬íšŒê³µí—Œ íˆ¬ì</label>
                                            <div class="relative">
                                                <input type="number" id="socialInvestment" value="5000" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë§Œì›</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë´‰ì‚¬í™œë™ ì°¸ì—¬ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="volunteerRate" value="25" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-blue-500/30 focus:border-blue-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Governance Tab -->
                            <div id="tab-governance" class="data-tab-content hidden">
                                <!-- ì´ì‚¬íšŒ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                                        ì´ì‚¬íšŒ êµ¬ì„± ë° ìš´ì˜
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ì‚¬íšŒ ê·œëª¨</label>
                                            <div class="relative">
                                                <input type="number" id="boardSize" value="7" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ëª…</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="boardIndependence" value="40" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì—¬ì„± ì´ì‚¬ ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="femaleBoardRatio" value="14" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ì‚¬íšŒ ê°œìµœ íšŸìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="boardMeetings" value="12" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">íšŒ</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì´ì‚¬íšŒ ì¶œì„ë¥ </label>
                                            <div class="relative">
                                                <input type="number" id="boardAttendance" value="95" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ì‚¬ì™¸ì´ì‚¬ ì „ë¬¸ì„±</label>
                                            <div class="relative">
                                                <input type="number" id="boardExpertise" value="3" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë¶„ì•¼</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ìœ„ì›íšŒ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                                        ìœ„ì›íšŒ ì„¤ì¹˜ í˜„í™©
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="auditCommittee" checked class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ê°ì‚¬ìœ„ì›íšŒ</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="esgCommittee" class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ESG ìœ„ì›íšŒ</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="nominationCommittee" class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ì‚¬ì™¸ì´ì‚¬í›„ë³´ì¶”ì²œìœ„ì›íšŒ</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="compensationCommittee" class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ë³´ìƒìœ„ì›íšŒ</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="riskCommittee" class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ë¦¬ìŠ¤í¬ê´€ë¦¬ìœ„ì›íšŒ</span>
                                        </label>
                                        <label class="flex items-center gap-3 p-3 bg-purple-50 rounded-lg cursor-pointer">
                                            <input type="checkbox" id="internalAudit" checked class="w-5 h-5 rounded border-navy-300 text-purple-600">
                                            <span class="text-sm text-navy-700">ë‚´ë¶€ê°ì‚¬ë¶€ì„œ</span>
                                        </label>
                                    </div>
                                </div>

                                <!-- ìœ¤ë¦¬ê²½ì˜ ì„¹ì…˜ -->
                                <div class="mb-6">
                                    <h4 class="text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                                        ìœ¤ë¦¬ê²½ì˜
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ìœ¤ë¦¬ê·œì • ìœ„ë°˜</label>
                                            <div class="relative">
                                                <input type="number" id="ethicsViolations" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë°˜ë¶€íŒ¨ êµìœ¡ ì´ìˆ˜ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="antiCorruptionTraining" value="80" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë‚´ë¶€ê³ ë°œ ì ‘ìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="whistleblowing" value="3" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ê³µì •ê±°ë˜ ìœ„ë°˜</label>
                                            <div class="relative">
                                                <input type="number" id="fairTradeViolations" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë¶€íŒ¨ ê´€ë ¨ ê³¼ì§•ê¸ˆ</label>
                                            <div class="relative">
                                                <input type="number" id="corruptionFines" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë§Œì›</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë²•ê·œ ìœ„ë°˜ ê±´ìˆ˜</label>
                                            <div class="relative">
                                                <input type="number" id="legalViolations" value="0" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ê±´</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- ì£¼ì£¼ê¶Œë¦¬/ë³´ìˆ˜ ì„¹ì…˜ -->
                                <div>
                                    <h4 class="text-sm font-semibold text-purple-700 mb-3 flex items-center gap-2">
                                        <span class="w-2 h-2 bg-purple-500 rounded-full"></span>
                                        ì£¼ì£¼ê¶Œë¦¬ ë° ë³´ìˆ˜
                                    </h4>
                                    <div class="grid grid-cols-3 gap-4">
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ë°°ë‹¹ì„±í–¥</label>
                                            <div class="relative">
                                                <input type="number" id="dividendPayout" value="30" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">CEO ë³´ìˆ˜ë¹„ìœ¨</label>
                                            <div class="relative">
                                                <input type="number" id="ceoPayRatio" value="15" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">ë°°</span>
                                            </div>
                                        </div>
                                        <div class="space-y-1">
                                            <label class="block text-xs font-medium text-navy-600">ESG ì •ë³´ê³µê°œ ìˆ˜ì¤€</label>
                                            <div class="relative">
                                                <input type="number" id="esgDisclosure" value="75" class="w-full px-3 py-2 text-sm border border-navy-300 rounded-lg focus:ring-2 focus:ring-purple-500/30 focus:border-purple-500">
                                                <span class="absolute right-3 top-1/2 -translate-y-1/2 text-navy-400 text-xs">%</span>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="mt-8 flex items-center justify-end gap-4">
                                <span id="saveMessage" class="text-emerald-600 text-sm font-medium hidden">âœ“ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</span>
                                <button onclick="saveData()" class="px-6 py-3 bg-navy-900 text-white rounded-xl font-medium hover:bg-navy-800 transition-colors flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                                    ë°ì´í„° ì €ì¥
                                </button>
                            </div>
                        </div>
                    </div>
                    </div><!-- ìƒì„¸ ì…ë ¥ ëª¨ë“œ ë‹«ê¸° -->
                </div>
            </div>

            <!-- ==================== AI ë¦¬í¬íŠ¸ í˜ì´ì§€ (ë ˆì´ì•„ì›ƒ ê¸°ë°˜) ==================== -->
            <div id="page-ai-report" class="page">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4 flex items-center justify-between">
                        <div>
                            <h2 class="font-display text-2xl font-bold text-navy-900">AI ë¦¬í¬íŠ¸ ìƒì„±</h2>
                            <p class="text-navy-500 text-sm mt-0.5">ë ˆì´ì•„ì›ƒì„ ì„ íƒí•˜ê³ , AIê°€ ë‚´ìš©ì„ ì±„ìš°ê³ , ì§ì ‘ í¸ì§‘í•˜ì—¬ PDFë¡œ ë‚´ë³´ë‚´ì„¸ìš”</p>
                        </div>
                        <div class="flex items-center gap-3">
                            <button onclick="generateAllSections()" id="generateAllBtn" class="px-5 py-2.5 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-xl font-medium hover:opacity-90 transition-opacity flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                AIë¡œ ì „ì²´ ìƒì„±
                            </button>
                            <button onclick="exportToPDF()" class="px-5 py-2.5 bg-rose-500 text-white rounded-xl font-medium hover:bg-rose-600 transition-colors flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                PDF ë‹¤ìš´ë¡œë“œ
                            </button>
                        </div>
                    </div>
                </header>
                
                <div class="p-8">
                    <div class="flex gap-6">
                        <!-- ì™¼ìª½: í…œí”Œë¦¿ & ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ -->
                        <div class="w-72 flex-shrink-0 space-y-4">
                            <!-- í…œí”Œë¦¿ ì„ íƒ -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-5">
                                <h3 class="font-semibold text-navy-900 mb-3 flex items-center gap-2">
                                    <svg class="w-5 h-5 text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 5a1 1 0 011-1h14a1 1 0 011 1v2a1 1 0 01-1 1H5a1 1 0 01-1-1V5zM4 13a1 1 0 011-1h6a1 1 0 011 1v6a1 1 0 01-1 1H5a1 1 0 01-1-1v-6zM16 13a1 1 0 011-1h2a1 1 0 011 1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-6z"></path></svg>
                                    ë ˆì´ì•„ì›ƒ í…œí”Œë¦¿
                                </h3>
                                <div class="space-y-2">
                                    <button onclick="selectReportLayout('professional')" class="layout-btn w-full p-3 rounded-xl border-2 border-cyan-500 bg-cyan-50 text-left transition-all" data-layout="professional">
                                        <p class="font-medium text-navy-900 text-sm">ğŸ“Š í”„ë¡œí˜ì…”ë„</p>
                                        <p class="text-navy-400 text-xs mt-0.5">ê¸°ì—… ê³µì‹ ë³´ê³ ì„œìš©</p>
                                    </button>
                                    <button onclick="selectReportLayout('simple')" class="layout-btn w-full p-3 rounded-xl border border-navy-200 hover:border-navy-300 text-left transition-all" data-layout="simple">
                                        <p class="font-medium text-navy-900 text-sm">ğŸ“ ì‹¬í”Œ</p>
                                        <p class="text-navy-400 text-xs mt-0.5">ê°„ê²°í•œ ìš”ì•½ ë³´ê³ ì„œ</p>
                                    </button>
                                    <button onclick="selectReportLayout('infographic')" class="layout-btn w-full p-3 rounded-xl border border-navy-200 hover:border-navy-300 text-left transition-all" data-layout="infographic">
                                        <p class="font-medium text-navy-900 text-sm">ğŸ“ˆ ì¸í¬ê·¸ë˜í”½</p>
                                        <p class="text-navy-400 text-xs mt-0.5">ì°¨íŠ¸ ì¤‘ì‹¬ ì‹œê°í™”</p>
                                    </button>
                                </div>
                            </div>

                            <!-- ì„¹ì…˜ ë„¤ë¹„ê²Œì´ì…˜ -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-5">
                                <h3 class="font-semibold text-navy-900 mb-3 flex items-center gap-2">
                                    <svg class="w-5 h-5 text-emerald-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 10h16M4 14h16M4 18h16"></path></svg>
                                    ì„¹ì…˜
                                </h3>
                                <div class="space-y-1" id="sectionNavList">
                                    <button onclick="scrollToSection('cover')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-navy-100 text-navy-600 flex items-center justify-center text-xs font-medium">1</span>
                                            í‘œì§€
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                    <button onclick="scrollToSection('summary')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-navy-100 text-navy-600 flex items-center justify-center text-xs font-medium">2</span>
                                            ìš”ì•½
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                    <button onclick="scrollToSection('environment')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs font-medium">E</span>
                                            í™˜ê²½
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                    <button onclick="scrollToSection('social')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-blue-100 text-blue-600 flex items-center justify-center text-xs font-medium">S</span>
                                            ì‚¬íšŒ
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                    <button onclick="scrollToSection('governance')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-purple-100 text-purple-600 flex items-center justify-center text-xs font-medium">G</span>
                                            ì§€ë°°êµ¬ì¡°
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                    <button onclick="scrollToSection('recommendations')" class="section-nav-btn w-full px-3 py-2 rounded-lg text-left text-sm hover:bg-navy-50 flex items-center justify-between group">
                                        <span class="flex items-center gap-2">
                                            <span class="w-6 h-6 rounded bg-amber-100 text-amber-600 flex items-center justify-center text-xs font-medium">!</span>
                                            ê°œì„ ê³¼ì œ
                                        </span>
                                        <svg class="w-4 h-4 text-navy-300 group-hover:text-cyan-500" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>
                                    </button>
                                </div>
                            </div>

                            <!-- í¸ì§‘ ë„ì›€ë§ -->
                            <div class="bg-gradient-to-br from-cyan-50 to-emerald-50 rounded-2xl p-5 border border-cyan-200">
                                <h4 class="font-medium text-navy-900 mb-2 flex items-center gap-2">
                                    <svg class="w-4 h-4 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                    í¸ì§‘ ë„ì›€ë§
                                </h4>
                                <ul class="text-xs text-navy-600 space-y-1">
                                    <li>â€¢ í…ìŠ¤íŠ¸ë¥¼ í´ë¦­í•˜ë©´ ì§ì ‘ ìˆ˜ì • ê°€ëŠ¥</li>
                                    <li>â€¢ âš¡ ë²„íŠ¼ìœ¼ë¡œ í•´ë‹¹ ì„¹ì…˜ë§Œ AI ìƒì„±</li>
                                    <li>â€¢ PDF ë‹¤ìš´ë¡œë“œë¡œ ë³´ê³ ì„œ ì €ì¥</li>
                                </ul>
                            </div>
                        </div>

                        <!-- ì˜¤ë¥¸ìª½: ë³´ê³ ì„œ í”„ë¦¬ë·° -->
                        <div class="flex-1 bg-gray-100 rounded-2xl p-6 overflow-y-auto" style="max-height: calc(100vh - 180px);">
                            <div id="reportPreview" class="bg-white shadow-xl rounded-lg overflow-hidden" >
                                
                                <!-- í‘œì§€ ì„¹ì…˜ -->
                                <section id="section-cover" class="report-section p-12  flex flex-col justify-center items-center text-center bg-gradient-to-br from-navy-900 via-navy-800 to-emerald-900 text-white relative overflow-hidden">
                                    <div class="absolute inset-0 opacity-10">
                                        <div class="absolute top-10 left-10 w-64 h-64 bg-emerald-500 rounded-full blur-3xl"></div>
                                        <div class="absolute bottom-10 right-10 w-80 h-80 bg-cyan-500 rounded-full blur-3xl"></div>
                                    </div>
                                    <div class="relative z-10">
                                        <div class="w-20 h-20 mx-auto mb-8 bg-white/20 rounded-2xl flex items-center justify-center backdrop-blur-sm">
                                            <svg class="w-10 h-10 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"></path></svg>
                                        </div>
                                        <p class="text-emerald-300 text-lg mb-4 font-medium tracking-widest">ESG MANAGEMENT REPORT</p>
                                        <h1 contenteditable="true" class="text-5xl font-bold mb-6 editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded px-2" id="cover-title">ESG ê²½ì˜ ë³´ê³ ì„œ</h1>
                                        <h2 contenteditable="true" class="text-3xl font-light mb-12 editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded px-2" id="cover-company">ì£¼ì‹íšŒì‚¬ ESGì¸ì‚¬ì´íŠ¸</h2>
                                        <div class="flex items-center justify-center gap-8 text-white/70">
                                            <span contenteditable="true" class="editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded px-2" id="cover-period">2024ë…„ 4ë¶„ê¸°</span>
                                            <span>|</span>
                                            <span contenteditable="true" class="editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded px-2" id="cover-date">2024.12.15</span>
                                        </div>
                                    </div>
                                </section>

                                <!-- ìš”ì•½ ì„¹ì…˜ -->
                                <section id="section-summary" class="report-section p-12  bg-white">
                                    <div class="flex items-center justify-between mb-8">
                                        <h2 class="text-3xl font-bold text-navy-900 border-l-4 border-cyan-500 pl-4">Executive Summary</h2>
                                        <button onclick="generateSection('summary')" class="p-2 bg-cyan-100 hover:bg-cyan-200 rounded-lg transition-colors" title="AIë¡œ ìƒì„±">
                                            <svg class="w-5 h-5 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                        </button>
                                    </div>
                                    
                                    <!-- ESG ì ìˆ˜ ì¹´ë“œ -->
                                    <div class="grid grid-cols-4 gap-4 mb-8">
                                        <div class="bg-gradient-to-br from-navy-50 to-navy-100 rounded-xl p-5 text-center">
                                            <p class="text-sm text-navy-500 mb-1">ì¢…í•© ì ìˆ˜</p>
                                            <p class="text-4xl font-bold text-navy-900" id="summary-total-score">78</p>
                                            <p class="text-lg font-semibold text-emerald-600" id="summary-grade">Aë“±ê¸‰</p>
                                        </div>
                                        <div class="bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl p-5 text-center">
                                            <p class="text-sm text-emerald-600 mb-1">í™˜ê²½ (E)</p>
                                            <p class="text-4xl font-bold text-emerald-700" id="summary-e-score">75</p>
                                        </div>
                                        <div class="bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl p-5 text-center">
                                            <p class="text-sm text-blue-600 mb-1">ì‚¬íšŒ (S)</p>
                                            <p class="text-4xl font-bold text-blue-700" id="summary-s-score">82</p>
                                        </div>
                                        <div class="bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl p-5 text-center">
                                            <p class="text-sm text-purple-600 mb-1">ì§€ë°°êµ¬ì¡° (G)</p>
                                            <p class="text-4xl font-bold text-purple-700" id="summary-g-score">77</p>
                                        </div>
                                    </div>

                                    <!-- ìš”ì•½ ë‚´ìš© -->
                                    <div class="bg-navy-50 rounded-xl p-6 mb-6">
                                        <h3 class="font-semibold text-navy-900 mb-3">ğŸ“‹ í•µì‹¬ ìš”ì•½</h3>
                                        <div contenteditable="true" class="text-navy-700 leading-relaxed editable-field outline-none focus:ring-2 focus:ring-cyan-400 rounded p-2 min-h-[100px]" id="summary-content">
                                            AI ìƒì„± ë²„íŠ¼(âš¡)ì„ í´ë¦­í•˜ë©´ ì´ ì˜ì—­ì— ESG ê²½ì˜ í˜„í™© ìš”ì•½ì´ ìë™ìœ¼ë¡œ ì‘ì„±ë©ë‹ˆë‹¤. ì§ì ‘ ë‚´ìš©ì„ ì…ë ¥í•˜ê±°ë‚˜ ìˆ˜ì •í•  ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.
                                        </div>
                                    </div>

                                    <!-- ì£¼ìš” ì„±ê³¼ -->
                                    <div class="grid grid-cols-2 gap-6">
                                        <div class="border border-emerald-200 rounded-xl p-5">
                                            <h4 class="font-semibold text-emerald-700 mb-3 flex items-center gap-2">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                                ì£¼ìš” ì„±ê³¼
                                            </h4>
                                            <ul contenteditable="true" class="text-sm text-navy-600 space-y-2 editable-field outline-none focus:ring-2 focus:ring-cyan-400 rounded p-2 min-h-[80px]" id="summary-achievements">
                                                <li>â€¢ íƒ„ì†Œ ë°°ì¶œëŸ‰ ì „ë…„ ëŒ€ë¹„ 15% ê°ì¶•</li>
                                                <li>â€¢ ì¬ìƒì—ë„ˆì§€ ì‚¬ìš© ë¹„ìœ¨ 25% ë‹¬ì„±</li>
                                                <li>â€¢ ì‚°ì—…ì¬í•´ìœ¨ 0.5% ì´í•˜ ìœ ì§€</li>
                                            </ul>
                                        </div>
                                        <div class="border border-amber-200 rounded-xl p-5">
                                            <h4 class="font-semibold text-amber-700 mb-3 flex items-center gap-2">
                                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                                                ê°œì„  í•„ìš” ì˜ì—­
                                            </h4>
                                            <ul contenteditable="true" class="text-sm text-navy-600 space-y-2 editable-field outline-none focus:ring-2 focus:ring-cyan-400 rounded p-2 min-h-[80px]" id="summary-improvements">
                                                <li>â€¢ ì´ì‚¬íšŒ ë‹¤ì–‘ì„± í™•ëŒ€ í•„ìš”</li>
                                                <li>â€¢ í˜‘ë ¥ì‚¬ ESG í‰ê°€ ì²´ê³„ êµ¬ì¶•</li>
                                                <li>â€¢ ìš©ìˆ˜ ì¬ì´ìš©ë¥  ê°œì„  í•„ìš”</li>
                                            </ul>
                                        </div>
                                    </div>
                                </section>

                                <!-- í™˜ê²½(E) ì„¹ì…˜ -->
                                <section id="section-environment" class="report-section p-12  bg-gradient-to-b from-white to-emerald-50">
                                    <div class="flex items-center justify-between mb-8">
                                        <h2 class="text-3xl font-bold text-navy-900 border-l-4 border-emerald-500 pl-4">
                                            <span class="text-emerald-600">E</span>nvironment í™˜ê²½
                                        </h2>
                                        <button onclick="generateSection('environment')" class="p-2 bg-emerald-100 hover:bg-emerald-200 rounded-lg transition-colors" title="AIë¡œ ìƒì„±">
                                            <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                        </button>
                                    </div>

                                    <!-- í™˜ê²½ ì§€í‘œ -->
                                    <div class="grid grid-cols-3 gap-4 mb-8">
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-emerald-100">
                                            <p class="text-sm text-navy-500 mb-1">ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰</p>
                                            <p class="text-2xl font-bold text-navy-900" id="env-ghg">1,250 <span class="text-sm font-normal">tCO2e</span></p>
                                            <p class="text-xs text-emerald-600 mt-1">â–¼ 15% ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-emerald-100">
                                            <p class="text-sm text-navy-500 mb-1">ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰</p>
                                            <p class="text-2xl font-bold text-navy-900" id="env-energy">45,000 <span class="text-sm font-normal">kWh</span></p>
                                            <p class="text-xs text-emerald-600 mt-1">â–¼ 8% ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-emerald-100">
                                            <p class="text-sm text-navy-500 mb-1">ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨</p>
                                            <p class="text-2xl font-bold text-navy-900" id="env-renewable">25<span class="text-sm font-normal">%</span></p>
                                            <p class="text-xs text-emerald-600 mt-1">â–² 10%p ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                    </div>

                                    <!-- í™˜ê²½ ë¶„ì„ ë‚´ìš© -->
                                    <div class="bg-white rounded-xl p-6 shadow-sm border border-emerald-100 mb-6">
                                        <h3 class="font-semibold text-navy-900 mb-4">ğŸŒ± í™˜ê²½ ê²½ì˜ í˜„í™©</h3>
                                        <div contenteditable="true" class="text-navy-700 leading-relaxed editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded p-2 min-h-[150px]" id="env-content">
                                            ì´ ì˜ì—­ì— í™˜ê²½ ê²½ì˜ í˜„í™© ë° ì„±ê³¼ê°€ ì‘ì„±ë©ë‹ˆë‹¤. AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ê±°ë‚˜ ì§ì ‘ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”.

                                            â€¢ ê¸°í›„ë³€í™” ëŒ€ì‘ ì „ëµ
                                            â€¢ ì—ë„ˆì§€ íš¨ìœ¨í™” í™œë™
                                            â€¢ íê¸°ë¬¼ ê´€ë¦¬ í˜„í™©
                                            â€¢ í™˜ê²½ ëª©í‘œ ë° ì‹¤ì 
                                        </div>
                                    </div>

                                    <!-- í™˜ê²½ ëª©í‘œ -->
                                    <div class="bg-emerald-50 rounded-xl p-6 border border-emerald-200">
                                        <h3 class="font-semibold text-emerald-800 mb-3">ğŸ¯ í™˜ê²½ ëª©í‘œ</h3>
                                        <div contenteditable="true" class="text-navy-700 editable-field outline-none focus:ring-2 focus:ring-emerald-400 rounded p-2" id="env-goals">
                                            â€¢ 2025ë…„: ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰ 20% ê°ì¶• (2020ë…„ ëŒ€ë¹„)
                                            â€¢ 2030ë…„: ì¬ìƒì—ë„ˆì§€ ì „í™˜ìœ¨ 50% ë‹¬ì„±
                                            â€¢ 2050ë…„: íƒ„ì†Œì¤‘ë¦½ ë‹¬ì„±
                                        </div>
                                    </div>
                                </section>

                                <!-- ì‚¬íšŒ(S) ì„¹ì…˜ -->
                                <section id="section-social" class="report-section p-12  bg-gradient-to-b from-white to-blue-50">
                                    <div class="flex items-center justify-between mb-8">
                                        <h2 class="text-3xl font-bold text-navy-900 border-l-4 border-blue-500 pl-4">
                                            <span class="text-blue-600">S</span>ocial ì‚¬íšŒ
                                        </h2>
                                        <button onclick="generateSection('social')" class="p-2 bg-blue-100 hover:bg-blue-200 rounded-lg transition-colors" title="AIë¡œ ìƒì„±">
                                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                        </button>
                                    </div>

                                    <!-- ì‚¬íšŒ ì§€í‘œ -->
                                    <div class="grid grid-cols-3 gap-4 mb-8">
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-blue-100">
                                            <p class="text-sm text-navy-500 mb-1">ì„ì§ì› ìˆ˜</p>
                                            <p class="text-2xl font-bold text-navy-900" id="social-employees">150 <span class="text-sm font-normal">ëª…</span></p>
                                            <p class="text-xs text-blue-600 mt-1">â–² 12% ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-blue-100">
                                            <p class="text-sm text-navy-500 mb-1">ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨</p>
                                            <p class="text-2xl font-bold text-navy-900" id="social-diversity">28<span class="text-sm font-normal">%</span></p>
                                            <p class="text-xs text-blue-600 mt-1">â–² 5%p ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-blue-100">
                                            <p class="text-sm text-navy-500 mb-1">ì‚°ì—…ì¬í•´ìœ¨</p>
                                            <p class="text-2xl font-bold text-navy-900" id="social-safety">0.3<span class="text-sm font-normal">%</span></p>
                                            <p class="text-xs text-emerald-600 mt-1">â–¼ 0.2%p ì „ë…„ëŒ€ë¹„</p>
                                        </div>
                                    </div>

                                    <!-- ì‚¬íšŒ ë¶„ì„ ë‚´ìš© -->
                                    <div class="bg-white rounded-xl p-6 shadow-sm border border-blue-100 mb-6">
                                        <h3 class="font-semibold text-navy-900 mb-4">ğŸ‘¥ ì‚¬íšŒì  ì±…ì„ í˜„í™©</h3>
                                        <div contenteditable="true" class="text-navy-700 leading-relaxed editable-field outline-none focus:ring-2 focus:ring-blue-400 rounded p-2 min-h-[150px]" id="social-content">
                                            ì´ ì˜ì—­ì— ì‚¬íšŒì  ì±…ì„ í˜„í™© ë° ì„±ê³¼ê°€ ì‘ì„±ë©ë‹ˆë‹¤.

                                            â€¢ ì¸ê¶Œê²½ì˜ ë° ë‹¤ì–‘ì„±
                                            â€¢ ì‚°ì—…ì•ˆì „ë³´ê±´ ê´€ë¦¬
                                            â€¢ í˜‘ë ¥ì‚¬ ìƒìƒ í”„ë¡œê·¸ë¨
                                            â€¢ ì§€ì—­ì‚¬íšŒ ê³µí—Œ í™œë™
                                        </div>
                                    </div>

                                    <!-- ì‚¬íšŒ í”„ë¡œê·¸ë¨ -->
                                    <div class="grid grid-cols-2 gap-4">
                                        <div class="bg-blue-50 rounded-xl p-5 border border-blue-200">
                                            <h4 class="font-semibold text-blue-800 mb-2">ğŸ“ êµìœ¡í›ˆë ¨</h4>
                                            <p contenteditable="true" class="text-sm text-navy-600 editable-field outline-none focus:ring-2 focus:ring-blue-400 rounded p-1" id="social-training">
                                                ì¸ë‹¹ í‰ê·  êµìœ¡ì‹œê°„: 40ì‹œê°„/ë…„<br>
                                                ESG êµìœ¡ ì´ìˆ˜ìœ¨: 95%
                                            </p>
                                        </div>
                                        <div class="bg-blue-50 rounded-xl p-5 border border-blue-200">
                                            <h4 class="font-semibold text-blue-800 mb-2">ğŸ¤ ì‚¬íšŒê³µí—Œ</h4>
                                            <p contenteditable="true" class="text-sm text-navy-600 editable-field outline-none focus:ring-2 focus:ring-blue-400 rounded p-1" id="social-contribution">
                                                ì‚¬íšŒê³µí—Œ íˆ¬ì: 5,000ë§Œì›<br>
                                                ë´‰ì‚¬í™œë™ ì°¸ì—¬ìœ¨: 70%
                                            </p>
                                        </div>
                                    </div>
                                </section>

                                <!-- ì§€ë°°êµ¬ì¡°(G) ì„¹ì…˜ -->
                                <section id="section-governance" class="report-section p-12  bg-gradient-to-b from-white to-purple-50">
                                    <div class="flex items-center justify-between mb-8">
                                        <h2 class="text-3xl font-bold text-navy-900 border-l-4 border-purple-500 pl-4">
                                            <span class="text-purple-600">G</span>overnance ì§€ë°°êµ¬ì¡°
                                        </h2>
                                        <button onclick="generateSection('governance')" class="p-2 bg-purple-100 hover:bg-purple-200 rounded-lg transition-colors" title="AIë¡œ ìƒì„±">
                                            <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                        </button>
                                    </div>

                                    <!-- ì§€ë°°êµ¬ì¡° ì§€í‘œ -->
                                    <div class="grid grid-cols-3 gap-4 mb-8">
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-purple-100">
                                            <p class="text-sm text-navy-500 mb-1">ì´ì‚¬íšŒ ê°œìµœ</p>
                                            <p class="text-2xl font-bold text-navy-900" id="gov-board">12 <span class="text-sm font-normal">íšŒ/ë…„</span></p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-purple-100">
                                            <p class="text-sm text-navy-500 mb-1">ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨</p>
                                            <p class="text-2xl font-bold text-navy-900" id="gov-independent">40<span class="text-sm font-normal">%</span></p>
                                        </div>
                                        <div class="bg-white rounded-xl p-5 shadow-sm border border-purple-100">
                                            <p class="text-sm text-navy-500 mb-1">ìœ¤ë¦¬ê²½ì˜ êµìœ¡</p>
                                            <p class="text-2xl font-bold text-navy-900" id="gov-ethics">100<span class="text-sm font-normal">%</span></p>
                                        </div>
                                    </div>

                                    <!-- ì§€ë°°êµ¬ì¡° ë¶„ì„ ë‚´ìš© -->
                                    <div class="bg-white rounded-xl p-6 shadow-sm border border-purple-100 mb-6">
                                        <h3 class="font-semibold text-navy-900 mb-4">âš–ï¸ ì§€ë°°êµ¬ì¡° í˜„í™©</h3>
                                        <div contenteditable="true" class="text-navy-700 leading-relaxed editable-field outline-none focus:ring-2 focus:ring-purple-400 rounded p-2 min-h-[150px]" id="gov-content">
                                            ì´ ì˜ì—­ì— ì§€ë°°êµ¬ì¡° í˜„í™© ë° ì„±ê³¼ê°€ ì‘ì„±ë©ë‹ˆë‹¤.

                                            â€¢ ì´ì‚¬íšŒ êµ¬ì„± ë° ìš´ì˜
                                            â€¢ ìœ¤ë¦¬ê²½ì˜ ì²´ê³„
                                            â€¢ ë‚´ë¶€í†µì œ ì‹œìŠ¤í…œ
                                            â€¢ ì •ë³´ê³µì‹œ íˆ¬ëª…ì„±
                                        </div>
                                    </div>

                                    <!-- ê±°ë²„ë„ŒìŠ¤ êµ¬ì¡° -->
                                    <div class="bg-purple-50 rounded-xl p-6 border border-purple-200">
                                        <h3 class="font-semibold text-purple-800 mb-4">ğŸ›ï¸ ì´ì‚¬íšŒ êµ¬ì„±</h3>
                                        <div class="grid grid-cols-3 gap-4 text-center">
                                            <div class="bg-white rounded-lg p-4">
                                                <p class="text-2xl font-bold text-navy-900" id="gov-total-directors">5</p>
                                                <p class="text-sm text-navy-500">ì´ ì´ì‚¬ ìˆ˜</p>
                                            </div>
                                            <div class="bg-white rounded-lg p-4">
                                                <p class="text-2xl font-bold text-purple-600" id="gov-outside-directors">2</p>
                                                <p class="text-sm text-navy-500">ì‚¬ì™¸ì´ì‚¬</p>
                                            </div>
                                            <div class="bg-white rounded-lg p-4">
                                                <p class="text-2xl font-bold text-blue-600" id="gov-female-directors">1</p>
                                                <p class="text-sm text-navy-500">ì—¬ì„± ì´ì‚¬</p>
                                            </div>
                                        </div>
                                    </div>
                                </section>

                                <!-- ê°œì„ ê³¼ì œ ì„¹ì…˜ -->
                                <section id="section-recommendations" class="report-section p-12  bg-gradient-to-b from-white to-amber-50">
                                    <div class="flex items-center justify-between mb-8">
                                        <h2 class="text-3xl font-bold text-navy-900 border-l-4 border-amber-500 pl-4">ê°œì„ ê³¼ì œ ë° ëª©í‘œ</h2>
                                        <button onclick="generateSection('recommendations')" class="p-2 bg-amber-100 hover:bg-amber-200 rounded-lg transition-colors" title="AIë¡œ ìƒì„±">
                                            <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                        </button>
                                    </div>

                                    <!-- ê°œì„ ê³¼ì œ í…Œì´ë¸” -->
                                    <div class="bg-white rounded-xl shadow-sm border border-amber-100 overflow-hidden mb-8">
                                        <table class="w-full">
                                            <thead class="bg-amber-50">
                                                <tr>
                                                    <th class="px-4 py-3 text-left text-sm font-semibold text-navy-900">ì˜ì—­</th>
                                                    <th class="px-4 py-3 text-left text-sm font-semibold text-navy-900">ê³¼ì œ</th>
                                                    <th class="px-4 py-3 text-left text-sm font-semibold text-navy-900">ëª©í‘œ</th>
                                                    <th class="px-4 py-3 text-left text-sm font-semibold text-navy-900">ê¸°í•œ</th>
                                                </tr>
                                            </thead>
                                            <tbody id="recommendations-table">
                                                <tr class="border-t border-amber-100">
                                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-emerald-100 text-emerald-700 rounded text-xs font-medium">í™˜ê²½</span></td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">ì¬ìƒì—ë„ˆì§€ ì „í™˜ í™•ëŒ€</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">ì „í™˜ìœ¨ 40% ë‹¬ì„±</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">2025ë…„ ë§</td>
                                                </tr>
                                                <tr class="border-t border-amber-100">
                                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-blue-100 text-blue-700 rounded text-xs font-medium">ì‚¬íšŒ</span></td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨ í™•ëŒ€</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">35% ë‹¬ì„±</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">2025ë…„ ë§</td>
                                                </tr>
                                                <tr class="border-t border-amber-100">
                                                    <td class="px-4 py-3"><span class="px-2 py-1 bg-purple-100 text-purple-700 rounded text-xs font-medium">ì§€ë°°êµ¬ì¡°</span></td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">ESG ìœ„ì›íšŒ ì‹ ì„¤</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">ì´ì‚¬íšŒ ì‚°í•˜ ì„¤ì¹˜</td>
                                                    <td contenteditable="true" class="px-4 py-3 text-sm text-navy-700 editable-field">2025ë…„ ìƒë°˜ê¸°</td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>

                                    <!-- ë¡œë“œë§µ -->
                                    <div class="bg-white rounded-xl p-6 shadow-sm border border-amber-100">
                                        <h3 class="font-semibold text-navy-900 mb-4">ğŸ—“ï¸ ESG ì¶”ì§„ ë¡œë“œë§µ</h3>
                                        <div contenteditable="true" class="text-navy-700 leading-relaxed editable-field outline-none focus:ring-2 focus:ring-amber-400 rounded p-2 min-h-[120px]" id="roadmap-content">
                                            <strong>2025ë…„:</strong> ESG ê²½ì˜ ì²´ê³„ ê³ ë„í™”, íƒ„ì†Œì¤‘ë¦½ ë¡œë“œë§µ ìˆ˜ë¦½
                                            <br><br>
                                            <strong>2026ë…„:</strong> í˜‘ë ¥ì‚¬ ESG í‰ê°€ í™•ëŒ€, RE100 ê°€ì… ì¶”ì§„
                                            <br><br>
                                            <strong>2027ë…„:</strong> ESG ì •ë³´ê³µì‹œ êµ­ì œí‘œì¤€ ì ìš©, SBTi ëª©í‘œ ì„¤ì •
                                        </div>
                                    </div>

                                    <!-- í‘¸í„° -->
                                    <div class="mt-12 pt-8 border-t border-navy-200 text-center text-sm text-navy-400">
                                        <p>ë³¸ ë³´ê³ ì„œëŠ” ESG Insight í”Œë«í¼ì„ í†µí•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                                        <p class="mt-1">Â© 2024 ESG Insight. All rights reserved.</p>
                                    </div>
                                </section>

                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== AI ì»¨ì„¤í„´íŠ¸ í˜ì´ì§€ ==================== -->
            <div id="page-ai-advisor" class="page">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4">
                        <h2 class="font-display text-2xl font-bold text-navy-900">AI ESG ì»¨ì„¤í„´íŠ¸</h2>
                        <p class="text-navy-500 text-sm mt-0.5">Claude AIì™€ ëŒ€í™”í•˜ë©° ESG ê´€ë ¨ ì§ˆë¬¸ì— ë‹µë³€ì„ ë°›ìœ¼ì„¸ìš”</p>
                    </div>
                </header>
                
                <div class="p-8 h-[calc(100vh-120px)] flex flex-col">
                    <div class="flex-1 bg-white rounded-2xl shadow-sm border border-navy-100 flex flex-col overflow-hidden">
                        <div id="chatMessages" class="flex-1 p-6 overflow-y-auto space-y-4">
                            <div class="flex gap-3">
                                <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center flex-shrink-0">
                                    <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                                </div>
                                <div class="bg-navy-50 rounded-2xl rounded-tl-none p-4 max-w-2xl">
                                    <p class="text-navy-700 text-sm">ì•ˆë…•í•˜ì„¸ìš”! ESG ì»¨ì„¤í„´íŠ¸ AIì…ë‹ˆë‹¤. ê·€ì‚¬ì˜ ESG ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë§ì¶¤í˜• ì¡°ì–¸ì„ ë“œë¦½ë‹ˆë‹¤. ë¬´ì—‡ì´ë“  ë¬¼ì–´ë³´ì„¸ìš”!</p>
                                    <p class="text-navy-400 text-xs mt-2">ì˜ˆì‹œ ì§ˆë¬¸:</p>
                                    <ul class="text-navy-500 text-xs mt-1 space-y-1">
                                        <li>â€¢ ìš°ë¦¬ íšŒì‚¬ ESG ì ìˆ˜ë¥¼ ì˜¬ë¦¬ë ¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í•˜ë‚˜ìš”?</li>
                                        <li>â€¢ íƒ„ì†Œ ë°°ì¶œëŸ‰ì„ ì¤„ì´ëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ì„¸ìš”</li>
                                        <li>â€¢ K-ESG ì¸ì¦ ì¤€ë¹„ ë°©ë²•ì„ ì„¤ëª…í•´ì£¼ì„¸ìš”</li>
                                    </ul>
                                </div>
                            </div>
                        </div>

                        <div class="p-4 border-t border-navy-100">
                            <div class="flex gap-3">
                                <input type="text" id="chatInput" placeholder="ESG ê´€ë ¨ ì§ˆë¬¸ì„ ì…ë ¥í•˜ì„¸ìš”..." class="flex-1 px-4 py-3 border border-navy-300 rounded-xl focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500" onkeypress="if(event.key==='Enter')sendChatMessage()">
                                <button onclick="sendChatMessage()" class="px-6 py-3 bg-gradient-to-r from-emerald-500 to-cyan-500 text-white rounded-xl font-medium hover:opacity-90 transition-opacity flex items-center gap-2">
                                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8"></path></svg>
                                    ì „ì†¡
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- ==================== ë°ì´í„° ì—°ë™ í˜ì´ì§€ ==================== -->
            <div id="page-data-integration" class="page">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4">
                        <h2 class="font-display text-2xl font-bold text-navy-900">ë°ì´í„° ì—°ë™</h2>
                        <p class="text-navy-500 text-sm mt-0.5">ì™¸ë¶€ APIë¥¼ í†µí•´ ESG ë°ì´í„°ë¥¼ ìë™ìœ¼ë¡œ ìˆ˜ì§‘í•˜ì„¸ìš”</p>
                    </div>
                </header>
                
                <div class="p-8">
                    <div class="max-w-5xl space-y-6">
                        
                        <!-- API ì—°ê²° ìƒíƒœ -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="font-semibold text-navy-900 text-lg">API ì—°ê²° ìƒíƒœ</h3>
                                    <p class="text-sm text-navy-500 mt-1">ì—°ë™ëœ ì™¸ë¶€ ë°ì´í„° ì†ŒìŠ¤</p>
                                </div>
                                <button onclick="checkApiStatus()" class="px-4 py-2 bg-navy-100 hover:bg-navy-200 rounded-xl text-sm font-medium transition-colors flex items-center gap-2">
                                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path></svg>
                                    ìƒíƒœ ìƒˆë¡œê³ ì¹¨
                                </button>
                            </div>
                            
                            <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-4" id="apiStatusGrid">
                                <!-- ê³µê³µë°ì´í„°í¬í„¸ -->
                                <div class="p-4 bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl border border-blue-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="w-10 h-10 rounded-lg bg-blue-500 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                                        </div>
                                        <span id="api-status-dataGoKr" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                    </div>
                                    <h4 class="font-semibold text-navy-900">ê³µê³µë°ì´í„°í¬í„¸</h4>
                                    <p class="text-xs text-navy-500 mt-1">ê¸°ìƒì²­, ê³ ìš©ë…¸ë™ë¶€</p>
                                </div>

                                <!-- DART -->
                                <div class="p-4 bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl border border-purple-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="w-10 h-10 rounded-lg bg-purple-500 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                        </div>
                                        <span id="api-status-dart" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                    </div>
                                    <h4 class="font-semibold text-navy-900">DART ì „ìê³µì‹œ</h4>
                                    <p class="text-xs text-navy-500 mt-1">ê¸°ì—…ì •ë³´, ì¬ë¬´ì œí‘œ, ì„ì›í˜„í™©</p>
                                </div>

                                <!-- KOSIS -->
                                <div class="p-4 bg-gradient-to-br from-cyan-50 to-cyan-100 rounded-xl border border-cyan-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="w-10 h-10 rounded-lg bg-cyan-500 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                                        </div>
                                        <span id="api-status-kosis" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                    </div>
                                    <h4 class="font-semibold text-navy-900">í†µê³„ì²­ KOSIS</h4>
                                    <p class="text-xs text-navy-500 mt-1">ì‚°ì—…ë³„ í†µê³„, ë²¤ì¹˜ë§ˆí‚¹</p>
                                </div>

                                <!-- Carbon Interface -->
                                <div class="p-4 bg-gradient-to-br from-emerald-50 to-emerald-100 rounded-xl border border-emerald-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="w-10 h-10 rounded-lg bg-emerald-500 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        </div>
                                        <span id="api-status-carbonInterface" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                    </div>
                                    <h4 class="font-semibold text-navy-900">Carbon Interface</h4>
                                    <p class="text-xs text-navy-500 mt-1">íƒ„ì†Œ ë°°ì¶œëŸ‰ ìë™ ê³„ì‚°</p>
                                </div>

                                <!-- Google Sheets -->
                                <div class="p-4 bg-gradient-to-br from-green-50 to-green-100 rounded-xl border border-green-200">
                                    <div class="flex items-center justify-between mb-3">
                                        <div class="w-10 h-10 rounded-lg bg-green-500 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                        </div>
                                        <span id="api-status-googleSheets" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                    </div>
                                    <h4 class="font-semibold text-navy-900">Google Sheets</h4>
                                    <p class="text-xs text-navy-500 mt-1">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„° ì—°ë™</p>
                                </div>
                            </div>
                        </div>

                        <!-- ë°ì´í„° ìˆ˜ì§‘ ì•¡ì…˜ -->
                        <div class="grid md:grid-cols-2 gap-6">
                            
                            <!-- í™˜ê²½(E) ë°ì´í„° -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-10 h-10 rounded-xl bg-emerald-100 flex items-center justify-center">
                                        <span class="text-lg">ğŸŒ±</span>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-navy-900">í™˜ê²½ (Environment)</h3>
                                        <p class="text-xs text-navy-500">ê¸°í›„, ì—ë„ˆì§€, íƒ„ì†Œë°°ì¶œ ë°ì´í„°</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <button onclick="fetchWeatherData()" class="w-full px-4 py-3 bg-emerald-50 hover:bg-emerald-100 border border-emerald-200 rounded-xl text-sm font-medium text-emerald-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸŒ¤ï¸</span>
                                        <div>
                                            <p class="font-medium">ê¸°ìƒ ë°ì´í„° ì¡°íšŒ</p>
                                            <p class="text-xs text-emerald-600">ê¸°ìƒì²­ API - ê¸°í›„ ë¦¬ìŠ¤í¬ ë¶„ì„</p>
                                        </div>
                                    </button>
                                    <button onclick="calculateCarbonEmissions()" class="w-full px-4 py-3 bg-emerald-50 hover:bg-emerald-100 border border-emerald-200 rounded-xl text-sm font-medium text-emerald-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸŒ</span>
                                        <div>
                                            <p class="font-medium">íƒ„ì†Œë°°ì¶œëŸ‰ ìë™ ê³„ì‚°</p>
                                            <p class="text-xs text-emerald-600">ì „ë ¥ ì‚¬ìš©ëŸ‰ â†’ Scope 2 ë°°ì¶œëŸ‰</p>
                                        </div>
                                    </button>
                                    <button onclick="calculateDetailedCarbonUI()" class="w-full px-4 py-3 bg-emerald-50 hover:bg-emerald-100 border border-emerald-200 rounded-xl text-sm font-medium text-emerald-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">â™»ï¸</span>
                                        <div>
                                            <p class="font-medium">ìƒì„¸ íƒ„ì†Œ ë°œìêµ­ ê³„ì‚°</p>
                                            <p class="text-xs text-emerald-600">Carbon Interface API (ì „ê¸°/ì—°ë£Œ/ìš´ì†¡)</p>
                                        </div>
                                    </button>
                                </div>
                            </div>

                            <!-- ì§€ë°°êµ¬ì¡°(G) ë°ì´í„° -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-10 h-10 rounded-xl bg-purple-100 flex items-center justify-center">
                                        <span class="text-lg">ğŸ›ï¸</span>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-navy-900">ì§€ë°°êµ¬ì¡° (Governance)</h3>
                                        <p class="text-xs text-navy-500">ê¸°ì—…ì •ë³´, ì¬ë¬´, ì´ì‚¬íšŒ ë°ì´í„°</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <button onclick="fetchDartCompanyInfo()" class="w-full px-4 py-3 bg-purple-50 hover:bg-purple-100 border border-purple-200 rounded-xl text-sm font-medium text-purple-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ¢</span>
                                        <div>
                                            <p class="font-medium">DART ê¸°ì—…ì •ë³´ ê°€ì ¸ì˜¤ê¸°</p>
                                            <p class="text-xs text-purple-600">ê¸°ì—…ì½”ë“œë¡œ ê¸°ë³¸ì •ë³´ ìë™ ìˆ˜ì§‘</p>
                                        </div>
                                    </button>
                                    <button onclick="fetchDartFinancial()" class="w-full px-4 py-3 bg-purple-50 hover:bg-purple-100 border border-purple-200 rounded-xl text-sm font-medium text-purple-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ“Š</span>
                                        <div>
                                            <p class="font-medium">ì¬ë¬´ì œí‘œ ì¡°íšŒ</p>
                                            <p class="text-xs text-purple-600">DART API - ë§¤ì¶œ, ì˜ì—…ì´ìµ ë“±</p>
                                        </div>
                                    </button>
                                    <button onclick="fetchDartExecutives()" class="w-full px-4 py-3 bg-purple-50 hover:bg-purple-100 border border-purple-200 rounded-xl text-sm font-medium text-purple-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ‘¥</span>
                                        <div>
                                            <p class="font-medium">ì„ì›í˜„í™© ì¡°íšŒ</p>
                                            <p class="text-xs text-purple-600">ì´ì‚¬íšŒ êµ¬ì„±, ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨</p>
                                        </div>
                                    </button>
                                </div>
                            </div>

                            <!-- ì‚¬íšŒ(S) ë°ì´í„° -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-10 h-10 rounded-xl bg-blue-100 flex items-center justify-center">
                                        <span class="text-lg">ğŸ‘¥</span>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-navy-900">ì‚¬íšŒ (Social)</h3>
                                        <p class="text-xs text-navy-500">ê³ ìš©, ì‚°ì¬, ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„°</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <button onclick="fetchBenchmarkData()" class="w-full px-4 py-3 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-xl text-sm font-medium text-blue-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ“ˆ</span>
                                        <div>
                                            <p class="font-medium">ì—…ì¢… ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„°</p>
                                            <p class="text-xs text-blue-600">KOSIS - ì‚°ì—…ë³„ ê³ ìš© í†µê³„</p>
                                        </div>
                                    </button>
                                    <button onclick="fetchAccidentStats()" class="w-full px-4 py-3 bg-blue-50 hover:bg-blue-100 border border-blue-200 rounded-xl text-sm font-medium text-blue-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ¦º</span>
                                        <div>
                                            <p class="font-medium">ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ</p>
                                            <p class="text-xs text-blue-600">ê³ ìš©ë…¸ë™ë¶€ API - ì‚°ì¬ìœ¨ ë¹„êµ</p>
                                        </div>
                                    </button>
                                </div>
                            </div>

                            <!-- ì™¸ë¶€ ì—°ë™ -->
                            <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                                <div class="flex items-center gap-3 mb-4">
                                    <div class="w-10 h-10 rounded-xl bg-green-100 flex items-center justify-center">
                                        <span class="text-lg">ğŸ”—</span>
                                    </div>
                                    <div>
                                        <h3 class="font-semibold text-navy-900">ì™¸ë¶€ ì—°ë™</h3>
                                        <p class="text-xs text-navy-500">ìŠ¤í”„ë ˆë“œì‹œíŠ¸, í†µí•© ìˆ˜ì§‘</p>
                                    </div>
                                </div>
                                <div class="space-y-3">
                                    <button onclick="fetchGoogleSheetsData()" class="w-full px-4 py-3 bg-green-50 hover:bg-green-100 border border-green-200 rounded-xl text-sm font-medium text-green-700 transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸ“‹</span>
                                        <div>
                                            <p class="font-medium">Google Sheets ì—°ë™</p>
                                            <p class="text-xs text-green-600">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°</p>
                                        </div>
                                    </button>
                                    <button onclick="collectAllEsgData()" class="w-full px-4 py-3 bg-gradient-to-r from-cyan-500 to-emerald-500 hover:from-cyan-600 hover:to-emerald-600 rounded-xl text-sm font-medium text-white transition-colors text-left flex items-center gap-3">
                                        <span class="text-lg">ğŸš€</span>
                                        <div>
                                            <p class="font-medium">ESG ë°ì´í„° í†µí•© ìˆ˜ì§‘</p>
                                            <p class="text-xs text-white/80">ëª¨ë“  APIì—ì„œ í•œë²ˆì— ìˆ˜ì§‘</p>
                                        </div>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- API í‚¤ ì„¤ì • ì•ˆë‚´ -->
                        <div class="bg-amber-50 rounded-2xl border border-amber-200 p-6">
                            <div class="flex items-start gap-4">
                                <div class="w-10 h-10 rounded-xl bg-amber-100 flex items-center justify-center flex-shrink-0">
                                    <span class="text-lg">ğŸ’¡</span>
                                </div>
                                <div>
                                    <h3 class="font-semibold text-amber-900 mb-2">API í‚¤ ì„¤ì • ë°©ë²•</h3>
                                    <p class="text-sm text-amber-800 mb-3">
                                        ì™¸ë¶€ APIë¥¼ ì‚¬ìš©í•˜ë ¤ë©´ ì„œë²„ì˜ <code class="bg-amber-100 px-1.5 py-0.5 rounded">.env</code> íŒŒì¼ì— API í‚¤ë¥¼ ì„¤ì •í•´ì•¼ í•©ë‹ˆë‹¤.
                                    </p>
                                    <div class="grid md:grid-cols-2 gap-3 text-xs">
                                        <div class="bg-white/50 rounded-lg p-3">
                                            <p class="font-medium text-amber-900">ê³µê³µë°ì´í„°í¬í„¸</p>
                                            <a href="https://www.data.go.kr" target="_blank" class="text-amber-700 hover:underline">data.go.kr â†’</a>
                                        </div>
                                        <div class="bg-white/50 rounded-lg p-3">
                                            <p class="font-medium text-amber-900">DART ì „ìê³µì‹œ</p>
                                            <a href="https://opendart.fss.or.kr" target="_blank" class="text-amber-700 hover:underline">opendart.fss.or.kr â†’</a>
                                        </div>
                                        <div class="bg-white/50 rounded-lg p-3">
                                            <p class="font-medium text-amber-900">í†µê³„ì²­ KOSIS</p>
                                            <a href="https://kosis.kr/openapi" target="_blank" class="text-amber-700 hover:underline">kosis.kr/openapi â†’</a>
                                        </div>
                                        <div class="bg-white/50 rounded-lg p-3">
                                            <p class="font-medium text-amber-900">Carbon Interface</p>
                                            <a href="https://www.carboninterface.com" target="_blank" class="text-amber-700 hover:underline">carboninterface.com â†’</a>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- ìµœê·¼ ìˆ˜ì§‘ ë¡œê·¸ -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                            <h3 class="font-semibold text-navy-900 mb-4">ğŸ“‹ ìµœê·¼ ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸</h3>
                            <div id="dataCollectionLog" class="space-y-2 max-h-48 overflow-y-auto">
                                <p class="text-sm text-navy-400 text-center py-4">ë°ì´í„° ìˆ˜ì§‘ ê¸°ë¡ì´ ì—†ìŠµë‹ˆë‹¤</p>
                            </div>
                        </div>

                    </div>
                </div>
            </div>

            <!-- ==================== ì„¤ì • í˜ì´ì§€ ==================== -->
            <div id="page-settings" class="page">
                <header class="bg-white/80 backdrop-blur-sm border-b border-navy-100 sticky top-0 z-10">
                    <div class="px-8 py-4">
                        <h2 class="font-display text-2xl font-bold text-navy-900">ì„¤ì •</h2>
                        <p class="text-navy-500 text-sm mt-0.5">ê³„ì • ë° ì„œë¹„ìŠ¤ ì„¤ì •ì„ ê´€ë¦¬í•˜ì„¸ìš”</p>
                    </div>
                </header>
                
                <div class="p-8">
                    <div class="max-w-2xl space-y-6">
                        <!-- Company Info -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                            <h3 class="font-semibold text-navy-900 mb-6">íšŒì‚¬ ì •ë³´</h3>
                            <div class="space-y-4">
                                <div>
                                    <label class="block text-sm font-medium text-navy-700 mb-2">íšŒì‚¬ëª…</label>
                                    <input type="text" id="companyName" value="ê·¸ë¦°í…Œí¬ ì£¼ì‹íšŒì‚¬" class="w-full px-4 py-3 border border-navy-300 rounded-xl focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500">
                                </div>
                                <div class="grid grid-cols-2 gap-4">
                                    <div>
                                        <label class="block text-sm font-medium text-navy-700 mb-2">ì—…ì¢…</label>
                                        <select id="industry" class="w-full px-4 py-3 border border-navy-300 rounded-xl focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500">
                                            <option>ì œì¡°ì—…</option>
                                            <option>IT/ì†Œí”„íŠ¸ì›¨ì–´</option>
                                            <option>ê¸ˆìœµ/ë³´í—˜</option>
                                            <option>ìœ í†µ/ë¬¼ë¥˜</option>
                                            <option>ê±´ì„¤/ë¶€ë™ì‚°</option>
                                            <option>ì„œë¹„ìŠ¤ì—…</option>
                                        </select>
                                    </div>
                                    <div>
                                        <label class="block text-sm font-medium text-navy-700 mb-2">ê¸°ì—… ê·œëª¨</label>
                                        <select id="companySize" class="w-full px-4 py-3 border border-navy-300 rounded-xl focus:ring-2 focus:ring-cyan-500/30 focus:border-cyan-500">
                                            <option>ì¤‘ì†Œê¸°ì—…</option>
                                            <option>ì¤‘ê²¬ê¸°ì—…</option>
                                            <option>ëŒ€ê¸°ì—…</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Notification Settings -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                            <h3 class="font-semibold text-navy-900 mb-6">ì•Œë¦¼ ì„¤ì •</h3>
                            <div class="space-y-4">
                                <label class="flex items-center justify-between cursor-pointer">
                                    <div>
                                        <p class="font-medium text-navy-900">ì´ë©”ì¼ ì•Œë¦¼</p>
                                        <p class="text-sm text-navy-500">ì¤‘ìš” ì—…ë°ì´íŠ¸ ë° ë¦¬í¬íŠ¸ ë§ˆê° ì•Œë¦¼</p>
                                    </div>
                                    <input type="checkbox" id="emailNotifications" checked class="w-5 h-5 rounded border-navy-300 text-cyan-600 focus:ring-cyan-500">
                                </label>
                                <label class="flex items-center justify-between cursor-pointer">
                                    <div>
                                        <p class="font-medium text-navy-900">ìë™ ì €ì¥</p>
                                        <p class="text-sm text-navy-500">ë°ì´í„° ì…ë ¥ ì‹œ ìë™ ì €ì¥</p>
                                    </div>
                                    <input type="checkbox" id="autoSave" checked class="w-5 h-5 rounded border-navy-300 text-cyan-600 focus:ring-cyan-500">
                                </label>
                            </div>
                        </div>

                        <!-- External API Integration -->
                        <div class="bg-white rounded-2xl shadow-sm border border-navy-100 p-6">
                            <div class="flex items-center justify-between mb-6">
                                <div>
                                    <h3 class="font-semibold text-navy-900">ì™¸ë¶€ ë°ì´í„° API ì—°ë™</h3>
                                    <p class="text-sm text-navy-500 mt-1">ESG ë°ì´í„° ìë™ ìˆ˜ì§‘ì„ ìœ„í•œ API ì—°ë™ ìƒíƒœ</p>
                                </div>
                                <button onclick="checkApiStatus()" class="px-3 py-1.5 text-sm bg-navy-100 hover:bg-navy-200 rounded-lg transition-colors">
                                    ìƒíƒœ í™•ì¸
                                </button>
                            </div>
                            
                            <div class="space-y-3" id="apiStatusList">
                                <!-- ê³µê³µë°ì´í„°í¬í„¸ -->
                                <div class="flex items-center justify-between p-4 bg-navy-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-blue-100 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"></path></svg>
                                        </div>
                                        <div>
                                            <p class="font-medium text-navy-900">ê³µê³µë°ì´í„°í¬í„¸</p>
                                            <p class="text-xs text-navy-500">ê¸°ìƒì²­, í•œêµ­ì „ë ¥, ê³ ìš©ë…¸ë™ë¶€</p>
                                        </div>
                                    </div>
                                    <span id="api-dataGoKr" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                </div>

                                <!-- DART -->
                                <div class="flex items-center justify-between p-4 bg-navy-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-purple-100 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-purple-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                                        </div>
                                        <div>
                                            <p class="font-medium text-navy-900">DART (ì „ìê³µì‹œ)</p>
                                            <p class="text-xs text-navy-500">ê¸°ì—… ê³µì‹œ, ì¬ë¬´ì œí‘œ, ì„ì›í˜„í™©</p>
                                        </div>
                                    </div>
                                    <span id="api-dart" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                </div>

                                <!-- KOSIS -->
                                <div class="flex items-center justify-between p-4 bg-navy-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-cyan-100 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-cyan-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"></path></svg>
                                        </div>
                                        <div>
                                            <p class="font-medium text-navy-900">í†µê³„ì²­ KOSIS</p>
                                            <p class="text-xs text-navy-500">ì‚°ì—…ë³„ í†µê³„, ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„°</p>
                                        </div>
                                    </div>
                                    <span id="api-kosis" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                </div>

                                <!-- Carbon Interface -->
                                <div class="flex items-center justify-between p-4 bg-navy-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-emerald-100 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3.055 11H5a2 2 0 012 2v1a2 2 0 002 2 2 2 0 012 2v2.945M8 3.935V5.5A2.5 2.5 0 0010.5 8h.5a2 2 0 012 2 2 2 0 104 0 2 2 0 012-2h1.064M15 20.488V18a2 2 0 012-2h3.064M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                                        </div>
                                        <div>
                                            <p class="font-medium text-navy-900">Carbon Interface</p>
                                            <p class="text-xs text-navy-500">íƒ„ì†Œ ë°°ì¶œëŸ‰ ìë™ ê³„ì‚°</p>
                                        </div>
                                    </div>
                                    <span id="api-carbonInterface" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                </div>

                                <!-- Google Sheets -->
                                <div class="flex items-center justify-between p-4 bg-navy-50 rounded-xl">
                                    <div class="flex items-center gap-3">
                                        <div class="w-10 h-10 rounded-lg bg-green-100 flex items-center justify-center">
                                            <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 10h18M3 14h18m-9-4v8m-7 0h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v8a2 2 0 002 2z"></path></svg>
                                        </div>
                                        <div>
                                            <p class="font-medium text-navy-900">Google Sheets</p>
                                            <p class="text-xs text-navy-500">ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„° ì—°ë™</p>
                                        </div>
                                    </div>
                                    <span id="api-googleSheets" class="px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600">í™•ì¸ ì¤‘...</span>
                                </div>
                            </div>

                            <div class="mt-4 p-4 bg-amber-50 rounded-xl border border-amber-200">
                                <p class="text-sm text-amber-800">
                                    ğŸ’¡ API í‚¤ëŠ” ì„œë²„ì˜ <code class="bg-amber-100 px-1 rounded">.env</code> íŒŒì¼ì—ì„œ ì„¤ì •í•©ë‹ˆë‹¤.
                                    <a href="/api-docs" class="underline hover:text-amber-900">API ë¬¸ì„œ ë³´ê¸°</a>
                                </p>
                            </div>
                        </div>

                        <!-- Quick Actions for External Data -->
                        <div class="bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-2xl p-6 text-white">
                            <h3 class="font-semibold mb-4">ğŸš€ ì™¸ë¶€ ë°ì´í„° ë¹ ë¥¸ ìˆ˜ì§‘</h3>
                            <div class="grid grid-cols-2 gap-3">
                                <button onclick="fetchDartCompanyInfo()" class="px-4 py-3 bg-white/20 hover:bg-white/30 rounded-xl text-sm font-medium transition-colors text-left">
                                    ğŸ“Š DART ê¸°ì—…ì •ë³´ ê°€ì ¸ì˜¤ê¸°
                                </button>
                                <button onclick="calculateCarbonEmissions()" class="px-4 py-3 bg-white/20 hover:bg-white/30 rounded-xl text-sm font-medium transition-colors text-left">
                                    ğŸŒ íƒ„ì†Œë°°ì¶œëŸ‰ ìë™ê³„ì‚°
                                </button>
                                <button onclick="fetchWeatherData()" class="px-4 py-3 bg-white/20 hover:bg-white/30 rounded-xl text-sm font-medium transition-colors text-left">
                                    ğŸŒ¤ï¸ ê¸°ìƒ ë°ì´í„° ì¡°íšŒ
                                </button>
                                <button onclick="fetchBenchmarkData()" class="px-4 py-3 bg-white/20 hover:bg-white/30 rounded-xl text-sm font-medium transition-colors text-left">
                                    ğŸ“ˆ ì—…ì¢… ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„°
                                </button>
                            </div>
                        </div>

                        <div class="flex items-center justify-end gap-4">
                            <span id="settingsSaveMessage" class="text-emerald-600 text-sm font-medium hidden">âœ“ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</span>
                            <button onclick="saveSettings()" class="px-6 py-3 bg-navy-900 text-white rounded-xl font-medium hover:bg-navy-800 transition-colors flex items-center gap-2">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 7H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-3m-1 4l-3 3m0 0l-3-3m3 3V4"></path></svg>
                                ì„¤ì • ì €ì¥
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // ==================== ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ====================
        let monthlyBillData = {
            2024: {
                electricity: Array(12).fill(null),
                water: Array(12).fill(null),
                gas: Array(12).fill(null),
                waste: Array(12).fill(null),
                employees: Array(12).fill(null)
            },
            2025: {
                electricity: Array(12).fill(null),
                water: Array(12).fill(null),
                gas: Array(12).fill(null),
                waste: Array(12).fill(null),
                employees: Array(12).fill(null)
            }
        };
        
        let currentOcrData = null; // í˜„ì¬ OCR ì¶”ì¶œ ê²°ê³¼ ì„ì‹œ ì €ì¥
        
        // ==================== ì…ë ¥ ëª¨ë“œ ì „í™˜ ====================
        function switchInputMode(mode) {
            const simpleMode = document.getElementById('simpleInputMode');
            const detailMode = document.getElementById('detailInputMode');
            const simpleBtnTab = document.getElementById('simpleModeBtnTab');
            const detailBtnTab = document.getElementById('detailModeBtnTab');
            
            if (mode === 'simple') {
                simpleMode.classList.remove('hidden');
                detailMode.classList.add('hidden');
                simpleBtnTab.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-cyan-500 to-emerald-500 text-white rounded-xl font-semibold shadow-lg transition-all';
                detailBtnTab.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-white text-navy-600 rounded-xl font-semibold border-2 border-navy-200 hover:border-navy-400 transition-all';
            } else {
                simpleMode.classList.add('hidden');
                detailMode.classList.remove('hidden');
                detailBtnTab.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-gradient-to-r from-cyan-500 to-emerald-500 text-white rounded-xl font-semibold shadow-lg transition-all';
                simpleBtnTab.className = 'flex-1 flex items-center justify-center gap-2 px-6 py-4 bg-white text-navy-600 rounded-xl font-semibold border-2 border-navy-200 hover:border-navy-400 transition-all';
            }
        }
        
        // ==================== ê³ ì§€ì„œ OCR ì—…ë¡œë“œ ====================
        async function handleBillUpload(event, billType) {
            const file = event.target.files[0];
            if (!file) return;
            
            const statusDiv = document.getElementById('ocrProcessingStatus');
            const statusText = document.getElementById('ocrStatusText');
            const previewDiv = document.getElementById('ocrExtractedPreview');
            
            // ê³ ì§€ì„œ íƒ€ì…ë³„ ì´ë¦„
            const billTypeNames = {
                electricity: 'ì „ê¸°ìš”ê¸ˆ ê³ ì§€ì„œ',
                water: 'ìˆ˜ë„ìš”ê¸ˆ ê³ ì§€ì„œ',
                gas: 'ê°€ìŠ¤ìš”ê¸ˆ ê³ ì§€ì„œ',
                maintenance: 'ê´€ë¦¬ë¹„ ê³ ì§€ì„œ',
                insurance: '4ëŒ€ë³´í—˜ ê³ ì§€ì„œ',
                waste: 'íê¸°ë¬¼ ì²˜ë¦¬ ì˜ìˆ˜ì¦'
            };
            
            // ë¡œë”© í‘œì‹œ
            statusDiv.classList.remove('hidden');
            statusText.textContent = `${billTypeNames[billType]} ë¶„ì„ ì¤‘...`;
            previewDiv.classList.add('hidden');
            
            try {
                const formData = new FormData();
                formData.append('bill', file);
                formData.append('billType', billType);
                
                const response = await fetch('/api/ocr/bill', {
                    method: 'POST',
                    body: formData
                });
                
                const result = await response.json();
                
                if (result.success) {
                    currentOcrData = result.data;
                    currentOcrData.billType = billType;
                    
                    // ê²°ê³¼ í‘œì‹œ
                    displayOcrResult(result.data, billType, billTypeNames[billType]);
                    
                    statusDiv.classList.add('hidden');
                    previewDiv.classList.remove('hidden');
                } else {
                    throw new Error(result.error || 'OCR ì²˜ë¦¬ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('OCR ì—ëŸ¬:', error);
                statusText.textContent = `âŒ ë¶„ì„ ì‹¤íŒ¨: ${error.message}`;
                setTimeout(() => statusDiv.classList.add('hidden'), 3000);
            }
            
            // input ì´ˆê¸°í™”
            event.target.value = '';
        }
        
        // ==================== OCR ê²°ê³¼ í‘œì‹œ ====================
        function displayOcrResult(data, billType, billTypeName) {
            const contentDiv = document.getElementById('ocrExtractedContent');
            const typeSpan = document.getElementById('ocrBillType');
            
            typeSpan.textContent = billTypeName;
            
            let html = '';
            
            if (billType === 'electricity') {
                html = `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-yellow-50 rounded-lg">
                            <div class="text-xs text-yellow-600 mb-1">ì‚¬ìš© ê¸°ê°„</div>
                            <div class="font-semibold text-yellow-800">${data.period || '-'}</div>
                        </div>
                        <div class="p-3 bg-yellow-50 rounded-lg">
                            <div class="text-xs text-yellow-600 mb-1">ì „ê¸° ì‚¬ìš©ëŸ‰</div>
                            <div class="font-semibold text-yellow-800">${data.usage?.toLocaleString() || '-'} kWh</div>
                        </div>
                        <div class="p-3 bg-yellow-50 rounded-lg">
                            <div class="text-xs text-yellow-600 mb-1">ì²­êµ¬ ê¸ˆì•¡</div>
                            <div class="font-semibold text-yellow-800">${data.amount?.toLocaleString() || '-'}ì›</div>
                        </div>
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">ê³ ê°ë²ˆí˜¸</div>
                            <div class="font-semibold text-gray-800">${data.customerNo || '-'}</div>
                        </div>
                    </div>
                `;
            } else if (billType === 'water') {
                html = `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <div class="text-xs text-blue-600 mb-1">ì‚¬ìš© ê¸°ê°„</div>
                            <div class="font-semibold text-blue-800">${data.period || '-'}</div>
                        </div>
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <div class="text-xs text-blue-600 mb-1">ìˆ˜ë„ ì‚¬ìš©ëŸ‰</div>
                            <div class="font-semibold text-blue-800">${data.usage?.toLocaleString() || '-'} í†¤</div>
                        </div>
                        <div class="p-3 bg-blue-50 rounded-lg">
                            <div class="text-xs text-blue-600 mb-1">ì²­êµ¬ ê¸ˆì•¡</div>
                            <div class="font-semibold text-blue-800">${data.amount?.toLocaleString() || '-'}ì›</div>
                        </div>
                    </div>
                `;
            } else if (billType === 'gas') {
                html = `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-orange-50 rounded-lg">
                            <div class="text-xs text-orange-600 mb-1">ì‚¬ìš© ê¸°ê°„</div>
                            <div class="font-semibold text-orange-800">${data.period || '-'}</div>
                        </div>
                        <div class="p-3 bg-orange-50 rounded-lg">
                            <div class="text-xs text-orange-600 mb-1">ê°€ìŠ¤ ì‚¬ìš©ëŸ‰</div>
                            <div class="font-semibold text-orange-800">${data.usage?.toLocaleString() || '-'} ã¥</div>
                        </div>
                        <div class="p-3 bg-orange-50 rounded-lg">
                            <div class="text-xs text-orange-600 mb-1">ì²­êµ¬ ê¸ˆì•¡</div>
                            <div class="font-semibold text-orange-800">${data.amount?.toLocaleString() || '-'}ì›</div>
                        </div>
                    </div>
                `;
            } else if (billType === 'maintenance') {
                html = `
                    <div class="space-y-3">
                        <div class="p-3 bg-green-50 rounded-lg">
                            <div class="text-xs text-green-600 mb-1">ì‚¬ìš© ê¸°ê°„</div>
                            <div class="font-semibold text-green-800">${data.period || '-'}</div>
                        </div>
                        <div class="grid grid-cols-3 gap-3">
                            <div class="p-3 bg-yellow-50 rounded-lg">
                                <div class="text-xs text-yellow-600 mb-1">âš¡ ì „ê¸°</div>
                                <div class="font-semibold text-yellow-800">${data.electricity?.usage?.toLocaleString() || '-'} kWh</div>
                            </div>
                            <div class="p-3 bg-blue-50 rounded-lg">
                                <div class="text-xs text-blue-600 mb-1">ğŸ’§ ìˆ˜ë„</div>
                                <div class="font-semibold text-blue-800">${data.water?.usage?.toLocaleString() || '-'} í†¤</div>
                            </div>
                            <div class="p-3 bg-orange-50 rounded-lg">
                                <div class="text-xs text-orange-600 mb-1">ğŸ”¥ ê°€ìŠ¤/ë‚œë°©</div>
                                <div class="font-semibold text-orange-800">${data.gas?.usage?.toLocaleString() || '-'} ã¥</div>
                            </div>
                        </div>
                        <div class="p-3 bg-green-100 rounded-lg">
                            <div class="text-xs text-green-600 mb-1">ì´ ê´€ë¦¬ë¹„</div>
                            <div class="font-semibold text-green-800">${data.totalAmount?.toLocaleString() || '-'}ì›</div>
                        </div>
                    </div>
                `;
            } else if (billType === 'insurance') {
                html = `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-purple-50 rounded-lg">
                            <div class="text-xs text-purple-600 mb-1">ê·€ì† ê¸°ê°„</div>
                            <div class="font-semibold text-purple-800">${data.period || '-'}</div>
                        </div>
                        <div class="p-3 bg-purple-50 rounded-lg">
                            <div class="text-xs text-purple-600 mb-1">ê°€ì…ì ìˆ˜</div>
                            <div class="font-semibold text-purple-800">${data.employeeCount?.toLocaleString() || '-'}ëª…</div>
                        </div>
                        <div class="p-3 bg-purple-50 rounded-lg">
                            <div class="text-xs text-purple-600 mb-1">ì´ ë³´í—˜ë£Œ</div>
                            <div class="font-semibold text-purple-800">${data.totalAmount?.toLocaleString() || '-'}ì›</div>
                        </div>
                    </div>
                `;
            } else if (billType === 'waste') {
                html = `
                    <div class="grid grid-cols-2 gap-4">
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">ì²˜ë¦¬ ì¼ì</div>
                            <div class="font-semibold text-gray-800">${data.date || '-'}</div>
                        </div>
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">íê¸°ë¬¼ëŸ‰</div>
                            <div class="font-semibold text-gray-800">${data.usage?.toLocaleString() || '-'} kg</div>
                        </div>
                        <div class="p-3 bg-gray-50 rounded-lg">
                            <div class="text-xs text-gray-600 mb-1">ì²˜ë¦¬ ë¹„ìš©</div>
                            <div class="font-semibold text-gray-800">${data.amount?.toLocaleString() || '-'}ì›</div>
                        </div>
                    </div>
                `;
            }
            
            contentDiv.innerHTML = html;
        }
        
        // ==================== OCR ê²°ê³¼ ì·¨ì†Œ ====================
        function cancelOcrData() {
            currentOcrData = null;
            document.getElementById('ocrExtractedPreview').classList.add('hidden');
        }
        
        // ==================== OCR ê²°ê³¼ ì ìš© ====================
        async function applyOcrData() {
            if (!currentOcrData) return;
            
            const year = document.getElementById('billDataYear').value;
            const month = currentOcrData.month || new Date().getMonth() + 1;
            const monthIndex = month - 1;
            const billType = currentOcrData.billType;
            
            // ì—°ë„ ë°ì´í„° ì´ˆê¸°í™”
            if (!monthlyBillData[year]) {
                monthlyBillData[year] = {
                    electricity: Array(12).fill(null),
                    water: Array(12).fill(null),
                    gas: Array(12).fill(null),
                    waste: Array(12).fill(null),
                    employees: Array(12).fill(null)
                };
            }
            
            // ê³ ì§€ì„œ íƒ€ì…ë³„ ë°ì´í„° ì €ì¥
            if (billType === 'electricity') {
                monthlyBillData[year].electricity[monthIndex] = currentOcrData.usage;
            } else if (billType === 'water') {
                monthlyBillData[year].water[monthIndex] = currentOcrData.usage;
            } else if (billType === 'gas') {
                monthlyBillData[year].gas[monthIndex] = currentOcrData.usage;
            } else if (billType === 'maintenance') {
                // ê´€ë¦¬ë¹„ëŠ” ì „ê¸°/ìˆ˜ë„/ê°€ìŠ¤ í•œë²ˆì— ì €ì¥
                if (currentOcrData.electricity?.usage) {
                    monthlyBillData[year].electricity[monthIndex] = currentOcrData.electricity.usage;
                }
                if (currentOcrData.water?.usage) {
                    monthlyBillData[year].water[monthIndex] = currentOcrData.water.usage;
                }
                if (currentOcrData.gas?.usage) {
                    monthlyBillData[year].gas[monthIndex] = currentOcrData.gas.usage;
                }
            } else if (billType === 'insurance') {
                monthlyBillData[year].employees[monthIndex] = currentOcrData.employeeCount;
            } else if (billType === 'waste') {
                monthlyBillData[year].waste[monthIndex] = currentOcrData.usage;
            }
            
            // ê°œë³„ ì¹´ë“œì— ê²°ê³¼ í‘œì‹œ
            updateBillCard(billType, currentOcrData);
            
            // í…Œì´ë¸” ì—…ë°ì´íŠ¸
            updateBillDataTable();
            
            // ì„œë²„ì— ì˜êµ¬ ì €ì¥
            try {
                await fetch('/api/bill/data/bulk-save', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ year, data: monthlyBillData[year] })
                });
            } catch (e) {
                console.error('ì„œë²„ ì €ì¥ ì‹¤íŒ¨:', e);
            }
            
            // ë¯¸ë¦¬ë³´ê¸° ìˆ¨ê¸°ê¸°
            cancelOcrData();
            
            // ì„±ê³µ ì•Œë¦¼
            showToast('âœ“ ë°ì´í„°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
        }
        
        // ==================== ê°œë³„ ì¹´ë“œ ì—…ë°ì´íŠ¸ ====================
        function updateBillCard(billType, data) {
            const resultDiv = document.getElementById(`${billType}-result`);
            const valueDiv = document.getElementById(`${billType}-value`);
            
            if (resultDiv && valueDiv) {
                resultDiv.classList.remove('hidden');
                
                if (billType === 'electricity') {
                    valueDiv.textContent = `${data.usage?.toLocaleString()} kWh`;
                } else if (billType === 'water') {
                    valueDiv.textContent = `${data.usage?.toLocaleString()} í†¤`;
                } else if (billType === 'gas') {
                    valueDiv.textContent = `${data.usage?.toLocaleString()} ã¥`;
                } else if (billType === 'maintenance') {
                    valueDiv.innerHTML = `ì „ê¸°: ${data.electricity?.usage || 0}kWh<br>ìˆ˜ë„: ${data.water?.usage || 0}í†¤<br>ê°€ìŠ¤: ${data.gas?.usage || 0}ã¥`;
                } else if (billType === 'insurance') {
                    valueDiv.textContent = `${data.employeeCount?.toLocaleString()}ëª…`;
                } else if (billType === 'waste') {
                    valueDiv.textContent = `${data.usage?.toLocaleString()} kg`;
                }
            }
        }
        
        // ==================== ì›”ë³„ í…Œì´ë¸” ì—…ë°ì´íŠ¸ ====================
        function updateBillDataTable() {
            const year = document.getElementById('billDataYear').value;
            const data = monthlyBillData[year] || {
                electricity: Array(12).fill(null),
                water: Array(12).fill(null),
                gas: Array(12).fill(null),
                waste: Array(12).fill(null),
                employees: Array(12).fill(null)
            };
            
            // ì „ê¸°
            let elecTotal = 0;
            for (let i = 1; i <= 12; i++) {
                const cell = document.getElementById(`elec-${i}`);
                const val = data.electricity[i-1];
                if (cell) {
                    cell.textContent = val !== null ? val.toLocaleString() : '-';
                    if (val !== null) elecTotal += val;
                }
            }
            document.getElementById('elec-total').textContent = elecTotal.toLocaleString();
            
            // ìˆ˜ë„
            let waterTotal = 0;
            for (let i = 1; i <= 12; i++) {
                const cell = document.getElementById(`water-${i}`);
                const val = data.water[i-1];
                if (cell) {
                    cell.textContent = val !== null ? val.toLocaleString() : '-';
                    if (val !== null) waterTotal += val;
                }
            }
            document.getElementById('water-total').textContent = waterTotal.toLocaleString();
            
            // ê°€ìŠ¤
            let gasTotal = 0;
            for (let i = 1; i <= 12; i++) {
                const cell = document.getElementById(`gas-${i}`);
                const val = data.gas[i-1];
                if (cell) {
                    cell.textContent = val !== null ? val.toLocaleString() : '-';
                    if (val !== null) gasTotal += val;
                }
            }
            document.getElementById('gas-total').textContent = gasTotal.toLocaleString();
            
            // íê¸°ë¬¼
            let wasteTotal = 0;
            for (let i = 1; i <= 12; i++) {
                const cell = document.getElementById(`waste-${i}`);
                const val = data.waste[i-1];
                if (cell) {
                    cell.textContent = val !== null ? val.toLocaleString() : '-';
                    if (val !== null) wasteTotal += val;
                }
            }
            document.getElementById('waste-total').textContent = wasteTotal.toLocaleString();
            
            // ì§ì› ìˆ˜ (í‰ê· )
            let empSum = 0, empCount = 0;
            for (let i = 1; i <= 12; i++) {
                const cell = document.getElementById(`emp-${i}`);
                const val = data.employees[i-1];
                if (cell) {
                    cell.textContent = val !== null ? val.toLocaleString() : '-';
                    if (val !== null) { empSum += val; empCount++; }
                }
            }
            document.getElementById('emp-avg').textContent = empCount > 0 ? `í‰ê· : ${Math.round(empSum/empCount)}` : 'í‰ê· : -';
        }
        
        // ==================== ì›”ë³„ ë°ì´í„°ë¥¼ ESGì— ë°˜ì˜ ====================
        function applyMonthlyToESG() {
            const year = document.getElementById('billDataYear').value;
            const data = monthlyBillData[year];
            
            if (!data) {
                alert('ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.');
                return;
            }
            
            // ì—°ê°„ í•©ê³„ ê³„ì‚°
            const elecTotal = data.electricity.reduce((sum, v) => sum + (v || 0), 0);
            const waterTotal = data.water.reduce((sum, v) => sum + (v || 0), 0);
            const gasTotal = data.gas.reduce((sum, v) => sum + (v || 0), 0);
            const wasteTotal = data.waste.reduce((sum, v) => sum + (v || 0), 0);
            
            // ì§ì› ìˆ˜ í‰ê· 
            const empVals = data.employees.filter(v => v !== null);
            const empAvg = empVals.length > 0 ? Math.round(empVals.reduce((a,b) => a+b, 0) / empVals.length) : 0;
            
            // ESG ë°ì´í„°ì— ë°˜ì˜
            esgData.environment.energyUsage = elecTotal;
            esgData.environment.waterUsage = waterTotal;
            esgData.environment.wasteGeneration = wasteTotal / 1000; // kg â†’ í†¤
            
            // Scope 1 ê³„ì‚° (ê°€ìŠ¤ ì‚¬ìš©ëŸ‰ ê¸°ë°˜, ëŒ€ëµì  ê³„ì‚°)
            // ë„ì‹œê°€ìŠ¤ 1ã¥ â‰’ 2.23 kgCO2e
            esgData.environment.scope1Emission = Math.round(gasTotal * 2.23 / 1000); // tCO2e
            
            // Scope 2 ê³„ì‚° (ì „ê¸° ì‚¬ìš©ëŸ‰ ê¸°ë°˜)
            // ì „ê¸° 1kWh â‰’ 0.4594 kgCO2e (í•œêµ­ ì „ë ¥ ë°°ì¶œê³„ìˆ˜)
            esgData.environment.scope2Emission = Math.round(elecTotal * 0.4594 / 1000); // tCO2e
            
            // ì§ì› ìˆ˜
            if (empAvg > 0) {
                esgData.social.employeeCount = empAvg;
            }
            
            // ìƒì„¸ ì…ë ¥ ëª¨ë“œ í¼ì— ê°’ ë°˜ì˜
            document.getElementById('energyUsage').value = elecTotal;
            document.getElementById('waterUsage').value = waterTotal;
            document.getElementById('wasteGeneration').value = (wasteTotal / 1000).toFixed(1);
            document.getElementById('scope1Emission').value = esgData.environment.scope1Emission;
            document.getElementById('scope2Emission').value = esgData.environment.scope2Emission;
            if (empAvg > 0) {
                document.getElementById('employeeCount').value = empAvg;
            }
            
            // ëŒ€ì‹œë³´ë“œ ì—…ë°ì´íŠ¸
            updateDashboard();
            
            showToast('âœ“ ESG ë°ì´í„°ì— ë°˜ì˜ë˜ì—ˆìŠµë‹ˆë‹¤');
        }
        
        // ==================== í† ìŠ¤íŠ¸ ë©”ì‹œì§€ ====================
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed bottom-4 right-4 bg-emerald-600 text-white px-6 py-3 rounded-xl shadow-lg z-50 animate-fade-in';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 2000);
        }
        
        // ==================== K-ESG ê°€ì´ë“œë¼ì¸ ê¸°ë°˜ ë°ì´í„° ====================
        let esgData = {
            environment: {
                // í™˜ê²½ê²½ì˜ ì²´ê³„
                envPolicy: false, envOrganization: false, envCertification: false, envTarget: false,
                // ì˜¨ì‹¤ê°€ìŠ¤/ì—ë„ˆì§€
                scope1Emission: 450, scope2Emission: 795, scope3Emission: 2100,
                energyUsage: 1200000, energyIntensity: 0.85, renewableEnergy: 15,
                // ìš©ìˆ˜/íê¸°ë¬¼
                waterUsage: 50000, waterRecycling: 25, wasteGeneration: 850, wasteRecycling: 60,
                airPollution: 12.5, waterPollution: 8.3,
                // í™˜ê²½ ë¦¬ìŠ¤í¬
                envViolations: 0, envFines: 0, greenProduct: 35
            },
            social: {
                // ê³ ìš© í˜„í™©
                employeeCount: 150, permanentRatio: 85, newHires: 25,
                turnoverRate: 8.5, avgTenure: 5.2, avgSalary: 5200,
                // ë‹¤ì–‘ì„±/í¬ìš©ì„±
                femaleRatio: 35, femaleManagerRatio: 20, disabledRatio: 3.2,
                parentalLeaveRate: 75, parentalReturnRate: 92, foreignRatio: 5,
                // êµìœ¡/ì•ˆì „
                trainingHours: 40, trainingCost: 120, safetyTrainingRate: 100,
                industrialAccidents: 2, ltir: 0.52, fatalAccidents: 0,
                // ê³µê¸‰ë§/ê³ ê°
                supplierEsgRate: 45, customerSatisfaction: 85, privacyBreaches: 0,
                securityIncidents: 0, socialInvestment: 5000, volunteerRate: 25
            },
            governance: {
                // ì´ì‚¬íšŒ
                boardSize: 7, boardIndependence: 40, femaleBoardRatio: 14,
                boardMeetings: 12, boardAttendance: 95, boardExpertise: 3,
                // ìœ„ì›íšŒ
                auditCommittee: true, esgCommittee: false, nominationCommittee: false,
                compensationCommittee: false, riskCommittee: false, internalAudit: true,
                // ìœ¤ë¦¬ê²½ì˜
                ethicsViolations: 0, antiCorruptionTraining: 80, whistleblowing: 3,
                fairTradeViolations: 0, corruptionFines: 0, legalViolations: 0,
                // ì£¼ì£¼ê¶Œë¦¬/ë³´ìˆ˜
                dividendPayout: 30, ceoPayRatio: 15, esgDisclosure: 75
            }
        };

        // K-ESG ì—°ë™ ë°ì´í„°
        let kesgCriteria = null;  // Adminì—ì„œ ì¶”ì¶œí•œ K-ESG ê¸°ì¤€
        let assessmentResults = null;  // Assessment í‰ê°€ ê²°ê³¼

        let reports = [
            { id: 1, title: '2024ë…„ ìƒë°˜ê¸° ESG ë³´ê³ ì„œ', progress: 75, status: 'ì‘ì„± ì¤‘', lastModified: '2ì‹œê°„ ì „', color: 'cyan', content: '' },
            { id: 2, title: 'íƒ„ì†Œì¤‘ë¦½ ì‹¤í–‰ê³„íšì„œ', progress: 100, status: 'ê²€í†  ì¤‘', lastModified: '1ì¼ ì „', color: 'emerald', content: '' },
        ];

        let tasks = [
            { id: 1, title: 'ì¬ìƒì—ë„ˆì§€ ì „í™˜ìœ¨ í™•ëŒ€', description: 'í˜„ì¬ 15% â†’ ëª©í‘œ 30% ë‹¬ì„± ì‹œ í™˜ê²½(E) ì ìˆ˜ +8ì  ì˜ˆìƒ', impact: 'ë†’ì€ ì˜í–¥', score: 8, color: 'rose' },
            { id: 2, title: 'ì„ì§ì› ë‹¤ì–‘ì„± ì§€í‘œ ê°œì„ ', description: 'ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨ 20% â†’ 30% í™•ëŒ€ë¡œ ì‚¬íšŒ(S) ì ìˆ˜ ê°œì„ ', impact: 'ì¤‘ê°„ ì˜í–¥', score: 5, color: 'amber' },
            { id: 3, title: 'ì´ì‚¬íšŒ ë…ë¦½ì„± ê°•í™”', description: 'ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨ í™•ëŒ€ ë° ESG ìœ„ì›íšŒ ì‹ ì„¤ ê¶Œê³ ', impact: 'ê¶Œì¥ ì‚¬í•­', score: 4, color: 'sky' },
            { id: 4, title: 'íê¸°ë¬¼ ì¬í™œìš©ë¥  í–¥ìƒ', description: 'í˜„ì¬ 60% â†’ ëª©í‘œ 80% ë‹¬ì„±ìœ¼ë¡œ ìˆœí™˜ê²½ì œ ê¸°ì—¬', impact: 'ì§„í–‰ ê°€ëŠ¥', score: 3, color: 'emerald' },
        ];

        let selectedReport = null;
        let selectedTemplate = 'k-esg';
        let carbonChart = null;
        let chatHistory = [];

        // ==================== Claude API í˜¸ì¶œ (ì„œë²„ í”„ë¡ì‹œ ì‚¬ìš©) ====================
        async function callClaude(prompt) {
            updateAPIStatus('loading');

            try {
                const response = await fetch('/api/ai/generate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: prompt,
                        model: AI_MODEL
                    })
                });

                const data = await response.json();
                
                if (!data.success) {
                    throw new Error(data.error || 'API í˜¸ì¶œ ì‹¤íŒ¨');
                }

                updateAPIStatus('connected');
                return data.text;
            } catch (error) {
                console.error('AI API Error:', error);
                updateAPIStatus('error');
                alert('API í˜¸ì¶œ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
                return null;
            }
        }

        // ìŠ¤íŠ¸ë¦¬ë° ì‘ë‹µ (ì„œë²„ í”„ë¡ì‹œ ì‚¬ìš©)
        async function streamClaude(prompt, targetElement) {
            targetElement.innerHTML = '<span class="typing-animation">ìƒì„± ì¤‘</span>';
            updateAPIStatus('loading');

            try {
                const response = await fetch('/api/ai/stream', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        prompt: prompt,
                        model: AI_MODEL
                    })
                });

                if (!response.ok) {
                    const error = await response.json();
                    throw new Error(error.error || 'API í˜¸ì¶œ ì‹¤íŒ¨');
                }

                const reader = response.body.getReader();
                const decoder = new TextDecoder();
                let fullContent = '';

                while (true) {
                    const { done, value } = await reader.read();
                    if (done) break;

                    const chunk = decoder.decode(value);
                    const lines = chunk.split('\n').filter(line => line.startsWith('data: '));

                    for (const line of lines) {
                        const dataStr = line.replace('data: ', '');
                        if (dataStr === '[DONE]') continue;
                        
                        try {
                            const data = JSON.parse(dataStr);
                            if (data.text) {
                                fullContent += data.text;
                                targetElement.innerHTML = formatMarkdown(fullContent);
                            }
                        } catch (e) {}
                    }
                }

                updateAPIStatus('connected');
                return fullContent;
            } catch (error) {
                console.error('Claude Streaming Error:', error);
                targetElement.innerHTML = '<p class="text-red-500">ì˜¤ë¥˜ ë°œìƒ: ' + error.message + '</p>';
                updateAPIStatus('error');
            }
        }

        function formatMarkdown(text) {
            return text
                .replace(/### (.*?)(\n|$)/g, '<h3>$1</h3>')
                .replace(/## (.*?)(\n|$)/g, '<h2>$1</h2>')
                .replace(/# (.*?)(\n|$)/g, '<h1>$1</h1>')
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/- (.*?)(\n|$)/g, '<li>$1</li>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
        }

        function updateAPIStatus(status) {
            const indicator = document.getElementById('apiStatusIndicator');
            const text = document.getElementById('apiStatusText');
            
            if (status === 'connected') {
                indicator.className = 'w-2 h-2 rounded-full bg-emerald-500';
                text.textContent = 'Claude AI ì—°ê²°ë¨';
                text.className = 'text-xs text-emerald-400';
            } else if (status === 'loading') {
                indicator.className = 'w-2 h-2 rounded-full bg-amber-500 animate-pulse';
                text.textContent = 'AI ì‘ë‹µ ì¤‘...';
                text.className = 'text-xs text-amber-400';
            } else if (status === 'error') {
                indicator.className = 'w-2 h-2 rounded-full bg-red-500';
                text.textContent = 'API ì˜¤ë¥˜';
                text.className = 'text-xs text-red-400';
            } else {
                indicator.className = 'w-2 h-2 rounded-full bg-amber-500';
                text.textContent = 'Claude AI ëŒ€ê¸°ì¤‘';
                text.className = 'text-xs text-navy-400';
            }
        }

        // ==================== AI ê¸°ëŠ¥ë“¤ ====================
        async function analyzeWithAI() {
            const scores = calculateScores();
            const prompt = `ë‹¹ì‹ ì€ ESG ì „ë¬¸ ì»¨ì„¤í„´íŠ¸ì…ë‹ˆë‹¤. ë‹¤ìŒ ê¸°ì—…ì˜ ESG ë°ì´í„°ë¥¼ ë¶„ì„í•˜ê³  ê°„ëµí•œ ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•´ì£¼ì„¸ìš”.

íšŒì‚¬ ì •ë³´:
- íšŒì‚¬ëª…: ${document.getElementById('companyNameDisplay').textContent}
- ì—…ì¢…: ${document.getElementById('industryDisplay').textContent}
- ê·œëª¨: ${document.getElementById('sizeDisplay').textContent}

ESG ì ìˆ˜:
- í™˜ê²½(E): ${scores.e}ì 
- ì‚¬íšŒ(S): ${scores.s}ì 
- ì§€ë°°êµ¬ì¡°(G): ${scores.g}ì 
- ì¢…í•©: ${scores.total}ì  (${getGrade(scores.total)} ë“±ê¸‰)

ì„¸ë¶€ ë°ì´í„°:
[í™˜ê²½] ì—ë„ˆì§€: ${esgData.environment.energyUsage.toLocaleString()}kWh, íƒ„ì†Œ: ${esgData.environment.carbonEmission}tCOâ‚‚e, ì¬ìƒì—ë„ˆì§€: ${esgData.environment.renewableEnergy}%, ì¬í™œìš©: ${esgData.environment.wasteRecycling}%
[ì‚¬íšŒ] ì„ì§ì›: ${esgData.social.employeeCount}ëª…, ì—¬ì„±ë¹„ìœ¨: ${esgData.social.femaleRatio}%, ì—¬ì„±ê´€ë¦¬ì: ${esgData.social.femaleManagerRatio}%, ê³ ê°ë§Œì¡±ë„: ${esgData.social.customerSatisfaction}%
[ì§€ë°°êµ¬ì¡°] ì‚¬ì™¸ì´ì‚¬: ${esgData.governance.boardIndependence}%, ESGìœ„ì›íšŒ: ${esgData.governance.esgCommittee ? 'ìˆìŒ' : 'ì—†ìŒ'}

300ì ì´ë‚´ë¡œ í•µì‹¬ ê°•ì ê³¼ ê°œì„ ì ì„ ë¶„ì„í•´ì£¼ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ í˜•ì‹ìœ¼ë¡œ ì‘ì„±í•´ì£¼ì„¸ìš”.`;

            document.getElementById('aiAnalysisResult').classList.remove('hidden');
            await streamClaude(prompt, document.getElementById('aiAnalysisContent'));
        }

        async function generateAITasks() {
            const scores = calculateScores();
            const prompt = `ë‹¹ì‹ ì€ ESG ì „ë¬¸ ì»¨ì„¤í„´íŠ¸ì…ë‹ˆë‹¤. ë‹¤ìŒ ESG ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê°œì„  ê³¼ì œ 4ê°œë¥¼ JSON í˜•ì‹ìœ¼ë¡œ ì œì•ˆí•´ì£¼ì„¸ìš”.

í˜„ì¬ ESG ì ìˆ˜: E=${scores.e}, S=${scores.s}, G=${scores.g}
ì¬ìƒì—ë„ˆì§€: ${esgData.environment.renewableEnergy}%, íê¸°ë¬¼ ì¬í™œìš©: ${esgData.environment.wasteRecycling}%
ì—¬ì„± ê´€ë¦¬ì: ${esgData.social.femaleManagerRatio}%, ì‚¬ì™¸ì´ì‚¬: ${esgData.governance.boardIndependence}%
ESGìœ„ì›íšŒ: ${esgData.governance.esgCommittee ? 'ìˆìŒ' : 'ì—†ìŒ'}

ë°˜ë“œì‹œ ë‹¤ìŒ JSON í˜•ì‹ìœ¼ë¡œë§Œ ì‘ë‹µí•´ì£¼ì„¸ìš” (ë‹¤ë¥¸ í…ìŠ¤íŠ¸ ì—†ì´):
[
  {"title": "ê³¼ì œëª…", "description": "í˜„ì¬ X% â†’ ëª©í‘œ Y% ë‹¬ì„± ì‹œ Zì  ìƒìŠ¹ ì˜ˆìƒ", "impact": "ë†’ì€ ì˜í–¥", "score": 8},
  {"title": "ê³¼ì œëª…", "description": "ì„¤ëª…", "impact": "ì¤‘ê°„ ì˜í–¥", "score": 5},
  {"title": "ê³¼ì œëª…", "description": "ì„¤ëª…", "impact": "ê¶Œì¥ ì‚¬í•­", "score": 4},
  {"title": "ê³¼ì œëª…", "description": "ì„¤ëª…", "impact": "ì§„í–‰ ê°€ëŠ¥", "score": 3}
]`;

            const result = await callClaude(prompt);
            if (result) {
                try {
                    const jsonMatch = result.match(/\[[\s\S]*\]/);
                    if (jsonMatch) {
                        const newTasks = JSON.parse(jsonMatch[0]);
                        const colors = ['rose', 'amber', 'sky', 'emerald'];
                        tasks = newTasks.map((t, i) => ({
                            id: i + 1,
                            title: t.title,
                            description: t.description,
                            impact: t.impact,
                            score: t.score,
                            color: colors[i % 4]
                        }));
                        renderTasks();
                    }
                } catch (e) {
                    console.error('JSON íŒŒì‹± ì˜¤ë¥˜:', e);
                }
            }
        }

        // ==================== ë ˆì´ì•„ì›ƒ ê¸°ë°˜ ë³´ê³ ì„œ ì‹œìŠ¤í…œ ====================
        let currentLayout = 'professional';

        function selectReportLayout(layout) {
            currentLayout = layout;
            document.querySelectorAll('.layout-btn').forEach(btn => {
                if (btn.dataset.layout === layout) {
                    btn.classList.remove('border-navy-200', 'border');
                    btn.classList.add('border-2', 'border-cyan-500', 'bg-cyan-50');
                } else {
                    btn.classList.remove('border-2', 'border-cyan-500', 'bg-cyan-50');
                    btn.classList.add('border', 'border-navy-200');
                }
            });
            
            // ë ˆì´ì•„ì›ƒë³„ ìŠ¤íƒ€ì¼ ì ìš©
            const preview = document.getElementById('reportPreview');
            if (layout === 'simple') {
                preview.classList.add('simple-layout');
                preview.classList.remove('infographic-layout');
            } else if (layout === 'infographic') {
                preview.classList.add('infographic-layout');
                preview.classList.remove('simple-layout');
            } else {
                preview.classList.remove('simple-layout', 'infographic-layout');
            }
        }

        function scrollToSection(sectionId) {
            const section = document.getElementById('section-' + sectionId);
            if (section) {
                section.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        // ë³´ê³ ì„œ ë°ì´í„°ë¥¼ ë ˆì´ì•„ì›ƒì— ë°˜ì˜
        function updateReportFromData() {
            const scores = calculateScores();
            const companyName = assessmentResults?.companyInfo?.name || document.getElementById('companyNameDisplay')?.textContent || 'ESG ì¸ì‚¬ì´íŠ¸';
            const today = new Date().toISOString().split('T')[0].replace(/-/g, '.');
            const quarter = `${new Date().getFullYear()}ë…„ ${Math.ceil((new Date().getMonth() + 1) / 3)}ë¶„ê¸°`;

            // í‘œì§€ ì—…ë°ì´íŠ¸
            document.getElementById('cover-company').textContent = companyName;
            document.getElementById('cover-date').textContent = today;
            document.getElementById('cover-period').textContent = quarter;

            // ìš”ì•½ ì ìˆ˜ ì—…ë°ì´íŠ¸
            document.getElementById('summary-total-score').textContent = scores.total;
            document.getElementById('summary-e-score').textContent = scores.e;
            document.getElementById('summary-s-score').textContent = scores.s;
            document.getElementById('summary-g-score').textContent = scores.g;
            
            // ë“±ê¸‰ ê³„ì‚°
            let grade = 'Cë“±ê¸‰';
            if (scores.total >= 90) grade = 'Së“±ê¸‰';
            else if (scores.total >= 80) grade = 'Aë“±ê¸‰';
            else if (scores.total >= 70) grade = 'B+ë“±ê¸‰';
            else if (scores.total >= 60) grade = 'Bë“±ê¸‰';
            document.getElementById('summary-grade').textContent = grade;

            // í™˜ê²½ ì§€í‘œ ì—…ë°ì´íŠ¸
            const totalGHG = (esgData.environment.scope1Emission || 0) + (esgData.environment.scope2Emission || 0);
            document.getElementById('env-ghg').innerHTML = `${totalGHG.toLocaleString()} <span class="text-sm font-normal">tCO2e</span>`;
            document.getElementById('env-energy').innerHTML = `${(esgData.environment.energyUsage || 0).toLocaleString()} <span class="text-sm font-normal">kWh</span>`;
            document.getElementById('env-renewable').innerHTML = `${esgData.environment.renewableEnergy || 0}<span class="text-sm font-normal">%</span>`;

            // ì‚¬íšŒ ì§€í‘œ ì—…ë°ì´íŠ¸
            document.getElementById('social-employees').innerHTML = `${(esgData.social.employeeCount || 0).toLocaleString()} <span class="text-sm font-normal">ëª…</span>`;
            document.getElementById('social-diversity').innerHTML = `${esgData.social.femaleManagerRatio || 0}<span class="text-sm font-normal">%</span>`;
            document.getElementById('social-safety').innerHTML = `${esgData.social.industrialAccidentRate || 0}<span class="text-sm font-normal">%</span>`;

            // ì§€ë°°êµ¬ì¡° ì§€í‘œ ì—…ë°ì´íŠ¸
            document.getElementById('gov-independent').innerHTML = `${esgData.governance.boardIndependence || 0}<span class="text-sm font-normal">%</span>`;
            document.getElementById('gov-ethics').innerHTML = `${esgData.governance.antiCorruptionTraining || 0}<span class="text-sm font-normal">%</span>`;
        }

        // ê°œë³„ ì„¹ì…˜ AI ìƒì„±
        async function generateSection(sectionId) {
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<div class="w-5 h-5 border-2 border-current/30 border-t-current rounded-full animate-spin"></div>';
            btn.disabled = true;

            const scores = calculateScores();
            const companyName = assessmentResults?.companyInfo?.name || document.getElementById('companyNameDisplay')?.textContent || 'ë‹¹ì‚¬';

            const sectionPrompts = {
                summary: `ESG ê²½ì˜ í˜„í™© ìš”ì•½ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¤ìŒ ì •ë³´ë¥¼ ë°”íƒ•ìœ¼ë¡œ 3-4ë¬¸ì¥ì˜ í•µì‹¬ ìš”ì•½ì„ ì‘ì„±í•˜ì„¸ìš”:
                    - íšŒì‚¬ëª…: ${companyName}
                    - ì¢…í•© ESG ì ìˆ˜: ${scores.total}ì  (E: ${scores.e}, S: ${scores.s}, G: ${scores.g})
                    - íƒ„ì†Œë°°ì¶œëŸ‰: ${esgData.environment.carbonEmission}tCO2e
                    - ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨: ${esgData.environment.renewableEnergy}%
                    - ì„ì§ì› ìˆ˜: ${esgData.social.employeeCount}ëª…
                    í•œêµ­ì–´ë¡œ ì „ë¬¸ì ì¸ ë³´ê³ ì„œ í†¤ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.`,

                environment: `í™˜ê²½(E) ê²½ì˜ í˜„í™©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¤ìŒ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:
                    - Scope 1 ë°°ì¶œëŸ‰: ${esgData.environment.scope1Emission}tCO2e
                    - Scope 2 ë°°ì¶œëŸ‰: ${esgData.environment.scope2Emission}tCO2e  
                    - ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰: ${esgData.environment.energyUsage}kWh
                    - ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨: ${esgData.environment.renewableEnergy}%
                    - ìš©ìˆ˜ ì‚¬ìš©ëŸ‰: ${esgData.environment.waterUsage}í†¤
                    - íê¸°ë¬¼ ì¬í™œìš©ë¥ : ${esgData.environment.wasteRecycling}%
                    ê¸°í›„ë³€í™” ëŒ€ì‘, ì—ë„ˆì§€ íš¨ìœ¨í™”, ìì›ìˆœí™˜ ê´€ì ì—ì„œ í˜„í™©ê³¼ ì„±ê³¼ë¥¼ 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.`,

                social: `ì‚¬íšŒ(S) ê²½ì˜ í˜„í™©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¤ìŒ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:
                    - ì„ì§ì› ìˆ˜: ${esgData.social.employeeCount}ëª…
                    - ì—¬ì„± ì„ì§ì› ë¹„ìœ¨: ${esgData.social.femaleRatio}%
                    - ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨: ${esgData.social.femaleManagerRatio}%
                    - ì¸ë‹¹ êµìœ¡ì‹œê°„: ${esgData.social.trainingHours}ì‹œê°„
                    - ì‚°ì—…ì¬í•´ìœ¨: ${esgData.social.industrialAccidentRate}%
                    - ê³ ê°ë§Œì¡±ë„: ${esgData.social.customerSatisfaction}%
                    ì¸ì ìì› ê´€ë¦¬, ë‹¤ì–‘ì„±, ì•ˆì „ë³´ê±´, ì´í•´ê´€ê³„ì ê´€ì ì—ì„œ í˜„í™©ê³¼ ì„±ê³¼ë¥¼ 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.`,

                governance: `ì§€ë°°êµ¬ì¡°(G) ê²½ì˜ í˜„í™©ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¤ìŒ ë°ì´í„°ë¥¼ ë°”íƒ•ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”:
                    - ì´ì‚¬íšŒ ê°œìµœ íšŸìˆ˜: ${esgData.governance.boardMeetings}íšŒ
                    - ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨: ${esgData.governance.boardIndependence}%
                    - ë°˜ë¶€íŒ¨ êµìœ¡ ì´ìˆ˜ìœ¨: ${esgData.governance.antiCorruptionTraining}%
                    - ESG ìœ„ì›íšŒ ì„¤ì¹˜: ${esgData.governance.esgCommittee ? 'ì„¤ì¹˜' : 'ë¯¸ì„¤ì¹˜'}
                    - ë‚´ë¶€ê³ ë°œì ë³´í˜¸: ${esgData.governance.whistleblowerProtection ? 'ìˆìŒ' : 'ì—†ìŒ'}
                    ì´ì‚¬íšŒ ìš´ì˜, ìœ¤ë¦¬ê²½ì˜, íˆ¬ëª…ì„± ê´€ì ì—ì„œ í˜„í™©ê³¼ ì„±ê³¼ë¥¼ 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±í•˜ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.`,

                recommendations: `ESG ê°œì„ ê³¼ì œì™€ ë¡œë“œë§µì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ë‹¤ìŒ ì ìˆ˜ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê°œì„ ì´ í•„ìš”í•œ ì˜ì—­ì„ íŒŒì•…í•˜ì„¸ìš”:
                    - í™˜ê²½(E): ${scores.e}ì 
                    - ì‚¬íšŒ(S): ${scores.s}ì 
                    - ì§€ë°°êµ¬ì¡°(G): ${scores.g}ì 
                    ê°€ì¥ ë‚®ì€ ì ìˆ˜ì˜ ì˜ì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ 2025-2027ë…„ 3ê°œë…„ ë¡œë“œë§µì„ ì‘ì„±í•˜ì„¸ìš”. ê° ì—°ë„ë³„ë¡œ 1-2ë¬¸ì¥ì”© ëª©í‘œë¥¼ ì œì‹œí•˜ì„¸ìš”. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë¡œ ì‘ì„±í•˜ì„¸ìš”.`
            };

            const prompt = sectionPrompts[sectionId];
            if (!prompt) {
                btn.innerHTML = originalHTML;
                btn.disabled = false;
                return;
            }

            try {
                const result = await callClaude(prompt);
                if (result) {
                    const targetId = {
                        'summary': 'summary-content',
                        'environment': 'env-content',
                        'social': 'social-content',
                        'governance': 'gov-content',
                        'recommendations': 'roadmap-content'
                    }[sectionId];
                    
                    if (targetId) {
                        document.getElementById(targetId).textContent = result;
                    }
                }
            } catch (error) {
                console.error('ì„¹ì…˜ ìƒì„± ì˜¤ë¥˜:', error);
                alert('AI ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }

            btn.innerHTML = originalHTML;
            btn.disabled = false;
        }

        // ì „ì²´ ì„¹ì…˜ AI ìƒì„±
        async function generateAllSections() {
            const btn = document.getElementById('generateAllBtn');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<div class="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"></div> ìƒì„± ì¤‘...';
            btn.disabled = true;

            // ë¨¼ì € ë°ì´í„°ë¡œ ì—…ë°ì´íŠ¸
            updateReportFromData();

            const sections = ['summary', 'environment', 'social', 'governance', 'recommendations'];
            
            for (const section of sections) {
                try {
                    // ê° ì„¹ì…˜ì˜ ë²„íŠ¼ ì°¾ì•„ì„œ í´ë¦­ ì‹œë®¬ë ˆì´ì…˜
                    const sectionBtn = document.querySelector(`#section-${section} button[onclick*="generateSection"]`);
                    if (sectionBtn) {
                        await generateSectionDirect(section);
                    }
                } catch (error) {
                    console.error(`${section} ì„¹ì…˜ ìƒì„± ì˜¤ë¥˜:`, error);
                }
            }

            btn.innerHTML = originalHTML;
            btn.disabled = false;
            alert('ëª¨ë“  ì„¹ì…˜ì´ AIë¡œ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤!');
        }

        // ì§ì ‘ ì„¹ì…˜ ìƒì„± (ë²„íŠ¼ í´ë¦­ ì—†ì´)
        async function generateSectionDirect(sectionId) {
            const scores = calculateScores();
            const companyName = assessmentResults?.companyInfo?.name || 'ë‹¹ì‚¬';

            const sectionPrompts = {
                summary: `ESG ê²½ì˜ í˜„í™© ìš”ì•½ì„ ì‘ì„±í•´ì£¼ì„¸ìš”. ì¢…í•© ${scores.total}ì (E:${scores.e}, S:${scores.s}, G:${scores.g}), íƒ„ì†Œë°°ì¶œ ${esgData.environment.carbonEmission}tCO2e, ì¬ìƒì—ë„ˆì§€ ${esgData.environment.renewableEnergy}%, ì„ì§ì› ${esgData.social.employeeCount}ëª…. 3-4ë¬¸ì¥ìœ¼ë¡œ ì „ë¬¸ì ì¸ ë³´ê³ ì„œ í†¤ìœ¼ë¡œ ì‘ì„±. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ.`,

                environment: `í™˜ê²½ê²½ì˜ í˜„í™©: Scope1 ${esgData.environment.scope1Emission}tCO2e, Scope2 ${esgData.environment.scope2Emission}tCO2e, ì—ë„ˆì§€ ${esgData.environment.energyUsage}kWh, ì¬ìƒì—ë„ˆì§€ ${esgData.environment.renewableEnergy}%, ìš©ìˆ˜ ${esgData.environment.waterUsage}í†¤, íê¸°ë¬¼ì¬í™œìš© ${esgData.environment.wasteRecycling}%. 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ.`,

                social: `ì‚¬íšŒì  ì±…ì„ í˜„í™©: ì„ì§ì› ${esgData.social.employeeCount}ëª…, ì—¬ì„±ë¹„ìœ¨ ${esgData.social.femaleRatio}%, ì—¬ì„±ê´€ë¦¬ì ${esgData.social.femaleManagerRatio}%, êµìœ¡ ${esgData.social.trainingHours}ì‹œê°„, ì¬í•´ìœ¨ ${esgData.social.industrialAccidentRate}%, ê³ ê°ë§Œì¡± ${esgData.social.customerSatisfaction}%. 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ.`,

                governance: `ì§€ë°°êµ¬ì¡° í˜„í™©: ì´ì‚¬íšŒ ${esgData.governance.boardMeetings}íšŒ, ì‚¬ì™¸ì´ì‚¬ ${esgData.governance.boardIndependence}%, ë°˜ë¶€íŒ¨êµìœ¡ ${esgData.governance.antiCorruptionTraining}%, ESGìœ„ì›íšŒ ${esgData.governance.esgCommittee ? 'ì„¤ì¹˜' : 'ë¯¸ì„¤ì¹˜'}. 4-5ë¬¸ì¥ìœ¼ë¡œ ì‘ì„±. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ.`,

                recommendations: `ESG ê°œì„  ë¡œë“œë§µ: E ${scores.e}ì , S ${scores.s}ì , G ${scores.g}ì . ê°€ì¥ ë‚®ì€ ì˜ì—­ ì¤‘ì‹¬ 2025-2027ë…„ 3ê°œë…„ ê³„íšì„ ì—°ë„ë³„ 1-2ë¬¸ì¥ì”© ì‘ì„±. ë§ˆí¬ë‹¤ìš´ ì—†ì´ ìˆœìˆ˜ í…ìŠ¤íŠ¸ë§Œ.`
            };

            const prompt = sectionPrompts[sectionId];
            if (!prompt) return;

            try {
                const result = await callClaude(prompt);
                if (result) {
                    const targetId = {
                        'summary': 'summary-content',
                        'environment': 'env-content',
                        'social': 'social-content',
                        'governance': 'gov-content',
                        'recommendations': 'roadmap-content'
                    }[sectionId];
                    
                    if (targetId) {
                        document.getElementById(targetId).textContent = result;
                    }
                }
            } catch (error) {
                console.error('ì„¹ì…˜ ìƒì„± ì˜¤ë¥˜:', error);
            }
        }

        // PDF ë‚´ë³´ë‚´ê¸°
        async function exportToPDF() {
            const btn = event.target.closest('button');
            const originalHTML = btn.innerHTML;
            btn.innerHTML = '<div class="w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"></div> PDF ìƒì„± ì¤‘...';
            btn.disabled = true;

            try {
                // html2pdf ë¼ì´ë¸ŒëŸ¬ë¦¬ ë™ì  ë¡œë“œ
                if (!window.html2pdf) {
                    const script = document.createElement('script');
                    script.src = 'https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js';
                    document.head.appendChild(script);
                    await new Promise(resolve => script.onload = resolve);
                }

                // ë°ì´í„° ìˆ˜ì§‘
                const companyName = document.getElementById('cover-company').textContent || 'ESG Report';
                const reportTitle = document.getElementById('cover-title').textContent || 'ESG ê²½ì˜ ë³´ê³ ì„œ';
                const period = document.getElementById('cover-period').textContent || '';
                const date = document.getElementById('cover-date').textContent || '';
                const today = new Date().toISOString().split('T')[0];

                const totalScore = document.getElementById('summary-total-score').textContent || '-';
                const grade = document.getElementById('summary-grade').textContent || '-';
                const eScore = document.getElementById('summary-e-score').textContent || '-';
                const sScore = document.getElementById('summary-s-score').textContent || '-';
                const gScore = document.getElementById('summary-g-score').textContent || '-';

                const summaryContent = document.getElementById('summary-content').innerText || '';
                const achievements = document.getElementById('summary-achievements').innerText || '';
                const improvements = document.getElementById('summary-improvements').innerText || '';
                const envContent = document.getElementById('env-content').innerText || '';
                const envGoals = document.getElementById('env-goals').innerText || '';
                const socialContent = document.getElementById('social-content').innerText || '';
                const govContent = document.getElementById('gov-content').innerText || '';
                const roadmapContent = document.getElementById('roadmap-content').innerText || '';

                // PDFìš© ê°„ì†Œí™”ëœ HTML ìƒì„±
                const pdfHTML = `
                <div id="pdf-container" style="width: 210mm; font-family: 'Noto Sans KR', sans-serif; background: white;">
                    
                    <!-- í‘œì§€ -->
                    <div style="height: 297mm; background: linear-gradient(135deg, #102a43 0%, #1e4d3d 100%); color: white; display: flex; flex-direction: column; justify-content: center; align-items: center; text-align: center; padding: 40px; box-sizing: border-box;">
                        <div style="width: 80px; height: 80px; background: rgba(255,255,255,0.2); border-radius: 16px; display: flex; align-items: center; justify-content: center; margin-bottom: 40px;">
                            <svg width="40" height="40" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="2">
                                <path d="M9 12l2 2 4-4m5.618-4.016A11.955 11.955 0 0112 2.944a11.955 11.955 0 01-8.618 3.04A12.02 12.02 0 003 9c0 5.591 3.824 10.29 9 11.622 5.176-1.332 9-6.03 9-11.622 0-1.042-.133-2.052-.382-3.016z"/>
                            </svg>
                        </div>
                        <p style="color: #6ee7b7; font-size: 14px; letter-spacing: 4px; margin-bottom: 20px;">ESG MANAGEMENT REPORT</p>
                        <h1 style="font-size: 42px; font-weight: bold; margin: 0 0 20px 0;">${reportTitle}</h1>
                        <h2 style="font-size: 28px; font-weight: 300; margin: 0 0 60px 0;">${companyName}</h2>
                        <p style="color: rgba(255,255,255,0.7); font-size: 16px;">${period} | ${date}</p>
                    </div>

                    <!-- ìš”ì•½ -->
                    <div style="padding: 40px; min-height: 250mm; box-sizing: border-box;">
                        <h2 style="font-size: 28px; font-weight: bold; color: #102a43; border-left: 4px solid #06b6d4; padding-left: 16px; margin-bottom: 30px;">Executive Summary</h2>
                        
                        <div style="display: flex; gap: 16px; margin-bottom: 30px;">
                            <div style="flex: 1; background: linear-gradient(135deg, #f0f4f8, #d9e2ec); border-radius: 12px; padding: 20px; text-align: center;">
                                <p style="color: #627d98; font-size: 14px; margin: 0 0 8px 0;">ì¢…í•© ì ìˆ˜</p>
                                <p style="font-size: 36px; font-weight: bold; color: #102a43; margin: 0;">${totalScore}</p>
                                <p style="font-size: 18px; font-weight: 600; color: #059669; margin: 8px 0 0 0;">${grade}</p>
                            </div>
                            <div style="flex: 1; background: linear-gradient(135deg, #d1fae5, #a7f3d0); border-radius: 12px; padding: 20px; text-align: center;">
                                <p style="color: #059669; font-size: 14px; margin: 0 0 8px 0;">í™˜ê²½ (E)</p>
                                <p style="font-size: 36px; font-weight: bold; color: #047857; margin: 0;">${eScore}</p>
                            </div>
                            <div style="flex: 1; background: linear-gradient(135deg, #dbeafe, #bfdbfe); border-radius: 12px; padding: 20px; text-align: center;">
                                <p style="color: #2563eb; font-size: 14px; margin: 0 0 8px 0;">ì‚¬íšŒ (S)</p>
                                <p style="font-size: 36px; font-weight: bold; color: #1d4ed8; margin: 0;">${sScore}</p>
                            </div>
                            <div style="flex: 1; background: linear-gradient(135deg, #ede9fe, #ddd6fe); border-radius: 12px; padding: 20px; text-align: center;">
                                <p style="color: #7c3aed; font-size: 14px; margin: 0 0 8px 0;">ì§€ë°°êµ¬ì¡° (G)</p>
                                <p style="font-size: 36px; font-weight: bold; color: #6d28d9; margin: 0;">${gScore}</p>
                            </div>
                        </div>

                        <div style="background: #f0f4f8; border-radius: 12px; padding: 24px; margin-bottom: 24px;">
                            <h3 style="font-weight: 600; color: #102a43; margin: 0 0 12px 0;">ğŸ“‹ í•µì‹¬ ìš”ì•½</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${summaryContent}</p>
                        </div>

                        <div style="display: flex; gap: 24px;">
                            <div style="flex: 1; border: 1px solid #a7f3d0; border-radius: 12px; padding: 20px;">
                                <h4 style="color: #047857; margin: 0 0 12px 0;">âœ… ì£¼ìš” ì„±ê³¼</h4>
                                <p style="color: #334e68; font-size: 14px; line-height: 1.8; margin: 0; white-space: pre-wrap;">${achievements}</p>
                            </div>
                            <div style="flex: 1; border: 1px solid #fcd34d; border-radius: 12px; padding: 20px;">
                                <h4 style="color: #b45309; margin: 0 0 12px 0;">âš ï¸ ê°œì„  í•„ìš”</h4>
                                <p style="color: #334e68; font-size: 14px; line-height: 1.8; margin: 0; white-space: pre-wrap;">${improvements}</p>
                            </div>
                        </div>
                    </div>

                    <!-- í™˜ê²½ -->
                    <div style="padding: 40px; background: #f0fdf4; min-height: 250mm; box-sizing: border-box;">
                        <h2 style="font-size: 28px; font-weight: bold; color: #102a43; border-left: 4px solid #10b981; padding-left: 16px; margin-bottom: 30px;">
                            <span style="color: #059669;">E</span>nvironment í™˜ê²½
                        </h2>
                        
                        <div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; border: 1px solid #d1fae5;">
                            <h3 style="font-weight: 600; color: #102a43; margin: 0 0 16px 0;">ğŸŒ± í™˜ê²½ ê²½ì˜ í˜„í™©</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${envContent}</p>
                        </div>

                        <div style="background: #d1fae5; border-radius: 12px; padding: 24px; border: 1px solid #a7f3d0;">
                            <h3 style="font-weight: 600; color: #047857; margin: 0 0 12px 0;">ğŸ¯ í™˜ê²½ ëª©í‘œ</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${envGoals}</p>
                        </div>
                    </div>

                    <!-- ì‚¬íšŒ -->
                    <div style="padding: 40px; background: #eff6ff; min-height: 250mm; box-sizing: border-box;">
                        <h2 style="font-size: 28px; font-weight: bold; color: #102a43; border-left: 4px solid #3b82f6; padding-left: 16px; margin-bottom: 30px;">
                            <span style="color: #2563eb;">S</span>ocial ì‚¬íšŒ
                        </h2>
                        
                        <div style="background: white; border-radius: 12px; padding: 24px; border: 1px solid #bfdbfe;">
                            <h3 style="font-weight: 600; color: #102a43; margin: 0 0 16px 0;">ğŸ‘¥ ì‚¬íšŒì  ì±…ì„ í˜„í™©</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${socialContent}</p>
                        </div>
                    </div>

                    <!-- ì§€ë°°êµ¬ì¡° -->
                    <div style="padding: 40px; background: #faf5ff; min-height: 250mm; box-sizing: border-box;">
                        <h2 style="font-size: 28px; font-weight: bold; color: #102a43; border-left: 4px solid #8b5cf6; padding-left: 16px; margin-bottom: 30px;">
                            <span style="color: #7c3aed;">G</span>overnance ì§€ë°°êµ¬ì¡°
                        </h2>
                        
                        <div style="background: white; border-radius: 12px; padding: 24px; border: 1px solid #ddd6fe;">
                            <h3 style="font-weight: 600; color: #102a43; margin: 0 0 16px 0;">âš–ï¸ ì§€ë°°êµ¬ì¡° í˜„í™©</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${govContent}</p>
                        </div>
                    </div>

                    <!-- ê°œì„ ê³¼ì œ -->
                    <div style="padding: 40px; background: #fffbeb; min-height: 200mm; box-sizing: border-box;">
                        <h2 style="font-size: 28px; font-weight: bold; color: #102a43; border-left: 4px solid #f59e0b; padding-left: 16px; margin-bottom: 30px;">ê°œì„ ê³¼ì œ ë° ëª©í‘œ</h2>
                        
                        <div style="background: white; border-radius: 12px; padding: 24px; border: 1px solid #fcd34d;">
                            <h3 style="font-weight: 600; color: #102a43; margin: 0 0 16px 0;">ğŸ—“ï¸ ESG ì¶”ì§„ ë¡œë“œë§µ</h3>
                            <p style="color: #334e68; line-height: 1.8; margin: 0; white-space: pre-wrap;">${roadmapContent}</p>
                        </div>

                        <div style="margin-top: 60px; padding-top: 30px; border-top: 1px solid #d1d5db; text-align: center; color: #6b7280; font-size: 12px;">
                            <p style="margin: 0;">ë³¸ ë³´ê³ ì„œëŠ” ESG Insight í”Œë«í¼ì„ í†µí•´ ì‘ì„±ë˜ì—ˆìŠµë‹ˆë‹¤.</p>
                            <p style="margin: 8px 0 0 0;">Â© 2024 ESG Insight. All rights reserved.</p>
                        </div>
                    </div>

                </div>
                `;

                // ì„ì‹œ ì»¨í…Œì´ë„ˆ ìƒì„±
                const tempContainer = document.createElement('div');
                tempContainer.innerHTML = pdfHTML;
                tempContainer.style.position = 'absolute';
                tempContainer.style.left = '-9999px';
                tempContainer.style.top = '0';
                document.body.appendChild(tempContainer);

                const pdfElement = tempContainer.querySelector('#pdf-container');

                const opt = {
                    margin: 0,
                    filename: `${companyName}_ESG_Report_${today}.pdf`,
                    image: { type: 'jpeg', quality: 0.98 },
                    html2canvas: { 
                        scale: 2,
                        useCORS: true,
                        logging: false,
                        backgroundColor: '#ffffff'
                    },
                    jsPDF: { 
                        unit: 'mm', 
                        format: 'a4', 
                        orientation: 'portrait'
                    },
                    pagebreak: { 
                        mode: 'avoid-all'
                    }
                };

                await html2pdf().set(opt).from(pdfElement).save();
                
                // ì„ì‹œ ì»¨í…Œì´ë„ˆ ì œê±°
                document.body.removeChild(tempContainer);
                
                alert('PDFê°€ ì„±ê³µì ìœ¼ë¡œ ë‹¤ìš´ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤!');

            } catch (error) {
                console.error('PDF ìƒì„± ì˜¤ë¥˜:', error);
                alert('PDF ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: ' + error.message);
            }

            btn.innerHTML = originalHTML;
            btn.disabled = false;
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ ë³´ê³ ì„œ ë°ì´í„° ì—…ë°ì´íŠ¸
        function initReportPage() {
            updateReportFromData();
        }

        // ê¸°ì¡´ generateReportWithAI í•¨ìˆ˜ (í˜¸í™˜ì„± ìœ ì§€)
        async function generateReportWithAI() {
            await generateAllSections();
        }

        async function sendChatMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            if (!message) return;

            const chatContainer = document.getElementById('chatMessages');

            chatContainer.innerHTML += `
                <div class="flex gap-3 justify-end">
                    <div class="bg-navy-900 text-white rounded-2xl rounded-tr-none p-4 max-w-2xl">
                        <p class="text-sm">${message}</p>
                    </div>
                    <div class="w-8 h-8 rounded-lg bg-navy-200 flex items-center justify-center flex-shrink-0 text-sm font-bold text-navy-600">ê¹€</div>
                </div>
            `;

            input.value = '';

            const responseId = 'response-' + Date.now();
            chatContainer.innerHTML += `
                <div class="flex gap-3">
                    <div class="w-8 h-8 rounded-lg bg-gradient-to-br from-emerald-500 to-cyan-500 flex items-center justify-center flex-shrink-0">
                        <svg class="w-4 h-4 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg>
                    </div>
                    <div class="bg-navy-50 rounded-2xl rounded-tl-none p-4 max-w-2xl">
                        <div id="${responseId}" class="text-navy-700 text-sm markdown-content"></div>
                    </div>
                </div>
            `;

            chatContainer.scrollTop = chatContainer.scrollHeight;

            // K-ESG ìê°€ì§„ë‹¨ ê²°ê³¼ ë°˜ì˜
            let assessmentContext = '';
            if (assessmentResults) {
                assessmentContext = `
K-ESG ìê°€ì§„ë‹¨ ê²°ê³¼:
- ì¢…í•©: ${assessmentResults.totalScore}ì  (${assessmentResults.grade} ë“±ê¸‰)
- í™˜ê²½(E): ${assessmentResults.scores?.E || 0}ì 
- ì‚¬íšŒ(S): ${assessmentResults.scores?.S || 0}ì 
- ì§€ë°°êµ¬ì¡°(G): ${assessmentResults.scores?.G || 0}ì `;
            }

            const companyName = assessmentResults?.companyInfo?.name || document.getElementById('companyNameDisplay').textContent;
            const scores = calculateScores();
            
            const systemContext = `ë‹¹ì‹ ì€ ESG ì „ë¬¸ ì»¨ì„¤í„´íŠ¸ì…ë‹ˆë‹¤. ì‚¬ìš©ì íšŒì‚¬ì˜ ESG í˜„í™©:
- íšŒì‚¬ëª…: ${companyName}
- ì—…ì¢…: ${assessmentResults?.companyInfo?.industry || document.getElementById('industryDisplay').textContent}
${assessmentContext}

ESG ë°ì´í„°:
- íƒ„ì†Œë°°ì¶œ: ${esgData.environment.carbonEmission}tCOâ‚‚e, ì¬ìƒì—ë„ˆì§€: ${esgData.environment.renewableEnergy}%
- ì—¬ì„±ë¹„ìœ¨: ${esgData.social.femaleRatio}%, ê³ ê°ë§Œì¡±ë„: ${esgData.social.customerSatisfaction}%
- ì‚¬ì™¸ì´ì‚¬: ${esgData.governance.boardIndependence}%, ESGìœ„ì›íšŒ: ${esgData.governance.esgCommittee ? 'ì„¤ì¹˜ë¨' : 'ë¯¸ì„¤ì¹˜'}

ì¹œì ˆí•˜ê³  ì „ë¬¸ì ìœ¼ë¡œ ë‹µë³€í•´ì£¼ì„¸ìš”. K-ESG ê°€ì´ë“œë¼ì¸ì„ ê¸°ì¤€ìœ¼ë¡œ êµ¬ì²´ì ì¸ ê°œì„  ë°©ì•ˆì„ ì œì‹œí•´ì£¼ì„¸ìš”. í•œêµ­ì–´ë¡œ ë‹µë³€í•©ë‹ˆë‹¤.

ì‚¬ìš©ì ì§ˆë¬¸: ${message}`;

            await streamClaude(systemContext, document.getElementById(responseId));
            chatContainer.scrollTop = chatContainer.scrollHeight;
        }

        // ==================== ê¸°ë³¸ í•¨ìˆ˜ë“¤ ====================
        function calculateScores() {
            const e = Math.min(100, (esgData.environment.renewableEnergy * 2) + (esgData.environment.wasteRecycling * 0.5) + 40);
            const s = Math.min(100, (esgData.social.femaleRatio * 0.5) + (esgData.social.femaleManagerRatio) + (esgData.social.customerSatisfaction * 0.5));
            const g = Math.min(100, (esgData.governance.boardIndependence) + (esgData.governance.antiCorruptionTraining * 0.3) + (esgData.governance.esgCommittee ? 20 : 0));
            const total = (e + s + g) / 3;
            return { e: Math.round(e), s: Math.round(s), g: Math.round(g), total: total.toFixed(1) };
        }

        function getGrade(score) {
            if (score >= 90) return 'A+';
            if (score >= 85) return 'A';
            if (score >= 80) return 'A-';
            if (score >= 75) return 'B+';
            if (score >= 70) return 'B';
            if (score >= 65) return 'B-';
            if (score >= 60) return 'C+';
            return 'C';
        }

        function updateDashboard() {
            const scores = calculateScores();
            const grade = getGrade(scores.total);
            document.getElementById('totalScore').textContent = scores.total;
            document.getElementById('eScore').textContent = scores.e;
            document.getElementById('sScore').textContent = scores.s;
            document.getElementById('gScore').textContent = scores.g;
            document.getElementById('gradeDisplay').textContent = grade;
            document.getElementById('carbonValue').textContent = esgData.environment.carbonEmission.toLocaleString();
        }

        function renderReports() {
            const container = document.getElementById('reportsList');
            container.innerHTML = reports.slice(0, 3).map(report => `
                <div class="p-4 rounded-xl bg-navy-50 border border-navy-200 hover:border-cyan-300 transition-colors cursor-pointer" onclick="showPage('ai-report'); selectReport(${report.id})">
                    <div class="flex items-start justify-between mb-3">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 rounded-lg bg-${report.color}-100 flex items-center justify-center text-${report.color}-600">
                                <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg>
                            </div>
                            <div>
                                <p class="font-medium text-navy-900 text-sm">${report.title}</p>
                                <p class="text-navy-400 text-xs mt-0.5">ë§ˆì§€ë§‰ ìˆ˜ì •: ${report.lastModified}</p>
                            </div>
                        </div>
                        <span class="px-2.5 py-1 rounded-full text-xs font-medium ${report.status === 'ì‘ì„± ì¤‘' ? 'bg-amber-100 text-amber-700' : report.status === 'ì™„ë£Œ' ? 'bg-emerald-100 text-emerald-700' : 'bg-navy-200 text-navy-600'}">${report.status}</span>
                    </div>
                    <div class="flex items-center gap-3">
                        <div class="flex-1 h-2 bg-navy-200 rounded-full overflow-hidden">
                            <div class="h-full bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-full" style="width: ${report.progress}%"></div>
                        </div>
                        <span class="text-xs text-navy-500 font-medium">${report.progress}%</span>
                    </div>
                </div>
            `).join('');
        }

        function renderTasks() {
            const container = document.getElementById('tasksList');
            container.innerHTML = tasks.map((task, index) => `
                <div class="flex items-center gap-4 p-4 rounded-xl border border-navy-200 hover:border-emerald-300 cursor-pointer transition-all hover:pl-5">
                    <div class="w-10 h-10 rounded-lg bg-${task.color}-100 flex items-center justify-center flex-shrink-0">
                        <span class="text-${task.color}-600 font-display font-bold">${index + 1}</span>
                    </div>
                    <div class="flex-1 min-w-0">
                        <div class="flex items-center gap-2 mb-1">
                            <p class="font-medium text-navy-900 text-sm">${task.title}</p>
                            <span class="px-2 py-0.5 rounded bg-${task.color}-100 text-${task.color}-700 text-xs">${task.impact}</span>
                        </div>
                        <p class="text-navy-400 text-xs truncate">${task.description}</p>
                    </div>
                    <div class="text-right flex-shrink-0">
                        <p class="text-emerald-600 font-display font-bold">+${task.score}</p>
                        <p class="text-navy-400 text-xs">ì˜ˆìƒ ì ìˆ˜</p>
                    </div>
                </div>
            `).join('');
        }

        function renderAIReports() {
            const container = document.getElementById('aiReportsList');
            container.innerHTML = reports.map(report => `
                <div onclick="selectReport(${report.id})" class="p-4 rounded-xl border cursor-pointer transition-all ${selectedReport?.id === report.id ? 'border-cyan-500 bg-cyan-50' : 'border-navy-200 hover:border-navy-300'}">
                    <div class="flex items-start justify-between">
                        <div>
                            <p class="font-medium text-navy-900 text-sm">${report.title}</p>
                            <p class="text-navy-400 text-xs mt-1">${report.lastModified}</p>
                        </div>
                        <button onclick="event.stopPropagation(); deleteReport(${report.id})" class="text-navy-400 hover:text-rose-500 transition-colors">
                            <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path></svg>
                        </button>
                    </div>
                    <div class="mt-3 flex items-center gap-2">
                        <div class="flex-1 h-1.5 bg-navy-200 rounded-full overflow-hidden">
                            <div class="h-full bg-gradient-to-r from-cyan-500 to-emerald-500 rounded-full" style="width: ${report.progress}%"></div>
                        </div>
                        <span class="text-xs text-navy-500">${report.progress}%</span>
                    </div>
                </div>
            `).join('');
        }

        function showPage(pageId) {
            document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
            document.getElementById('page-' + pageId).classList.add('active');

            document.querySelectorAll('.nav-item').forEach(n => {
                n.classList.remove('active', 'text-white');
                n.classList.add('text-navy-300');
            });
            const activeNav = document.querySelector(`[data-page="${pageId}"]`);
            if (activeNav) {
                activeNav.classList.add('active', 'text-white');
                activeNav.classList.remove('text-navy-300');
            }

            if (pageId === 'ai-report') {
                renderAIReports();
                initReportPage(); // ë³´ê³ ì„œ í˜ì´ì§€ ì´ˆê¸°í™” (ë°ì´í„° ë°˜ì˜)
            }
        }

        function showDataTab(tabId) {
            document.querySelectorAll('.data-tab-content').forEach(t => t.classList.add('hidden'));
            document.getElementById('tab-' + tabId).classList.remove('hidden');
            document.querySelectorAll('.tab-btn').forEach(b => {
                b.classList.remove('active');
                b.classList.add('text-navy-500');
            });
            document.querySelector(`[data-tab="${tabId}"]`).classList.add('active');
            document.querySelector(`[data-tab="${tabId}"]`).classList.remove('text-navy-500');
        }

        function saveData() {
            // í™˜ê²½(E) - í™˜ê²½ê²½ì˜ ì²´ê³„
            esgData.environment.envPolicy = document.getElementById('envPolicy')?.checked || false;
            esgData.environment.envOrganization = document.getElementById('envOrganization')?.checked || false;
            esgData.environment.envCertification = document.getElementById('envCertification')?.checked || false;
            esgData.environment.envTarget = document.getElementById('envTarget')?.checked || false;
            // í™˜ê²½(E) - ì˜¨ì‹¤ê°€ìŠ¤/ì—ë„ˆì§€
            esgData.environment.scope1Emission = parseFloat(document.getElementById('scope1Emission')?.value) || 0;
            esgData.environment.scope2Emission = parseFloat(document.getElementById('scope2Emission')?.value) || 0;
            esgData.environment.scope3Emission = parseFloat(document.getElementById('scope3Emission')?.value) || 0;
            esgData.environment.energyUsage = parseFloat(document.getElementById('energyUsage')?.value) || 0;
            esgData.environment.energyIntensity = parseFloat(document.getElementById('energyIntensity')?.value) || 0;
            esgData.environment.renewableEnergy = parseFloat(document.getElementById('renewableEnergy')?.value) || 0;
            // í™˜ê²½(E) - ìš©ìˆ˜/íê¸°ë¬¼
            esgData.environment.waterUsage = parseFloat(document.getElementById('waterUsage')?.value) || 0;
            esgData.environment.waterRecycling = parseFloat(document.getElementById('waterRecycling')?.value) || 0;
            esgData.environment.wasteGeneration = parseFloat(document.getElementById('wasteGeneration')?.value) || 0;
            esgData.environment.wasteRecycling = parseFloat(document.getElementById('wasteRecycling')?.value) || 0;
            esgData.environment.airPollution = parseFloat(document.getElementById('airPollution')?.value) || 0;
            esgData.environment.waterPollution = parseFloat(document.getElementById('waterPollution')?.value) || 0;
            // í™˜ê²½(E) - í™˜ê²½ ë¦¬ìŠ¤í¬
            esgData.environment.envViolations = parseFloat(document.getElementById('envViolations')?.value) || 0;
            esgData.environment.envFines = parseFloat(document.getElementById('envFines')?.value) || 0;
            esgData.environment.greenProduct = parseFloat(document.getElementById('greenProduct')?.value) || 0;

            // ì‚¬íšŒ(S) - ê³ ìš© í˜„í™©
            esgData.social.employeeCount = parseFloat(document.getElementById('employeeCount')?.value) || 0;
            esgData.social.permanentRatio = parseFloat(document.getElementById('permanentRatio')?.value) || 0;
            esgData.social.newHires = parseFloat(document.getElementById('newHires')?.value) || 0;
            esgData.social.turnoverRate = parseFloat(document.getElementById('turnoverRate')?.value) || 0;
            esgData.social.avgTenure = parseFloat(document.getElementById('avgTenure')?.value) || 0;
            esgData.social.avgSalary = parseFloat(document.getElementById('avgSalary')?.value) || 0;
            // ì‚¬íšŒ(S) - ë‹¤ì–‘ì„±/í¬ìš©ì„±
            esgData.social.femaleRatio = parseFloat(document.getElementById('femaleRatio')?.value) || 0;
            esgData.social.femaleManagerRatio = parseFloat(document.getElementById('femaleManagerRatio')?.value) || 0;
            esgData.social.disabledRatio = parseFloat(document.getElementById('disabledRatio')?.value) || 0;
            esgData.social.parentalLeaveRate = parseFloat(document.getElementById('parentalLeaveRate')?.value) || 0;
            esgData.social.parentalReturnRate = parseFloat(document.getElementById('parentalReturnRate')?.value) || 0;
            esgData.social.foreignRatio = parseFloat(document.getElementById('foreignRatio')?.value) || 0;
            // ì‚¬íšŒ(S) - êµìœ¡/ì•ˆì „
            esgData.social.trainingHours = parseFloat(document.getElementById('trainingHours')?.value) || 0;
            esgData.social.trainingCost = parseFloat(document.getElementById('trainingCost')?.value) || 0;
            esgData.social.safetyTrainingRate = parseFloat(document.getElementById('safetyTrainingRate')?.value) || 0;
            esgData.social.industrialAccidents = parseFloat(document.getElementById('industrialAccidents')?.value) || 0;
            esgData.social.ltir = parseFloat(document.getElementById('ltir')?.value) || 0;
            esgData.social.fatalAccidents = parseFloat(document.getElementById('fatalAccidents')?.value) || 0;
            // ì‚¬íšŒ(S) - ê³µê¸‰ë§/ê³ ê°
            esgData.social.supplierEsgRate = parseFloat(document.getElementById('supplierEsgRate')?.value) || 0;
            esgData.social.customerSatisfaction = parseFloat(document.getElementById('customerSatisfaction')?.value) || 0;
            esgData.social.privacyBreaches = parseFloat(document.getElementById('privacyBreaches')?.value) || 0;
            esgData.social.securityIncidents = parseFloat(document.getElementById('securityIncidents')?.value) || 0;
            esgData.social.socialInvestment = parseFloat(document.getElementById('socialInvestment')?.value) || 0;
            esgData.social.volunteerRate = parseFloat(document.getElementById('volunteerRate')?.value) || 0;

            // ì§€ë°°êµ¬ì¡°(G) - ì´ì‚¬íšŒ
            esgData.governance.boardSize = parseFloat(document.getElementById('boardSize')?.value) || 0;
            esgData.governance.boardIndependence = parseFloat(document.getElementById('boardIndependence')?.value) || 0;
            esgData.governance.femaleBoardRatio = parseFloat(document.getElementById('femaleBoardRatio')?.value) || 0;
            esgData.governance.boardMeetings = parseFloat(document.getElementById('boardMeetings')?.value) || 0;
            esgData.governance.boardAttendance = parseFloat(document.getElementById('boardAttendance')?.value) || 0;
            esgData.governance.boardExpertise = parseFloat(document.getElementById('boardExpertise')?.value) || 0;
            // ì§€ë°°êµ¬ì¡°(G) - ìœ„ì›íšŒ
            esgData.governance.auditCommittee = document.getElementById('auditCommittee')?.checked || false;
            esgData.governance.esgCommittee = document.getElementById('esgCommittee')?.checked || false;
            esgData.governance.nominationCommittee = document.getElementById('nominationCommittee')?.checked || false;
            esgData.governance.compensationCommittee = document.getElementById('compensationCommittee')?.checked || false;
            esgData.governance.riskCommittee = document.getElementById('riskCommittee')?.checked || false;
            esgData.governance.internalAudit = document.getElementById('internalAudit')?.checked || false;
            // ì§€ë°°êµ¬ì¡°(G) - ìœ¤ë¦¬ê²½ì˜
            esgData.governance.ethicsViolations = parseFloat(document.getElementById('ethicsViolations')?.value) || 0;
            esgData.governance.antiCorruptionTraining = parseFloat(document.getElementById('antiCorruptionTraining')?.value) || 0;
            esgData.governance.whistleblowing = parseFloat(document.getElementById('whistleblowing')?.value) || 0;
            esgData.governance.fairTradeViolations = parseFloat(document.getElementById('fairTradeViolations')?.value) || 0;
            esgData.governance.corruptionFines = parseFloat(document.getElementById('corruptionFines')?.value) || 0;
            esgData.governance.legalViolations = parseFloat(document.getElementById('legalViolations')?.value) || 0;
            // ì§€ë°°êµ¬ì¡°(G) - ì£¼ì£¼ê¶Œë¦¬/ë³´ìˆ˜
            esgData.governance.dividendPayout = parseFloat(document.getElementById('dividendPayout')?.value) || 0;
            esgData.governance.ceoPayRatio = parseFloat(document.getElementById('ceoPayRatio')?.value) || 0;
            esgData.governance.esgDisclosure = parseFloat(document.getElementById('esgDisclosure')?.value) || 0;

            updateDashboard();
            document.getElementById('saveMessage').classList.remove('hidden');
            setTimeout(() => document.getElementById('saveMessage').classList.add('hidden'), 2000);
        }

        // ==================== PDF/Excel ì—…ë¡œë“œ ë° ë°ì´í„° ì¶”ì¶œ ====================
        let extractedEsgData = null;

        async function handleFileUpload(event, fileType) {
            const file = event.target.files[0];
            if (!file) return;

            // ìƒíƒœ í‘œì‹œ
            document.getElementById('pdfUploadStatus').classList.remove('hidden');
            document.getElementById('pdfUploadSpinner').classList.remove('hidden');
            document.getElementById('extractedDataPreview').classList.add('hidden');
            document.getElementById('pdfUploadText').textContent = `"${file.name}" ë¶„ì„ ì¤‘...`;

            const formData = new FormData();
            formData.append('file', file);
            formData.append('type', fileType);

            try {
                const endpoint = fileType === 'excel' ? '/api/dashboard/excel/extract' : '/api/dashboard/pdf/extract';
                const response = await fetch(endpoint, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.success) {
                    extractedEsgData = result.data;
                    showExtractedData(result.data);
                    document.getElementById('pdfUploadSpinner').classList.add('hidden');
                    const sourceText = result.source === 'excel' ? 'ì—‘ì…€ì—ì„œ' : (result.source === 'ai' ? 'AIê°€' : 'ì‹œë®¬ë ˆì´ì…˜ìœ¼ë¡œ');
                    document.getElementById('pdfUploadText').innerHTML = `âœ“ ${sourceText} ë°ì´í„° ì¶”ì¶œ ì™„ë£Œ! ì•„ë˜ì—ì„œ í™•ì¸í•˜ì„¸ìš”.`;
                } else {
                    throw new Error(result.error || 'ì¶”ì¶œ ì‹¤íŒ¨');
                }
            } catch (error) {
                console.error('íŒŒì¼ ì¶”ì¶œ ì˜¤ë¥˜:', error);
                document.getElementById('pdfUploadSpinner').classList.add('hidden');
                document.getElementById('pdfUploadText').innerHTML = `âŒ ì˜¤ë¥˜: ${error.message}`;
            }
        }

        // ì—‘ì…€ í…œí”Œë¦¿ ë‹¤ìš´ë¡œë“œ (K-ESG ê°€ì´ë“œë¼ì¸ ê¸°ë°˜)
        function downloadExcelTemplate() {
            const csvContent = `ì¹´í…Œê³ ë¦¬,ì„¸ë¶€ë¶„ë¥˜,í•­ëª©,ê°’,ë‹¨ìœ„,K-ESG ì½”ë“œ,ì„¤ëª…
í™˜ê²½,í™˜ê²½ê²½ì˜ì²´ê³„,í™˜ê²½ê²½ì˜ ë°©ì¹¨ ìˆ˜ë¦½,FALSE,ì—¬ë¶€,E-1-1,í™˜ê²½ê²½ì˜ ë°©ì¹¨ ë° ì „ëµ ìˆ˜ë¦½ ì—¬ë¶€
í™˜ê²½,í™˜ê²½ê²½ì˜ì²´ê³„,í™˜ê²½ì „ë‹´ì¡°ì§ ìš´ì˜,FALSE,ì—¬ë¶€,E-1-2,í™˜ê²½ê²½ì˜ ì „ë‹´ ì¡°ì§ ì„¤ì¹˜ ì—¬ë¶€
í™˜ê²½,í™˜ê²½ê²½ì˜ì²´ê³„,í™˜ê²½ê²½ì˜ ì¸ì¦,FALSE,ì—¬ë¶€,E-1-3,ISO14001 ë“± í™˜ê²½ê²½ì˜ì‹œìŠ¤í…œ ì¸ì¦
í™˜ê²½,í™˜ê²½ê²½ì˜ì²´ê³„,í™˜ê²½ ëª©í‘œ ê³µê°œ,FALSE,ì—¬ë¶€,E-1-4,ì •ëŸ‰ì  í™˜ê²½ëª©í‘œ ì„¤ì • ë° ê³µê°œ
í™˜ê²½,ì˜¨ì‹¤ê°€ìŠ¤,Scope 1 ë°°ì¶œëŸ‰,0,tCO2e,E-2-1,ì§ì ‘ ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰
í™˜ê²½,ì˜¨ì‹¤ê°€ìŠ¤,Scope 2 ë°°ì¶œëŸ‰,0,tCO2e,E-2-2,ê°„ì ‘ ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰ (ì „ë ¥/ì—´)
í™˜ê²½,ì˜¨ì‹¤ê°€ìŠ¤,Scope 3 ë°°ì¶œëŸ‰,0,tCO2e,E-2-3,ê¸°íƒ€ ê°„ì ‘ ì˜¨ì‹¤ê°€ìŠ¤ ë°°ì¶œëŸ‰
í™˜ê²½,ì—ë„ˆì§€,ì´ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰,0,kWh,E-3-1,ì—°ê°„ ì´ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰
í™˜ê²½,ì—ë„ˆì§€,ì—ë„ˆì§€ ì§‘ì•½ë„,0,TJ/ì–µì›,E-3-2,ë§¤ì¶œì•¡ ëŒ€ë¹„ ì—ë„ˆì§€ ì‚¬ìš©ëŸ‰
í™˜ê²½,ì—ë„ˆì§€,ì¬ìƒì—ë„ˆì§€ ì‚¬ìš©ë¥ ,0,%,E-3-3,ì´ ì—ë„ˆì§€ ëŒ€ë¹„ ì¬ìƒì—ë„ˆì§€ ë¹„ìœ¨
í™˜ê²½,ìš©ìˆ˜,ìš©ìˆ˜ ì‚¬ìš©ëŸ‰,0,í†¤,E-4-1,ì—°ê°„ ìš©ìˆ˜ ì‚¬ìš©ëŸ‰
í™˜ê²½,ìš©ìˆ˜,ìš©ìˆ˜ ì¬ì´ìš©ë¥ ,0,%,E-4-2,ì´ ìš©ìˆ˜ ëŒ€ë¹„ ì¬ì´ìš© ë¹„ìœ¨
í™˜ê²½,íê¸°ë¬¼,íê¸°ë¬¼ ë°œìƒëŸ‰,0,í†¤,E-5-1,ì—°ê°„ ì´ íê¸°ë¬¼ ë°œìƒëŸ‰
í™˜ê²½,íê¸°ë¬¼,íê¸°ë¬¼ ì¬í™œìš©ë¥ ,0,%,E-5-2,ì´ íê¸°ë¬¼ ëŒ€ë¹„ ì¬í™œìš© ë¹„ìœ¨
í™˜ê²½,ì˜¤ì—¼ë¬¼ì§ˆ,ëŒ€ê¸°ì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œ,0,í†¤,E-6-1,ì—°ê°„ ëŒ€ê¸°ì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œëŸ‰
í™˜ê²½,ì˜¤ì—¼ë¬¼ì§ˆ,ìˆ˜ì§ˆì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œ,0,í†¤,E-6-2,ì—°ê°„ ìˆ˜ì§ˆì˜¤ì—¼ë¬¼ì§ˆ ë°°ì¶œëŸ‰
í™˜ê²½,í™˜ê²½ë¦¬ìŠ¤í¬,í™˜ê²½ë²•ê·œ ìœ„ë°˜,0,ê±´,E-7-1,ì—°ê°„ í™˜ê²½ë²•ê·œ ìœ„ë°˜ ê±´ìˆ˜
í™˜ê²½,í™˜ê²½ë¦¬ìŠ¤í¬,í™˜ê²½ ê´€ë ¨ ê³¼ì§•ê¸ˆ,0,ë§Œì›,E-7-2,í™˜ê²½ë²•ê·œ ìœ„ë°˜ ê³¼ì§•ê¸ˆ
í™˜ê²½,ì¹œí™˜ê²½,ì¹œí™˜ê²½ ì œí’ˆ ë¹„ìœ¨,0,%,E-8-1,ì „ì²´ ì œí’ˆ ëŒ€ë¹„ ì¹œí™˜ê²½ ì¸ì¦ ì œí’ˆ ë¹„ìœ¨
ì‚¬íšŒ,ê³ ìš©,ì´ ì„ì§ì› ìˆ˜,0,ëª…,S-1-1,ì •ê·œì§+ë¹„ì •ê·œì§ ì´ ì¸ì›
ì‚¬íšŒ,ê³ ìš©,ì •ê·œì§ ë¹„ìœ¨,0,%,S-1-2,ì „ì²´ ì§ì› ëŒ€ë¹„ ì •ê·œì§ ë¹„ìœ¨
ì‚¬íšŒ,ê³ ìš©,ì‹ ê·œ ì±„ìš©,0,ëª…,S-1-3,ì—°ê°„ ì‹ ê·œ ì±„ìš© ì¸ì›
ì‚¬íšŒ,ê³ ìš©,ì´ì§ë¥ ,0,%,S-1-4,ì—°ê°„ ìë°œì  ì´ì§ë¥ 
ì‚¬íšŒ,ê³ ìš©,í‰ê·  ê·¼ì†ì—°ìˆ˜,0,ë…„,S-1-5,ì „ì²´ ì§ì› í‰ê·  ê·¼ì†ì—°ìˆ˜
ì‚¬íšŒ,ê³ ìš©,í‰ê·  ê¸‰ì—¬,0,ë§Œì›,S-1-6,ì§ì› ì—°í‰ê·  ê¸‰ì—¬
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ì—¬ì„± ì„ì§ì› ë¹„ìœ¨,0,%,S-2-1,ì „ì²´ ì§ì› ëŒ€ë¹„ ì—¬ì„± ë¹„ìœ¨
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ì—¬ì„± ê´€ë¦¬ì ë¹„ìœ¨,0,%,S-2-2,ì „ì²´ ê´€ë¦¬ì ëŒ€ë¹„ ì—¬ì„± ë¹„ìœ¨
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ì¥ì• ì¸ ê³ ìš©ë¥ ,0,%,S-2-3,ì „ì²´ ì§ì› ëŒ€ë¹„ ì¥ì• ì¸ ë¹„ìœ¨
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ìœ¡ì•„íœ´ì§ ì‚¬ìš©ë¥ ,0,%,S-2-4,ëŒ€ìƒì ëŒ€ë¹„ ìœ¡ì•„íœ´ì§ ì‚¬ìš© ë¹„ìœ¨
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ìœ¡ì•„íœ´ì§ ë³µê·€ìœ¨,0,%,S-2-5,ìœ¡ì•„íœ´ì§ í›„ ë³µì§ ë¹„ìœ¨
ì‚¬íšŒ,ë‹¤ì–‘ì„±,ì™¸êµ­ì¸ ì§ì› ë¹„ìœ¨,0,%,S-2-6,ì „ì²´ ì§ì› ëŒ€ë¹„ ì™¸êµ­ì¸ ë¹„ìœ¨
ì‚¬íšŒ,êµìœ¡,ì¸ë‹¹ êµìœ¡ì‹œê°„,0,ì‹œê°„,S-3-1,ì—°ê°„ ì§ì› 1ì¸ë‹¹ í‰ê·  êµìœ¡ì‹œê°„
ì‚¬íšŒ,êµìœ¡,ì¸ë‹¹ êµìœ¡ë¹„,0,ë§Œì›,S-3-2,ì—°ê°„ ì§ì› 1ì¸ë‹¹ í‰ê·  êµìœ¡ë¹„
ì‚¬íšŒ,ì‚°ì—…ì•ˆì „,ì•ˆì „ë³´ê±´ êµìœ¡ë¥ ,0,%,S-4-1,ëŒ€ìƒì ëŒ€ë¹„ ì•ˆì „ë³´ê±´êµìœ¡ ì´ìˆ˜ìœ¨
ì‚¬íšŒ,ì‚°ì—…ì•ˆì „,ì‚°ì—…ì¬í•´ ê±´ìˆ˜,0,ê±´,S-4-2,ì—°ê°„ ì‚°ì—…ì¬í•´ ë°œìƒ ê±´ìˆ˜
ì‚¬íšŒ,ì‚°ì—…ì•ˆì „,ê·¼ë¡œì†ì‹¤ì¬í•´ìœ¨,0,%,S-4-3,LTIR(Lost Time Injury Rate)
ì‚¬íšŒ,ì‚°ì—…ì•ˆì „,ì‚¬ë§ì‚¬ê³ ,0,ê±´,S-4-4,ì—°ê°„ ì—…ë¬´ìƒ ì‚¬ë§ì‚¬ê³  ê±´ìˆ˜
ì‚¬íšŒ,ê³µê¸‰ë§,í˜‘ë ¥ì‚¬ ESG í‰ê°€ìœ¨,0,%,S-5-1,ì „ì²´ í˜‘ë ¥ì‚¬ ëŒ€ë¹„ ESG í‰ê°€ ë¹„ìœ¨
ì‚¬íšŒ,ê³ ê°,ê³ ê°ë§Œì¡±ë„,0,ì ,S-6-1,ê³ ê°ë§Œì¡±ë„ ì¡°ì‚¬ ì ìˆ˜
ì‚¬íšŒ,ì •ë³´ë³´í˜¸,ê°œì¸ì •ë³´ ì¹¨í•´,0,ê±´,S-7-1,ì—°ê°„ ê°œì¸ì •ë³´ ì¹¨í•´ ê±´ìˆ˜
ì‚¬íšŒ,ì •ë³´ë³´í˜¸,ì •ë³´ë³´ì•ˆ ì‚¬ê³ ,0,ê±´,S-7-2,ì—°ê°„ ì •ë³´ë³´ì•ˆ ì‚¬ê³  ê±´ìˆ˜
ì‚¬íšŒ,ì‚¬íšŒê³µí—Œ,ì‚¬íšŒê³µí—Œ íˆ¬ì,0,ë§Œì›,S-8-1,ì—°ê°„ ì‚¬íšŒê³µí—Œ íˆ¬ìê¸ˆì•¡
ì‚¬íšŒ,ì‚¬íšŒê³µí—Œ,ë´‰ì‚¬í™œë™ ì°¸ì—¬ìœ¨,0,%,S-8-2,ì „ì²´ ì§ì› ëŒ€ë¹„ ë´‰ì‚¬í™œë™ ì°¸ì—¬ ë¹„ìœ¨
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì´ì‚¬íšŒ ê·œëª¨,0,ëª…,G-1-1,ì´ì‚¬íšŒ êµ¬ì„± ì¸ì›ìˆ˜
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨,0,%,G-1-2,ì „ì²´ ì´ì‚¬ ëŒ€ë¹„ ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì—¬ì„± ì´ì‚¬ ë¹„ìœ¨,0,%,G-1-3,ì „ì²´ ì´ì‚¬ ëŒ€ë¹„ ì—¬ì„± ì´ì‚¬ ë¹„ìœ¨
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì´ì‚¬íšŒ ê°œìµœ íšŸìˆ˜,0,íšŒ,G-1-4,ì—°ê°„ ì´ì‚¬íšŒ ê°œìµœ íšŸìˆ˜
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì´ì‚¬íšŒ ì¶œì„ë¥ ,0,%,G-1-5,ì´ì‚¬íšŒ í‰ê·  ì¶œì„ë¥ 
ì§€ë°°êµ¬ì¡°,ì´ì‚¬íšŒ,ì‚¬ì™¸ì´ì‚¬ ì „ë¬¸ì„±,0,ë¶„ì•¼,G-1-6,ì‚¬ì™¸ì´ì‚¬ ì „ë¬¸ë¶„ì•¼ ë‹¤ì–‘ì„±
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ê°ì‚¬ìœ„ì›íšŒ ì„¤ì¹˜,FALSE,ì—¬ë¶€,G-2-1,ê°ì‚¬ìœ„ì›íšŒ ì„¤ì¹˜ ì—¬ë¶€
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ESG ìœ„ì›íšŒ ì„¤ì¹˜,FALSE,ì—¬ë¶€,G-2-2,ESG/ì§€ì†ê°€ëŠ¥ê²½ì˜ ìœ„ì›íšŒ ì„¤ì¹˜
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ì‚¬ì™¸ì´ì‚¬í›„ë³´ì¶”ì²œìœ„ì›íšŒ,FALSE,ì—¬ë¶€,G-2-3,ì‚¬ì™¸ì´ì‚¬í›„ë³´ì¶”ì²œìœ„ì›íšŒ ì„¤ì¹˜
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ë³´ìƒìœ„ì›íšŒ ì„¤ì¹˜,FALSE,ì—¬ë¶€,G-2-4,ë³´ìƒìœ„ì›íšŒ ì„¤ì¹˜ ì—¬ë¶€
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ë¦¬ìŠ¤í¬ê´€ë¦¬ìœ„ì›íšŒ,FALSE,ì—¬ë¶€,G-2-5,ë¦¬ìŠ¤í¬ê´€ë¦¬ìœ„ì›íšŒ ì„¤ì¹˜
ì§€ë°°êµ¬ì¡°,ìœ„ì›íšŒ,ë‚´ë¶€ê°ì‚¬ë¶€ì„œ,FALSE,ì—¬ë¶€,G-2-6,ë‚´ë¶€ê°ì‚¬ ì „ë‹´ë¶€ì„œ ìš´ì˜
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ìœ¤ë¦¬ê·œì • ìœ„ë°˜,0,ê±´,G-3-1,ì—°ê°„ ìœ¤ë¦¬ê·œì • ìœ„ë°˜ ê±´ìˆ˜
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ë°˜ë¶€íŒ¨ êµìœ¡ ì´ìˆ˜ìœ¨,0,%,G-3-2,ëŒ€ìƒì ëŒ€ë¹„ ë°˜ë¶€íŒ¨ êµìœ¡ ì´ìˆ˜ìœ¨
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ë‚´ë¶€ê³ ë°œ ì ‘ìˆ˜,0,ê±´,G-3-3,ì—°ê°„ ë‚´ë¶€ê³ ë°œ ì ‘ìˆ˜ ê±´ìˆ˜
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ê³µì •ê±°ë˜ ìœ„ë°˜,0,ê±´,G-3-4,ì—°ê°„ ê³µì •ê±°ë˜ë²• ìœ„ë°˜ ê±´ìˆ˜
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ë¶€íŒ¨ ê´€ë ¨ ê³¼ì§•ê¸ˆ,0,ë§Œì›,G-3-5,ë¶€íŒ¨/ë°˜ë…ì  ê´€ë ¨ ê³¼ì§•ê¸ˆ
ì§€ë°°êµ¬ì¡°,ìœ¤ë¦¬ê²½ì˜,ë²•ê·œ ìœ„ë°˜ ê±´ìˆ˜,0,ê±´,G-3-6,ì—°ê°„ ë²•ê·œ ìœ„ë°˜ ì´ ê±´ìˆ˜
ì§€ë°°êµ¬ì¡°,ì£¼ì£¼ê¶Œë¦¬,ë°°ë‹¹ì„±í–¥,0,%,G-4-1,ë‹¹ê¸°ìˆœì´ìµ ëŒ€ë¹„ ë°°ë‹¹ê¸ˆ ë¹„ìœ¨
ì§€ë°°êµ¬ì¡°,ì£¼ì£¼ê¶Œë¦¬,CEO ë³´ìˆ˜ë¹„ìœ¨,0,ë°°,G-4-2,ì§ì› í‰ê·  ëŒ€ë¹„ CEO ë³´ìˆ˜ ë¹„ìœ¨
ì§€ë°°êµ¬ì¡°,ì •ë³´ê³µì‹œ,ESG ì •ë³´ê³µê°œ ìˆ˜ì¤€,0,%,G-5-1,GRI ë“± ê¸€ë¡œë²Œ ê¸°ì¤€ ì •ë³´ê³µê°œìœ¨`;

            const BOM = '\uFEFF';
            const blob = new Blob([BOM + csvContent], { type: 'text/csv;charset=utf-8;' });
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'K-ESG_ë°ì´í„°_ì…ë ¥_í…œí”Œë¦¿.csv';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            URL.revokeObjectURL(url);
        }

        function showExtractedData(data) {
            const preview = document.getElementById('extractedDataPreview');
            const content = document.getElementById('extractedDataContent');
            
            const scope1 = data.environment?.scope1Emission || 0;
            const scope2 = data.environment?.scope2Emission || 0;
            const totalCarbon = scope1 + scope2;
            
            content.innerHTML = `
                <div class="p-2 bg-green-50 rounded">
                    <span class="text-green-600 text-xs font-medium">í™˜ê²½ (E)</span>
                    <div class="text-xs mt-1 space-y-0.5">
                        <div>Scope1+2: ${totalCarbon || '-'}tCOâ‚‚e</div>
                        <div>ì¬ìƒì—ë„ˆì§€: ${data.environment?.renewableEnergy || '-'}%</div>
                        <div>íê¸°ë¬¼ ì¬í™œìš©: ${data.environment?.wasteRecycling || '-'}%</div>
                        <div>ìš©ìˆ˜ ì¬ì´ìš©: ${data.environment?.waterRecycling || '-'}%</div>
                    </div>
                </div>
                <div class="p-2 bg-blue-50 rounded">
                    <span class="text-blue-600 text-xs font-medium">ì‚¬íšŒ (S)</span>
                    <div class="text-xs mt-1 space-y-0.5">
                        <div>ì§ì›: ${data.social?.employeeCount || '-'}ëª…</div>
                        <div>ì—¬ì„±ê´€ë¦¬ì: ${data.social?.femaleManagerRatio || '-'}%</div>
                        <div>êµìœ¡ì‹œê°„: ${data.social?.trainingHours || '-'}ì‹œê°„</div>
                        <div>ì‚°ì¬: ${data.social?.industrialAccidents ?? '-'}ê±´</div>
                    </div>
                </div>
                <div class="p-2 bg-purple-50 rounded">
                    <span class="text-purple-600 text-xs font-medium">ì§€ë°°êµ¬ì¡° (G)</span>
                    <div class="text-xs mt-1 space-y-0.5">
                        <div>ì‚¬ì™¸ì´ì‚¬: ${data.governance?.boardIndependence || '-'}%</div>
                        <div>ì—¬ì„±ì´ì‚¬: ${data.governance?.femaleBoardRatio || '-'}%</div>
                        <div>ë°˜ë¶€íŒ¨êµìœ¡: ${data.governance?.antiCorruptionTraining || '-'}%</div>
                        <div>ESGìœ„ì›íšŒ: ${data.governance?.esgCommittee ? 'ìˆìŒ' : 'ì—†ìŒ'}</div>
                    </div>
                </div>
            `;
            
            preview.classList.remove('hidden');
        }

        function applyExtractedData() {
            if (!extractedEsgData) return;

            // í™˜ê²½(E) ë°ì´í„° ì ìš©
            if (extractedEsgData.environment) {
                const env = extractedEsgData.environment;
                // ì²´í¬ë°•ìŠ¤
                if (env.envPolicy !== undefined) document.getElementById('envPolicy').checked = env.envPolicy;
                if (env.envOrganization !== undefined) document.getElementById('envOrganization').checked = env.envOrganization;
                if (env.envCertification !== undefined) document.getElementById('envCertification').checked = env.envCertification;
                if (env.envTarget !== undefined) document.getElementById('envTarget').checked = env.envTarget;
                // ìˆ«ì
                if (env.scope1Emission) document.getElementById('scope1Emission').value = env.scope1Emission;
                if (env.scope2Emission) document.getElementById('scope2Emission').value = env.scope2Emission;
                if (env.scope3Emission) document.getElementById('scope3Emission').value = env.scope3Emission;
                if (env.energyUsage) document.getElementById('energyUsage').value = env.energyUsage;
                if (env.energyIntensity) document.getElementById('energyIntensity').value = env.energyIntensity;
                if (env.renewableEnergy) document.getElementById('renewableEnergy').value = env.renewableEnergy;
                if (env.waterUsage) document.getElementById('waterUsage').value = env.waterUsage;
                if (env.waterRecycling) document.getElementById('waterRecycling').value = env.waterRecycling;
                if (env.wasteGeneration) document.getElementById('wasteGeneration').value = env.wasteGeneration;
                if (env.wasteRecycling) document.getElementById('wasteRecycling').value = env.wasteRecycling;
                if (env.airPollution) document.getElementById('airPollution').value = env.airPollution;
                if (env.waterPollution) document.getElementById('waterPollution').value = env.waterPollution;
                if (env.envViolations !== undefined) document.getElementById('envViolations').value = env.envViolations;
                if (env.envFines !== undefined) document.getElementById('envFines').value = env.envFines;
                if (env.greenProduct) document.getElementById('greenProduct').value = env.greenProduct;
            }

            // ì‚¬íšŒ(S) ë°ì´í„° ì ìš©
            if (extractedEsgData.social) {
                const soc = extractedEsgData.social;
                if (soc.employeeCount) document.getElementById('employeeCount').value = soc.employeeCount;
                if (soc.permanentRatio) document.getElementById('permanentRatio').value = soc.permanentRatio;
                if (soc.newHires) document.getElementById('newHires').value = soc.newHires;
                if (soc.turnoverRate) document.getElementById('turnoverRate').value = soc.turnoverRate;
                if (soc.avgTenure) document.getElementById('avgTenure').value = soc.avgTenure;
                if (soc.avgSalary) document.getElementById('avgSalary').value = soc.avgSalary;
                if (soc.femaleRatio) document.getElementById('femaleRatio').value = soc.femaleRatio;
                if (soc.femaleManagerRatio) document.getElementById('femaleManagerRatio').value = soc.femaleManagerRatio;
                if (soc.disabledRatio) document.getElementById('disabledRatio').value = soc.disabledRatio;
                if (soc.parentalLeaveRate) document.getElementById('parentalLeaveRate').value = soc.parentalLeaveRate;
                if (soc.parentalReturnRate) document.getElementById('parentalReturnRate').value = soc.parentalReturnRate;
                if (soc.foreignRatio) document.getElementById('foreignRatio').value = soc.foreignRatio;
                if (soc.trainingHours) document.getElementById('trainingHours').value = soc.trainingHours;
                if (soc.trainingCost) document.getElementById('trainingCost').value = soc.trainingCost;
                if (soc.safetyTrainingRate) document.getElementById('safetyTrainingRate').value = soc.safetyTrainingRate;
                if (soc.industrialAccidents !== undefined) document.getElementById('industrialAccidents').value = soc.industrialAccidents;
                if (soc.ltir) document.getElementById('ltir').value = soc.ltir;
                if (soc.fatalAccidents !== undefined) document.getElementById('fatalAccidents').value = soc.fatalAccidents;
                if (soc.supplierEsgRate) document.getElementById('supplierEsgRate').value = soc.supplierEsgRate;
                if (soc.customerSatisfaction) document.getElementById('customerSatisfaction').value = soc.customerSatisfaction;
                if (soc.privacyBreaches !== undefined) document.getElementById('privacyBreaches').value = soc.privacyBreaches;
                if (soc.securityIncidents !== undefined) document.getElementById('securityIncidents').value = soc.securityIncidents;
                if (soc.socialInvestment) document.getElementById('socialInvestment').value = soc.socialInvestment;
                if (soc.volunteerRate) document.getElementById('volunteerRate').value = soc.volunteerRate;
            }

            // ì§€ë°°êµ¬ì¡°(G) ë°ì´í„° ì ìš©
            if (extractedEsgData.governance) {
                const gov = extractedEsgData.governance;
                if (gov.boardSize) document.getElementById('boardSize').value = gov.boardSize;
                if (gov.boardIndependence) document.getElementById('boardIndependence').value = gov.boardIndependence;
                if (gov.femaleBoardRatio) document.getElementById('femaleBoardRatio').value = gov.femaleBoardRatio;
                if (gov.boardMeetings) document.getElementById('boardMeetings').value = gov.boardMeetings;
                if (gov.boardAttendance) document.getElementById('boardAttendance').value = gov.boardAttendance;
                if (gov.boardExpertise) document.getElementById('boardExpertise').value = gov.boardExpertise;
                // ìœ„ì›íšŒ ì²´í¬ë°•ìŠ¤
                if (gov.auditCommittee !== undefined) document.getElementById('auditCommittee').checked = gov.auditCommittee;
                if (gov.esgCommittee !== undefined) document.getElementById('esgCommittee').checked = gov.esgCommittee;
                if (gov.nominationCommittee !== undefined) document.getElementById('nominationCommittee').checked = gov.nominationCommittee;
                if (gov.compensationCommittee !== undefined) document.getElementById('compensationCommittee').checked = gov.compensationCommittee;
                if (gov.riskCommittee !== undefined) document.getElementById('riskCommittee').checked = gov.riskCommittee;
                if (gov.internalAudit !== undefined) document.getElementById('internalAudit').checked = gov.internalAudit;
                // ìœ¤ë¦¬ê²½ì˜
                if (gov.ethicsViolations !== undefined) document.getElementById('ethicsViolations').value = gov.ethicsViolations;
                if (gov.antiCorruptionTraining) document.getElementById('antiCorruptionTraining').value = gov.antiCorruptionTraining;
                if (gov.whistleblowing !== undefined) document.getElementById('whistleblowing').value = gov.whistleblowing;
                if (gov.fairTradeViolations !== undefined) document.getElementById('fairTradeViolations').value = gov.fairTradeViolations;
                if (gov.corruptionFines !== undefined) document.getElementById('corruptionFines').value = gov.corruptionFines;
                if (gov.legalViolations !== undefined) document.getElementById('legalViolations').value = gov.legalViolations;
                // ì£¼ì£¼ê¶Œë¦¬
                if (gov.dividendPayout) document.getElementById('dividendPayout').value = gov.dividendPayout;
                if (gov.ceoPayRatio) document.getElementById('ceoPayRatio').value = gov.ceoPayRatio;
                if (gov.esgDisclosure) document.getElementById('esgDisclosure').value = gov.esgDisclosure;
            }

            // ìë™ ì €ì¥
            saveData();
            
            // í”¼ë“œë°±
            document.getElementById('extractedDataPreview').innerHTML = `
                <div class="flex items-center gap-2 text-emerald-700">
                    <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    <span class="font-medium">K-ESG ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ì ìš©ë˜ì—ˆìŠµë‹ˆë‹¤!</span>
                </div>
            `;
        }

        function useSampleEsgData() {
            // K-ESG ê°€ì´ë“œë¼ì¸ ê¸°ë°˜ ìƒ˜í”Œ ë°ì´í„° (ì¤‘ê²¬ê¸°ì—… ìˆ˜ì¤€)
            extractedEsgData = {
                environment: {
                    envPolicy: true, envOrganization: true, envCertification: true, envTarget: true,
                    scope1Emission: 520, scope2Emission: 980, scope3Emission: 2450,
                    energyUsage: 2850000, energyIntensity: 0.72, renewableEnergy: 28,
                    waterUsage: 125000, waterRecycling: 35, wasteGeneration: 920, wasteRecycling: 78,
                    airPollution: 8.5, waterPollution: 5.2,
                    envViolations: 0, envFines: 0, greenProduct: 42
                },
                social: {
                    employeeCount: 320, permanentRatio: 88, newHires: 45,
                    turnoverRate: 6.8, avgTenure: 6.5, avgSalary: 5800,
                    femaleRatio: 38, femaleManagerRatio: 28, disabledRatio: 3.5,
                    parentalLeaveRate: 82, parentalReturnRate: 95, foreignRatio: 8,
                    trainingHours: 52, trainingCost: 150, safetyTrainingRate: 100,
                    industrialAccidents: 1, ltir: 0.32, fatalAccidents: 0,
                    supplierEsgRate: 65, customerSatisfaction: 88, privacyBreaches: 0,
                    securityIncidents: 0, socialInvestment: 8500, volunteerRate: 35
                },
                governance: {
                    boardSize: 9, boardIndependence: 55, femaleBoardRatio: 22,
                    boardMeetings: 14, boardAttendance: 96, boardExpertise: 4,
                    auditCommittee: true, esgCommittee: true, nominationCommittee: true,
                    compensationCommittee: false, riskCommittee: true, internalAudit: true,
                    ethicsViolations: 0, antiCorruptionTraining: 95, whistleblowing: 2,
                    fairTradeViolations: 0, corruptionFines: 0, legalViolations: 0,
                    dividendPayout: 35, ceoPayRatio: 12, esgDisclosure: 82
                }
            };

            showExtractedData(extractedEsgData);
            
            document.getElementById('pdfUploadStatus').classList.remove('hidden');
            document.getElementById('pdfUploadSpinner').classList.add('hidden');
            document.getElementById('pdfUploadText').innerHTML = 'âœ“ K-ESG ìƒ˜í”Œ ë°ì´í„°ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. "ë°ì´í„° ì ìš©" ë²„íŠ¼ì„ í´ë¦­í•˜ì„¸ìš”.';
        }

        function saveSettings() {
            const companyName = document.getElementById('companyName').value;
            document.getElementById('companyNameDisplay').textContent = companyName;
            document.getElementById('companyInitial').textContent = companyName.charAt(0);
            document.getElementById('industryDisplay').textContent = document.getElementById('industry').value;
            document.getElementById('sizeDisplay').textContent = document.getElementById('companySize').value;

            document.getElementById('settingsSaveMessage').classList.remove('hidden');
            setTimeout(() => document.getElementById('settingsSaveMessage').classList.add('hidden'), 2000);
        }

        // ==================== ì™¸ë¶€ API ì—°ë™ í•¨ìˆ˜ë“¤ ====================
        
        // API ìƒíƒœ í™•ì¸
        async function checkApiStatus() {
            try {
                const response = await fetch('/api/external/status');
                const data = await response.json();
                
                if (data.success) {
                    // ì„¤ì • í˜ì´ì§€ UI
                    updateApiStatusUI('dataGoKr', data.apis.dataGoKr);
                    updateApiStatusUI('dart', data.apis.dart);
                    updateApiStatusUI('kosis', data.apis.kosis);
                    updateApiStatusUI('carbonInterface', data.apis.carbonInterface);
                    updateApiStatusUI('googleSheets', data.apis.googleSheets);
                    
                    // ë°ì´í„° ì—°ë™ í˜ì´ì§€ UI
                    updateApiStatusBadge('dataGoKr', data.apis.dataGoKr);
                    updateApiStatusBadge('dart', data.apis.dart);
                    updateApiStatusBadge('kosis', data.apis.kosis);
                    updateApiStatusBadge('carbonInterface', data.apis.carbonInterface);
                    updateApiStatusBadge('googleSheets', data.apis.googleSheets);
                }
            } catch (error) {
                console.error('API ìƒíƒœ í™•ì¸ ì˜¤ë¥˜:', error);
            }
        }

        function updateApiStatusBadge(apiName, isConnected) {
            const element = document.getElementById(`api-status-${apiName}`);
            if (element) {
                if (isConnected) {
                    element.textContent = 'ì—°ê²°ë¨';
                    element.className = 'px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-700';
                } else {
                    element.textContent = 'ë¯¸ì—°ê²°';
                    element.className = 'px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600';
                }
            }
        }

        // ë°ì´í„° ìˆ˜ì§‘ ë¡œê·¸ ì¶”ê°€
        function addDataLog(message, type = 'info') {
            const logContainer = document.getElementById('dataCollectionLog');
            if (!logContainer) return;
            
            // ì²« ë¡œê·¸ë©´ ì•ˆë‚´ ë©”ì‹œì§€ ì œê±°
            if (logContainer.querySelector('.text-navy-400')) {
                logContainer.innerHTML = '';
            }
            
            const colors = {
                success: 'bg-emerald-50 border-emerald-200 text-emerald-700',
                error: 'bg-red-50 border-red-200 text-red-700',
                info: 'bg-blue-50 border-blue-200 text-blue-700'
            };
            
            const icons = {
                success: 'âœ…',
                error: 'âŒ',
                info: 'â„¹ï¸'
            };
            
            const time = new Date().toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            
            const logItem = document.createElement('div');
            logItem.className = `p-3 rounded-lg border ${colors[type]} text-sm flex items-center gap-2`;
            logItem.innerHTML = `
                <span>${icons[type]}</span>
                <span class="flex-1">${message}</span>
                <span class="text-xs opacity-60">${time}</span>
            `;
            
            logContainer.insertBefore(logItem, logContainer.firstChild);
            
            // ìµœëŒ€ 10ê°œê¹Œì§€ë§Œ ìœ ì§€
            while (logContainer.children.length > 10) {
                logContainer.removeChild(logContainer.lastChild);
            }
        }

        function updateApiStatusUI(apiName, isConnected) {
            const element = document.getElementById(`api-${apiName}`);
            if (element) {
                if (isConnected) {
                    element.textContent = 'ì—°ê²°ë¨';
                    element.className = 'px-2 py-1 text-xs font-medium rounded-full bg-emerald-100 text-emerald-700';
                } else {
                    element.textContent = 'ë¯¸ì—°ê²°';
                    element.className = 'px-2 py-1 text-xs font-medium rounded-full bg-gray-200 text-gray-600';
                }
            }
        }

        // DART ê¸°ì—…ì •ë³´ ê°€ì ¸ì˜¤ê¸°
        async function fetchDartCompanyInfo() {
            const corpCode = prompt('DART ê¸°ì—…ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 00126380 - ì‚¼ì„±ì „ì):');
            if (!corpCode) return;

            try {
                addDataLog('DART ê¸°ì—…ì •ë³´ ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch(`/api/external/dart/company?corpCode=${corpCode}`);
                const data = await response.json();

                if (data.success) {
                    addDataLog(`DART ê¸°ì—…ì •ë³´: ${data.data.corpName} ì¡°íšŒ ì™„ë£Œ`, 'success');
                    alert(`âœ… ê¸°ì—…ì •ë³´ ì¡°íšŒ ì„±ê³µ!\n\níšŒì‚¬ëª…: ${data.data.corpName}\nCEO: ${data.data.ceoName}\nì£¼ì†Œ: ${data.data.address}\nì„¤ë¦½ì¼: ${data.data.establishDate}`);
                    
                    // ì„¤ì •ì— ìë™ ë°˜ì˜
                    if (data.data.corpName) {
                        document.getElementById('companyName').value = data.data.corpName;
                    }
                } else {
                    addDataLog('DART ê¸°ì—…ì •ë³´ ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('DART API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // íƒ„ì†Œë°°ì¶œëŸ‰ ìë™ ê³„ì‚°
        async function calculateCarbonEmissions() {
            // í˜„ì¬ ESG ë°ì´í„°ì—ì„œ ì „ë ¥ ì‚¬ìš©ëŸ‰ ê°€ì ¸ì˜¤ê¸°
            const electricityKwh = esgData.environment.energyUsage || 0;
            
            if (electricityKwh === 0) {
                alert('ë¨¼ì € ë°ì´í„° ì…ë ¥ì—ì„œ ì „ë ¥ ì‚¬ìš©ëŸ‰ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }

            addDataLog('Scope 2 íƒ„ì†Œë°°ì¶œëŸ‰ ê³„ì‚° ì¤‘...', 'info');

            // í•œêµ­ ì „ë ¥ ë°°ì¶œê³„ìˆ˜ (2024ë…„ ê¸°ì¤€: 0.4594 kgCO2/kWh)
            const emissionFactor = 0.4594;
            const year = new Date().getFullYear();
            const scope2Emissions = Math.round((electricityKwh * emissionFactor) / 1000 * 100) / 100; // tCO2e

            addDataLog(`Scope 2 ë°°ì¶œëŸ‰: ${scope2Emissions} tCO2e`, 'success');
            
            alert(`ğŸŒ Scope 2 ë°°ì¶œëŸ‰ ê³„ì‚° ì™„ë£Œ!\n\nì „ë ¥ ì‚¬ìš©ëŸ‰: ${electricityKwh.toLocaleString()} kWh\në°°ì¶œê³„ìˆ˜: ${emissionFactor} kgCO2/kWh (${year}ë…„)\nScope 2 ë°°ì¶œëŸ‰: ${scope2Emissions} tCO2e`);
            
            // ESG ë°ì´í„°ì— ìë™ ë°˜ì˜
            esgData.environment.scope2Emission = scope2Emissions;
            const scope2Input = document.getElementById('scope2Emission');
            if (scope2Input) {
                scope2Input.value = scope2Emissions;
            }
        }

        // ê¸°ìƒ ë°ì´í„° ì¡°íšŒ
        async function fetchWeatherData() {
            try {
                addDataLog('ê¸°ìƒì²­ ë°ì´í„° ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch('/api/external/weather');
                const data = await response.json();

                if (data.success) {
                    const weather = data.data;
                    addDataLog('ê¸°ìƒ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ', 'success');
                    alert(`ğŸŒ¤ï¸ í˜„ì¬ ê¸°ìƒ ì •ë³´ (ì„œìš¸ ê¸°ì¤€)\n\nê¸°ì˜¨: ${weather.temperature || '-'}Â°C\nìŠµë„: ${weather.humidity || '-'}%\ní’ì†: ${weather.windSpeed || '-'} m/s\nê°•ìˆ˜: ${weather.precipitation || 'ì—†ìŒ'}\n\nâ€» ê¸°í›„ ë¦¬ìŠ¤í¬ ë¶„ì„ì— í™œìš©ë©ë‹ˆë‹¤.`);
                } else {
                    addDataLog('ê¸°ìƒ ë°ì´í„° ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error + '\n\n' + (data.guide || ''));
                }
            } catch (error) {
                addDataLog('ê¸°ìƒì²­ API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // ì—…ì¢… ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„° (KOSIS)
        async function fetchBenchmarkData() {
            try {
                addDataLog('KOSIS í†µê³„ ë°ì´í„° ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch('/api/external/kosis/employment');
                const data = await response.json();

                if (data.success) {
                    addDataLog('KOSIS ë²¤ì¹˜ë§ˆí‚¹ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ', 'success');
                    alert('ğŸ“ˆ í†µê³„ì²­ ë°ì´í„° ì¡°íšŒ ì™„ë£Œ!\n\nì‚°ì—…ë³„ ê³ ìš© í†µê³„ ë°ì´í„°ë¥¼ ê°€ì ¸ì™”ìŠµë‹ˆë‹¤.\nì½˜ì†”ì—ì„œ ìƒì„¸ ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                    console.log('KOSIS ë°ì´í„°:', data.data);
                } else {
                    addDataLog('KOSIS ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error + '\n\n' + (data.guide || ''));
                }
            } catch (error) {
                addDataLog('KOSIS API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // Carbon Interfaceë¡œ ìƒì„¸ íƒ„ì†Œ ê³„ì‚°
        async function calculateDetailedCarbon(type, inputData) {
            try {
                const response = await fetch('/api/external/carbon/estimate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, data: inputData })
                });

                const data = await response.json();
                return data;
            } catch (error) {
                console.error('Carbon Interface ì˜¤ë¥˜:', error);
                return { success: false, error: error.message };
            }
        }

        // Google Sheets ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
        async function fetchGoogleSheetsData() {
            const spreadsheetId = prompt('Google Sheets IDë¥¼ ì…ë ¥í•˜ì„¸ìš”:');
            if (!spreadsheetId) return;

            const range = prompt('ë²”ìœ„ë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: Sheet1!A1:Z100):', 'Sheet1!A1:Z100');
            if (!range) return;

            try {
                addDataLog('Google Sheets ë°ì´í„° ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch(`/api/external/sheets/read?spreadsheetId=${spreadsheetId}&range=${encodeURIComponent(range)}`);
                const data = await response.json();

                if (data.success) {
                    addDataLog(`Google Sheets: ${data.data.rowCount}ê°œ í–‰ ì¡°íšŒ ì™„ë£Œ`, 'success');
                    alert(`âœ… ìŠ¤í”„ë ˆë“œì‹œíŠ¸ ë°ì´í„° ì¡°íšŒ ì„±ê³µ!\n\në²”ìœ„: ${data.data.range}\ní–‰ ìˆ˜: ${data.data.rowCount}\n\nì½˜ì†”ì—ì„œ ìƒì„¸ ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.`);
                    console.log('Google Sheets ë°ì´í„°:', data.data.values);
                } else {
                    addDataLog('Google Sheets ì¡°íšŒ ì‹¤íŒ¨: ' + data.error, 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('Google Sheets API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // DART ì¬ë¬´ì œí‘œ ì¡°íšŒ
        async function fetchDartFinancial() {
            const corpCode = prompt('DART ê¸°ì—…ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 00126380):');
            if (!corpCode) return;

            try {
                addDataLog('DART ì¬ë¬´ì œí‘œ ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch(`/api/external/dart/financial?corpCode=${corpCode}`);
                const data = await response.json();

                if (data.success) {
                    const fin = data.data;
                    addDataLog('DART ì¬ë¬´ì œí‘œ ì¡°íšŒ ì™„ë£Œ', 'success');
                    alert(
                        `ğŸ“Š ì¬ë¬´ì œí‘œ ì¡°íšŒ ê²°ê³¼\n\n` +
                        `ë§¤ì¶œì•¡: ${fin.revenue || '-'}\n` +
                        `ì˜ì—…ì´ìµ: ${fin.operatingProfit || '-'}\n` +
                        `ë‹¹ê¸°ìˆœì´ìµ: ${fin.netIncome || '-'}\n` +
                        `ìì‚°ì´ê³„: ${fin.totalAssets || '-'}\n` +
                        `ìë³¸ì´ê³„: ${fin.totalEquity || '-'}`
                    );
                    console.log('DART ì¬ë¬´ì œí‘œ:', data);
                } else {
                    addDataLog('DART ì¬ë¬´ì œí‘œ ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('DART API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // DART ì„ì›í˜„í™© ì¡°íšŒ
        async function fetchDartExecutives() {
            const corpCode = prompt('DART ê¸°ì—…ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì˜ˆ: 00126380):');
            if (!corpCode) return;

            try {
                addDataLog('DART ì„ì›í˜„í™© ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch(`/api/external/dart/executives?corpCode=${corpCode}`);
                const data = await response.json();

                if (data.success) {
                    const board = data.data;
                    addDataLog(`DART ì„ì›í˜„í™©: ${board.totalExecutives}ëª… ì¡°íšŒ`, 'success');
                    alert(
                        `ğŸ‘¥ ì„ì›í˜„í™© ì¡°íšŒ ê²°ê³¼\n\n` +
                        `ì´ ì„ì›ìˆ˜: ${board.totalExecutives}ëª…\n` +
                        `ì‚¬ë‚´ì´ì‚¬: ${board.insideDirectors}ëª…\n` +
                        `ì‚¬ì™¸ì´ì‚¬: ${board.outsideDirectors}ëª…\n` +
                        `ì‚¬ì™¸ì´ì‚¬ ë¹„ìœ¨: ${board.outsideDirectorRatio}%\n\n` +
                        `â€» ESG ì§€ë°°êµ¬ì¡° í‰ê°€ì— í™œìš©ë©ë‹ˆë‹¤.`
                    );
                    console.log('DART ì„ì›í˜„í™©:', data);
                } else {
                    addDataLog('DART ì„ì›í˜„í™© ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('DART API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ
        async function fetchAccidentStats() {
            try {
                addDataLog('ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ ì¤‘...', 'info');
                const response = await fetch('/api/external/moel/accident');
                const data = await response.json();

                if (data.success) {
                    addDataLog('ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ ì™„ë£Œ', 'success');
                    alert('ğŸ¦º ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ ì™„ë£Œ!\n\nì½˜ì†”ì—ì„œ ìƒì„¸ ë°ì´í„°ë¥¼ í™•ì¸í•˜ì„¸ìš”.');
                    console.log('ì‚°ì—…ì¬í•´ í†µê³„:', data.data);
                } else {
                    addDataLog('ì‚°ì—…ì¬í•´ í†µê³„ ì¡°íšŒ ì‹¤íŒ¨', 'error');
                    alert('âŒ ì¡°íšŒ ì‹¤íŒ¨: ' + data.error + '\n\n' + (data.guide || ''));
                }
            } catch (error) {
                addDataLog('ê³ ìš©ë…¸ë™ë¶€ API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // ìƒì„¸ íƒ„ì†Œ ë°œìêµ­ ê³„ì‚° UI
        async function calculateDetailedCarbonUI() {
            const type = prompt(
                'íƒ„ì†Œ ê³„ì‚° ìœ í˜•ì„ ì„ íƒí•˜ì„¸ìš”:\n\n' +
                '1. electricity - ì „ê¸° ì‚¬ìš©\n' +
                '2. fuel_combustion - ì—°ë£Œ ì—°ì†Œ\n' +
                '3. shipping - ë¬¼ë¥˜/ìš´ì†¡\n' +
                '4. vehicle - ì°¨ëŸ‰ ìš´í–‰\n\n' +
                'ìœ í˜•ì„ ì…ë ¥í•˜ì„¸ìš”:',
                'electricity'
            );
            
            if (!type) return;

            let inputData = {};
            
            if (type === 'electricity') {
                const value = prompt('ì „ë ¥ ì‚¬ìš©ëŸ‰ (kWh):', '10000');
                if (!value) return;
                inputData = { value: parseFloat(value), unit: 'kwh', country: 'kr' };
            } else if (type === 'fuel_combustion') {
                const value = prompt('ì—°ë£Œ ì‚¬ìš©ëŸ‰:', '1000');
                if (!value) return;
                inputData = { value: parseFloat(value), fuelType: 'ng', unit: 'thousand_cubic_feet' };
            } else if (type === 'shipping') {
                const weight = prompt('í™”ë¬¼ ë¬´ê²Œ (kg):', '1000');
                const distance = prompt('ìš´ì†¡ ê±°ë¦¬ (km):', '500');
                if (!weight || !distance) return;
                inputData = { weight: parseFloat(weight), distance: parseFloat(distance), method: 'truck' };
            } else if (type === 'vehicle') {
                const distance = prompt('ì£¼í–‰ ê±°ë¦¬ (km):', '1000');
                if (!distance) return;
                inputData = { distance: parseFloat(distance) };
            }

            try {
                addDataLog(`Carbon Interface: ${type} ê³„ì‚° ì¤‘...`, 'info');
                const response = await fetch('/api/external/carbon/estimate', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ type, data: inputData })
                });

                const data = await response.json();

                if (data.success) {
                    addDataLog(`íƒ„ì†Œ ë°°ì¶œëŸ‰: ${data.data.carbonKg} kg CO2`, 'success');
                    alert(
                        `â™»ï¸ íƒ„ì†Œ ë°°ì¶œëŸ‰ ê³„ì‚° ê²°ê³¼\n\n` +
                        `ìœ í˜•: ${type}\n` +
                        `ë°°ì¶œëŸ‰: ${data.data.carbonKg?.toFixed(2) || '-'} kg CO2\n` +
                        `      ${data.data.carbonMt?.toFixed(4) || '-'} í†¤ CO2`
                    );
                } else {
                    addDataLog('Carbon Interface ê³„ì‚° ì‹¤íŒ¨', 'error');
                    alert('âŒ ê³„ì‚° ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('Carbon Interface API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // ESG ë°ì´í„° í†µí•© ìˆ˜ì§‘
        async function collectAllEsgData() {
            const corpCode = prompt('DART ê¸°ì—…ì½”ë“œë¥¼ ì…ë ¥í•˜ì„¸ìš” (ì„ íƒì‚¬í•­, ì—†ìœ¼ë©´ ë¹ˆì¹¸):', '');
            
            addDataLog('ESG ë°ì´í„° í†µí•© ìˆ˜ì§‘ ì‹œì‘...', 'info');
            
            try {
                const response = await fetch('/api/external/esg-data-collect', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ corpCode: corpCode || undefined })
                });

                const data = await response.json();

                if (data.success) {
                    const results = data.data;
                    let summary = 'ğŸš€ ESG ë°ì´í„° í†µí•© ìˆ˜ì§‘ ì™„ë£Œ!\n\n';
                    
                    if (results.company) {
                        summary += `âœ… ê¸°ì—…ì •ë³´: ${results.company.corpName}\n`;
                        addDataLog(`ê¸°ì—…ì •ë³´ ìˆ˜ì§‘: ${results.company.corpName}`, 'success');
                    }
                    if (results.weather) {
                        summary += `âœ… ê¸°ìƒë°ì´í„°: ìˆ˜ì§‘ë¨\n`;
                        addDataLog('ê¸°ìƒ ë°ì´í„° ìˆ˜ì§‘ ì™„ë£Œ', 'success');
                    }
                    if (results.errors && results.errors.length > 0) {
                        results.errors.forEach(err => {
                            summary += `âš ï¸ ${err.api}: ${err.error}\n`;
                            addDataLog(`${err.api} ì˜¤ë¥˜: ${err.error}`, 'error');
                        });
                    }
                    
                    alert(summary);
                    console.log('ESG í†µí•© ìˆ˜ì§‘ ê²°ê³¼:', data);
                } else {
                    addDataLog('ESG í†µí•© ìˆ˜ì§‘ ì‹¤íŒ¨', 'error');
                    alert('âŒ ìˆ˜ì§‘ ì‹¤íŒ¨: ' + data.error);
                }
            } catch (error) {
                addDataLog('ESG í†µí•© ìˆ˜ì§‘ API ì˜¤ë¥˜', 'error');
                alert('âŒ API ì˜¤ë¥˜: ' + error.message);
            }
        }

        // í˜ì´ì§€ ë¡œë“œ ì‹œ API ìƒíƒœ í™•ì¸
        document.addEventListener('DOMContentLoaded', function() {
            // ê¸°ì¡´ ì´ˆê¸°í™” ì½”ë“œ ì‹¤í–‰ í›„ API ìƒíƒœ í™•ì¸
            setTimeout(() => {
                checkApiStatus();
            }, 1000);
        });

        function createNewReport() {
            const newReport = {
                id: Date.now(),
                title: `ìƒˆ ESG ë³´ê³ ì„œ`,
                progress: 0,
                status: 'ì‘ì„± ì¤‘',
                lastModified: 'ë°©ê¸ˆ ì „',
                color: 'cyan',
                content: ''
            };
            reports.unshift(newReport);
            renderReports();
            showPage('ai-report');
            selectReport(newReport.id);
        }

        function selectReport(id) {
            selectedReport = reports.find(r => r.id === id);
            if (selectedReport) {
                document.getElementById('noReportSelected').classList.add('hidden');
                document.getElementById('reportContent').classList.remove('hidden');
                document.getElementById('selectedReportTitle').value = selectedReport.title;
                document.getElementById('selectedReportProgress').textContent = selectedReport.progress;
                document.getElementById('generatedReport').innerHTML = selectedReport.content || '<p class="text-navy-400">AI ìƒì„± ë²„íŠ¼ì„ í´ë¦­í•˜ë©´ Claude AIê°€ ë³´ê³ ì„œë¥¼ ì‘ì„±í•©ë‹ˆë‹¤.</p>';
                renderAIReports();
            }
        }

        function deleteReport(id) {
            reports = reports.filter(r => r.id !== id);
            if (selectedReport?.id === id) {
                selectedReport = null;
                document.getElementById('noReportSelected').classList.remove('hidden');
                document.getElementById('reportContent').classList.add('hidden');
            }
            renderReports();
            renderAIReports();
        }

        function selectTemplate(templateId) {
            selectedTemplate = templateId;
            document.querySelectorAll('.template-btn').forEach(btn => {
                btn.classList.remove('border-cyan-500', 'bg-cyan-50');
                btn.classList.add('border-navy-200');
            });
            document.querySelector(`[data-template="${templateId}"]`).classList.add('border-cyan-500', 'bg-cyan-50');
            document.querySelector(`[data-template="${templateId}"]`).classList.remove('border-navy-200');
        }

        function downloadReport() {
            if (!selectedReport || !selectedReport.content) {
                alert('ë¨¼ì € ë³´ê³ ì„œë¥¼ ìƒì„±í•´ì£¼ì„¸ìš”.');
                return;
            }
            const blob = new Blob([selectedReport.content.replace(/<[^>]*>/g, '\n')], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = selectedReport.title + '.txt';
            a.click();
        }

        function initChart() {
            const ctx = document.getElementById('carbonChart').getContext('2d');
            const gradient = ctx.createLinearGradient(0, 0, 0, 200);
            gradient.addColorStop(0, 'rgba(16, 185, 129, 0.3)');
            gradient.addColorStop(1, 'rgba(16, 185, 129, 0)');

            carbonChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['1ì›”', '2ì›”', '3ì›”', '4ì›”', '5ì›”', '6ì›”'],
                    datasets: [{
                        label: 'íƒ„ì†Œ ë°°ì¶œëŸ‰',
                        data: [1420, 1380, 1350, 1310, 1280, 1245],
                        borderColor: '#10b981',
                        backgroundColor: gradient,
                        borderWidth: 3,
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#10b981',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 5,
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { grid: { display: false }, ticks: { color: '#627d98', font: { size: 11 } } },
                        y: { grid: { color: 'rgba(98, 125, 152, 0.1)' }, ticks: { color: '#627d98', font: { size: 11 } }, min: 1100, max: 1500 }
                    }
                }
            });
        }

        // ì´ˆê¸°í™”
        document.addEventListener('DOMContentLoaded', async function() {
            await loadDashboardData();  // K-ESG + Assessment ë°ì´í„° ë¡œë“œ
            await loadMonthlyBillDataFromServer();  // ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ë¡œë“œ
            initChart();
            updateDashboard();
            renderReports();
            renderTasks();
        });

        // K-ESG ê¸°ì¤€ ë° Assessment ê²°ê³¼ ë¡œë“œ
        async function loadDashboardData() {
            try {
                const response = await fetch('/api/dashboard/data');
                const data = await response.json();
                
                if (data.success) {
                    kesgCriteria = data.kesgCriteria;
                    assessmentResults = data.assessmentResults;
                    
                    console.log('Dashboard ë°ì´í„° ë¡œë“œ:', data.summary);
                    
                    // Assessment ê²°ê³¼ê°€ ìˆìœ¼ë©´ Dashboard ë°ì´í„° ì—…ë°ì´íŠ¸
                    if (assessmentResults) {
                        updateFromAssessment(assessmentResults);
                    }
                }
                
                // ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ë¡œë“œ
                const billResponse = await fetch('/api/bill/data');
                const billData = await billResponse.json();
                if (billData.success && billData.data) {
                    monthlyBillData = billData.data;
                    updateBillDataTable();
                    console.log('ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ë¡œë“œë¨');
                }
            } catch (error) {
                console.error('Dashboard ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            } finally {
                // ì„±ê³µ/ì‹¤íŒ¨ ê´€ê³„ì—†ì´ ìƒíƒœ í‘œì‹œ ì—…ë°ì´íŠ¸
                renderAssessmentStatus();
            }
        }
        
        // ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ì„œë²„ì—ì„œ ë¡œë“œ
        async function loadMonthlyBillDataFromServer() {
            try {
                const response = await fetch('/api/bill/data');
                const result = await response.json();
                
                if (result.success && result.data) {
                    monthlyBillData = result.data;
                    console.log('ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ë¡œë“œë¨:', Object.keys(monthlyBillData));
                    updateBillDataTable();
                }
            } catch (error) {
                console.error('ì›”ë³„ ê³ ì§€ì„œ ë°ì´í„° ë¡œë“œ ì‹¤íŒ¨:', error);
            }
        }

        // Assessment ê²°ê³¼ë¡œ Dashboard ì—…ë°ì´íŠ¸
        function updateFromAssessment(results) {
            // íšŒì‚¬ ì •ë³´ ì—…ë°ì´íŠ¸
            if (results.companyInfo) {
                document.getElementById('companyNameDisplay').textContent = results.companyInfo.name;
                if (results.companyInfo.industry) {
                    document.getElementById('industryDisplay').textContent = results.companyInfo.industry;
                }
            }
        }

        // Assessment ì—°ë™ ìƒíƒœ í‘œì‹œ
        function renderAssessmentStatus() {
            const statusContainer = document.getElementById('assessmentStatus');
            if (!statusContainer) return;

            if (assessmentResults) {
                statusContainer.innerHTML = `
                    <div class="p-4 bg-emerald-50 border border-emerald-200 rounded-xl">
                        <div class="flex items-center gap-3 mb-3">
                            <div class="w-10 h-10 bg-emerald-100 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5 text-emerald-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                            </div>
                            <div>
                                <p class="font-semibold text-emerald-800">K-ESG ìê°€ì§„ë‹¨ ì™„ë£Œ</p>
                                <p class="text-sm text-emerald-600">${assessmentResults.companyInfo?.name || 'ê¸°ì—…'} â€¢ ${new Date(assessmentResults.savedAt).toLocaleDateString('ko-KR')}</p>
                            </div>
                        </div>
                        <div class="grid grid-cols-4 gap-2 text-center">
                            <div class="bg-white rounded-lg p-2">
                                <p class="text-2xl font-bold text-emerald-600">${assessmentResults.totalScore}</p>
                                <p class="text-xs text-gray-500">ì¢…í•©</p>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <p class="text-xl font-bold text-green-600">${assessmentResults.scores?.E || 0}</p>
                                <p class="text-xs text-gray-500">í™˜ê²½(E)</p>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <p class="text-xl font-bold text-blue-600">${assessmentResults.scores?.S || 0}</p>
                                <p class="text-xs text-gray-500">ì‚¬íšŒ(S)</p>
                            </div>
                            <div class="bg-white rounded-lg p-2">
                                <p class="text-xl font-bold text-purple-600">${assessmentResults.scores?.G || 0}</p>
                                <p class="text-xs text-gray-500">ì§€ë°°êµ¬ì¡°(G)</p>
                            </div>
                        </div>
                    </div>
                `;
            } else {
                statusContainer.innerHTML = `
                    <div class="p-4 bg-amber-50 border border-amber-200 rounded-xl">
                        <div class="flex items-center gap-3">
                            <div class="w-10 h-10 bg-amber-100 rounded-lg flex items-center justify-center">
                                <svg class="w-5 h-5 text-amber-600" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg>
                            </div>
                            <div>
                                <p class="font-semibold text-amber-800">K-ESG ìê°€ì§„ë‹¨ í•„ìš”</p>
                                <p class="text-sm text-amber-600">Assessment í˜ì´ì§€ì—ì„œ í‰ê°€ë¥¼ ì™„ë£Œí•´ì£¼ì„¸ìš”</p>
                            </div>
                        </div>
                        <a href="/assessment" class="mt-3 block w-full py-2 bg-amber-500 text-white text-center rounded-lg text-sm font-medium hover:bg-amber-600 transition">
                            ìê°€ì§„ë‹¨ ì‹œì‘í•˜ê¸° â†’
                        </a>
                    </div>
                `;
            }
        }

        // ë¡œê·¸ì•„ì›ƒ í•¨ìˆ˜
        function logout() {
            if (confirm('ë¡œê·¸ì•„ì›ƒ í•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
                // ì‹¤ì œë¡œëŠ” ì„¸ì…˜/í† í° ì‚­ì œ
                alert('ë¡œê·¸ì•„ì›ƒ ë˜ì—ˆìŠµë‹ˆë‹¤.');
                window.location.href = '/';
            }
        }
    </script>
</body>
</html>
